(function(e){function t(t){for(var r,s,l=t[0],n=t[1],c=t[2],u=0,p=[];u<l.length;u++)s=l[u],Object.prototype.hasOwnProperty.call(o,s)&&o[s]&&p.push(o[s][0]),o[s]=0;for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r]);d&&d(t);while(p.length)p.shift()();return i.push.apply(i,c||[]),a()}function a(){for(var e,t=0;t<i.length;t++){for(var a=i[t],r=!0,l=1;l<a.length;l++){var n=a[l];0!==o[n]&&(r=!1)}r&&(i.splice(t--,1),e=s(s.s=a[0]))}return e}var r={},o={k8s:0},i=[];function s(t){if(r[t])return r[t].exports;var a=r[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.m=e,s.c=r,s.d=function(e,t,a){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)s.d(a,r,function(t){return e[t]}.bind(null,r));return a},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],n=l.push.bind(l);l.push=t,l=l.slice();for(var c=0;c<l.length;c++)t(l[c]);var d=n;i.push([2,"chunk-vendors","chunk-common"]),a()})({"04e5":function(e,t,a){"use strict";var r=a("e93e"),o=a.n(r);o.a},"0810":function(e,t,a){"use strict";var r=a("be1a"),o=a.n(r);o.a},"0d3c":function(e,t,a){"use strict";var r=a("8f5f"),o=a.n(r);o.a},"0d43":function(e,t,a){},"0dbe":function(e,t,a){},"108d":function(e,t,a){},"11e0":function(e,t,a){},"138c":function(e,t,a){},"168e":function(e,t,a){},2:function(e,t,a){e.exports=a("4933")},"244f":function(e,t,a){"use strict";var r=a("138c"),o=a.n(r);o.a},"24ee":function(e,t,a){},2562:function(e,t,a){"use strict";var r=a("626e"),o=a.n(r);o.a},2876:function(e,t,a){},"29ca":function(e,t,a){"use strict";var r=a("c49e"),o=a.n(r);o.a},"2c1d":function(e,t,a){},"2d59":function(e,t,a){},3976:function(e,t,a){"use strict";var r=a("11e0"),o=a.n(r);o.a},"3d87":function(e,t,a){},"437c":function(e,t,a){},"44ae":function(e,t,a){"use strict";var r=a("b2b3"),o=a.n(r);o.a},4917:function(e,t,a){"use strict";var r=a("108d"),o=a.n(r);o.a},4933:function(e,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d");var r=a("a026"),o=(a("9c65"),a("42a2a")),i=(a("42a1"),a("b3f5"),a("0ce2"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("k8s-header"),a("p",{attrs:{id:"web_version"}},[e._v("Version:"+e._s(e.web_version))]),a("keep-alive",[a("router-view",{staticClass:"main-width"})],1)],1)}),s=[],l=a("bc3a"),n=a.n(l),c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app_index__header"},[a("div",{staticClass:"main-width"},[a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:6}},[a("div",{staticClass:"logo-wrap"},["true"===e.enable&&"true"===e.show?a("a",{attrs:{href:"/"}},[a("img",{staticClass:"logo",attrs:{src:"/static/img/tars-logo.png"}})]):e._e(),"true"===e.k8s?a("a",{class:{active:!0},attrs:{href:"/k8s.html"}},[a("img",{staticClass:"logo",attrs:{src:"/static/img/K8S.png"}})]):e._e(),"true"===e.enable?a("a",{attrs:{href:"/dcache.html"}},[a("img",{staticClass:"logo",attrs:{alt:"dcache",src:"/static/img/dcache-logo.png"}})]):e._e()])]),a("el-col",{attrs:{span:12}},[a("let-tabs",{staticClass:"tabs",attrs:{center:!0,activekey:e.$route.matched[0].path},on:{click:e.clickTab}},[a("let-tab-pane",{attrs:{tab:e.$t("header.tab.tab1"),tabkey:"/server",icon:e.serverIcon}}),a("let-tab-pane",{attrs:{tab:e.$t("header.tab.tab2"),tabkey:"/operation",icon:e.opaIcon}}),a("let-tab-pane",{attrs:{tab:e.$t("header.tab.tab8"),tabkey:"/gateway",icon:e.cacheIcon}}),"true"==e.enableMarket?a("let-tab-pane",{attrs:{tab:e.$t("header.tab.tab9"),tabkey:"/market/list",icon:e.packageIcon}}):e._e()],1)],1),a("el-col",{attrs:{span:2}},[a("div",{staticClass:"language-wrap"},[a("let-select",{attrs:{clearable:!1},on:{change:e.changeLocale},model:{value:e.locale,callback:function(t){e.locale=t},expression:"locale"}},[e._l(e.localeMessages,(function(t){return[a("let-option",{key:t.localeCode,attrs:{value:t.localeCode}},[e._v(e._s(t.localeName))])]}))],2)],1)]),a("el-col",{attrs:{span:4}},[a("div",{staticClass:"user-wrap"},[a("el-dropdown",{staticStyle:{display:"block!important"},on:{command:e.handleCommand}},[a("span",{staticClass:"el-dropdown-link"},[e._v(" "+e._s(e.uid)),a("i",{directives:[{name:"show",rawName:"v-show",value:e.enableLogin,expression:"enableLogin"}],staticClass:"el-icon-arrow-down el-icon--right"})]),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{directives:[{name:"show",rawName:"v-show",value:e.enableLogin,expression:"enableLogin"}],attrs:{command:"center"}},[e._v(e._s(e.$t("header.userCenter")))]),a("el-dropdown-item",{attrs:{command:"modifyPass"}},[e._v(e._s(e.$t("header.modifyPass")))]),a("el-dropdown-item",{attrs:{command:"quit"}},[e._v(e._s(e.$t("header.logout")))])],1)],1),e.marketUid?a("el-dropdown",{on:{command:e.handleMarketCommand}},[a("span",{staticClass:"el-dropdown-link"},[a("i",{staticClass:"el-icon-cloudy el-icon--left"}),e._v(" "+e._s(e.marketUid.uid)),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{attrs:{command:"pass"}},[e._v("设置仓库密码")]),a("el-dropdown-item",{attrs:{command:"project"}},[e._v("管理仓库项目")]),a("el-dropdown-item",{attrs:{command:"modify"}},[e._v("修改服务市场密码")]),a("el-dropdown-item",{attrs:{command:"quit"}},[e._v("退出市场登录")])],1)],1):e._e()],1)])],1)],1)])},d=[],u=(a("ac1f"),a("5319"),a("1817")),p=a.n(u),m=a("1ca6"),f=a.n(m),h=a("4d18"),v=a.n(h),g=a("cc08"),b=a.n(g),$=a("3e1a"),k=a.n($),y=a("f51c"),S={data:function(){return{serverIcon:p.a,opaIcon:f.a,releaseIcon:v.a,cacheIcon:b.a,operatorIcon:k.a,packageIcon:v.a,locale:this.$cookie.get("locale")||"en",enableMarket:this.$cookie.get("market")||"false",uid:"--",enableLogin:!1,isAdmin:!1,localeMessages:y["c"],k8s:this.$cookie.get("k8s")||"false",enable:this.$cookie.get("enable")||"false",show:this.$cookie.get("show")||"false",enableLdap:!1}},computed:{marketUid:function(){return console.log("marketUid",this.$store.state.marketUid),this.$store.state.marketUid}},methods:{handleCommand:function(e){"center"==e?location.href="/auth.html":"modifyPass"==e&&(location.href="/pass.html"),"quit"==e&&(location.href="/logout")},handleMarketCommand:function(e){"quit"==e?(this.$store.commit({type:"quit"}),this.$router.push("/market/user/login")):"pass"==e?this.$router.push("/market/repo/pass"):"project"==e?this.$router.push("/market/repo/project"):"modify"==e&&this.$router.push("/market/user/modifyPass")},clickTab:function(e){this.$router.replace(e)},userCenter:function(){window.open("/pages/server/api/userCenter")},getLoginUid:function(){var e=this;this.$ajax.getJSON("/server/api/get_login_uid").then((function(t){t&&t.uid?e.uid=t.uid:e.uid="***"})).catch((function(t){e.$tip.error("获取用户登录信息: ".concat(t.err_msg||t.message))}))},changeLocale:function(){this.$cookie.set("locale",this.locale,{expires:"1Y"}),location.reload()},checkEnableLogin:function(){var e=this;this.$ajax.getJSON("/server/api/is_enable_login").then((function(t){e.enableLogin=t.enableLogin||!1})).catch((function(e){}))},checkEnableLdap:function(){var e=this;this.$ajax.getJSON("/server/api/isEnableLdap").then((function(t){e.enableLdap=t.enableLdap||!1})).catch((function(e){}))},checkAdmin:function(){var e=this;this.isAdmin=!1,this.$ajax.getJSON("/server/api/isAdmin").then((function(t){e.isAdmin=t.admin})).catch((function(e){}))}},mounted:function(){this.getLoginUid(),this.checkEnableLogin(),this.checkAdmin(),this.checkEnableLdap(),window.header=this}},_=S,w=(a("c219"),a("2877")),M=Object(w["a"])(_,c,d,!1,null,null,null),x=M.exports,C=a("559f"),N={name:"App",components:{K8sHeader:x,AppFooter:C["a"]},data:function(){return{web_version:" loading··"}},mounted:function(){var e=this;n.a.create({baseURL:"/"})({method:"get",url:"/k8s_version"}).then((function(t){e.web_version=t.data}))}},L=N,T=(a("7b9a"),Object(w["a"])(L,i,s,!1,null,null,null)),I=T.exports,A=a("8c4f"),D=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page_server"},[a("div",{staticClass:"left-view"},[a("div",{staticClass:"tree_search"},[a("el-input",{attrs:{size:"small",placeholder:e.$t("home.placeholder")},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.filterTextChange(t)}},model:{value:e.treeSearchKey,callback:function(t){e.treeSearchKey=t},expression:"treeSearchKey"}})],1),a("div",{staticClass:"tree_wrap"},[a("a",{staticClass:"tree_icon iconfont el-icon-third-shuaxin",class:{active:e.isIconPlay},staticStyle:{"font-family":"iconfont  !important","z-index":"99"},attrs:{href:"javascript:;"},on:{click:function(t){return e.treeSearch(1)}}}),e.treeData&&e.treeData.length?a("el-tree",{ref:"trees",staticClass:"left-tree",attrs:{data:e.treeData,props:e.defaultProps,"filter-node-method":e.filterNode,"highlight-current":"","empty-text":e.$t("common.noService"),"node-key":"id"},on:{"node-click":e.handleNodeClick},scopedSlots:e._u([{key:"default",fn:function(t){t.node;var r=t.data;return a("span",{staticClass:"custom-tree-node"},[a("el-tooltip",{attrs:{content:r.name+"("+r.serverType+")",placement:"bottom-start",effect:"light","open-delay":e.openDelay}},[a("span",[2==r.type?a("i",{class:e._f("serverTypeFilter")(r.serverType)}):e._e(),e._v(" "+e._s(r.name)+" ")])])],1)}}],null,!1,4191436028)}):e._e(),e.treeData?e._e():a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"left-tree"},[!1===e.treeData?a("div",{staticClass:"loading"},[a("p",[e._v(e._s(e.treeErrMsg))]),a("a",{attrs:{href:"javascript:;"},on:{click:e.getTreeData}},[e._v(e._s(e.$t("common.reTry")))])]):e._e()])],1)]),a("div",{staticClass:"right-view"},[a("div",{staticClass:"btabs_wrap"},[a("ul",{directives:[{name:"vscroll",rawName:"v-vscroll"}],ref:"btabs",staticClass:"btabs"},[a("li",{key:e.homeTab,staticClass:"btabs_item",class:{active:e.homeTab===e.treeid}},[a("a",{staticClass:"btabs_link",staticStyle:{"padding-right":"20px"},attrs:{href:"javascript:;"},on:{click:function(t){return e.clickBTabs(t,e.homeTab)}}},[e._v(" "+e._s(e.$t("home.homeTab"))+" ")])]),e._l(e.BTabs,(function(t){return a("li",{key:t.id,staticClass:"btabs_item",class:{active:t.id===e.treeid}},[a("a",{staticClass:"btabs_link",attrs:{href:"javascript:;"},on:{click:function(a){return e.clickBTabs(a,t.id)}}},[e._v(e._s(t.id))]),a("a",{staticClass:"btabs_close",attrs:{href:"javascript:;"},on:{click:function(a){return e.closeBTabs(t.id)}}},[e._v(" "+e._s(e.$t("home.close")))])])}))],2),a("a",{staticClass:"btabs_all",attrs:{href:"javascript:;",title:e.$t("home.closeAll")},on:{click:e.closeAllBTabs}},[e._v(" "+e._s(e.$t("home.closeAll")))])]),a("div",{directives:[{name:"show",rawName:"v-show",value:e.treeid===e.homeTab,expression:"treeid === homeTab"}],staticClass:"btabs_con_home",staticStyle:{height:"800px"}},[a("serverHistory")],1),a("div",{staticClass:"btabs_con"},e._l(e.BTabs,(function(t){return t.id===e.treeid?a("div",{key:t.id,staticClass:"btabs_con_item"},[a("let-tabs",{attrs:{activekey:t.path},on:{click:e.clickTab}},[a("let-tab-pane",{attrs:{tabkey:e.base+"/manage",tab:e.$t("header.tab.tab1")}}),5===e.serverData.level?a("let-tab-pane",{attrs:{tabkey:e.base+"/history",tab:e.$t("header.tab.tab7")}}):e._e(),5===e.serverData.level?a("let-tab-pane",{attrs:{tabkey:e.base+"/publish",tab:e.$t("index.rightView.tab.patch")}}):e._e(),5===e.serverData.level||1===e.serverData.level?a("let-tab-pane",{attrs:{tabkey:e.base+"/config",tab:5===e.serverData.level?e.$t("index.rightView.tab.serviceConfig"):1===e.serverData.level?e.$t("index.rightView.tab.appConfig"):""}}):e._e(),5===e.serverData.level?a("let-tab-pane",{attrs:{tabkey:e.base+"/server-monitor",tab:e.$t("index.rightView.tab.statMonitor")}}):e._e(),5===e.serverData.level?a("let-tab-pane",{attrs:{tabkey:e.base+"/property-monitor",tab:e.$t("index.rightView.tab.propertyMonitor")}}):e._e(),5===e.serverData.level?a("let-tab-pane",{attrs:{tabkey:e.base+"/user-manage",tab:e.$t("index.rightView.tab.privileage")}}):e._e(),5===e.serverData.level?a("let-tab-pane",{attrs:{tabkey:e.base+"/callChain",tab:e.$t("index.rightView.tab.treeConfig")}}):e._e()],1),a(e.getName(t.path),{ref:"childView",refInFor:!0,tag:"router-view",staticClass:"page_server_child",attrs:{treeid:t.id}})],1):e._e()})),0)])])},P=[],O=(a("4de4"),a("4160"),a("c975"),a("baa5"),a("a434"),a("b0c0"),a("1276"),a("159b"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page_server_manage"},[a("div",{staticClass:"table_head",staticStyle:{height:"50px"}},[a("h4",{staticStyle:{float:"left"}},[e._v(" "+e._s(this.$t("serverList.title.serverList"))+" "),a("i",{staticClass:"icon iconfont el-icon-third-shuaxin",staticStyle:{"font-family":"iconfont !important",cursor:"pointer"},on:{click:function(t){return e.getServerList()}}})]),e.isApplication?e._e():a("span",{staticClass:"btn_group",staticStyle:{float:"right"}},[a("let-button",{attrs:{theme:"primary",size:"small"},on:{click:e.manageK8S}},[e._v(e._s(e.$t("operate.k8s")))]),e._v(" "),a("let-button",{attrs:{theme:"primary",size:"small",disabled:e.isNormal},on:{click:e.configServer}},[e._v(e._s(e.$t("operate.server")))]),e._v(" "),a("let-button",{attrs:{theme:"primary",size:"small",disabled:e.isNormal},on:{click:e.manageServant}},[e._v(e._s(e.$t("operate.servant")))]),e._v(" "),a("let-button",{attrs:{theme:"primary",size:"small",disabled:e.isNormal},on:{click:e.viewTemplate}},[e._v(e._s(e.$t("operate.viewTemplate")))]),e._v(" "),a("let-button",{attrs:{theme:"primary",size:"small",disabled:e.isNormal},on:{click:e.privateTemplateManage}},[e._v(e._s(e.$t("operate.privateTemplateManage")))]),e._v(" "),a("let-button",{attrs:{theme:"primary",size:"small",disabled:e.isNormal},on:{click:e.startServer}},[e._v(e._s(e.$t("operate.startServer")))]),e._v(" "),a("let-button",{attrs:{theme:"primary",size:"small",disabled:e.isNormal},on:{click:e.restartServer}},[e._v(e._s(e.$t("operate.restartServer")))]),e._v(" "),a("let-button",{attrs:{theme:"primary",size:"small",disabled:e.isNormal},on:{click:e.stopServer}},[e._v(e._s(e.$t("operate.stopServer")))]),e._v(" "),a("let-button",{attrs:{theme:"primary",size:"small",disabled:e.isNormal},on:{click:e.showMoreCmd}},[e._v(e._s(e.$t("operate.more")))])],1)]),e.serverList?a("div",{ref:"serverListLoading"},[a("let-table",{attrs:{data:e.serverList,"empty-msg":e.$t("common.nodata")}},[a("let-table-column",{scopedSlots:e._u([{key:"head",fn:function(t){return[a("let-checkbox",{model:{value:e.isCheckedAll,callback:function(t){e.isCheckedAll=t},expression:"isCheckedAll"}})]}},{key:"default",fn:function(t){return[a("let-checkbox",{on:{change:function(a){return e.checkChange(t.row)}},model:{value:t.row.isChecked,callback:function(a){e.$set(t.row,"isChecked",a)},expression:"scope.row.isChecked"}})]}}],null,!1,3049151486)}),a("let-table-column",{attrs:{title:e.$t("deployService.form.app"),prop:"ServerApp"}}),a("let-table-column",{attrs:{title:e.$t("deployService.form.serviceName"),prop:"ServerName"}}),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.podName"),prop:"PodName"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-table-operation",{on:{click:function(a){return e.gotoLog(t.row)}}},[e._v(e._s(t.row.PodName))])]}}],null,!1,2844911292)}),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.podIP"),prop:"PodIp"}}),a("let-table-column",{attrs:{title:"pid",prop:"Pid"}}),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.ip"),prop:"NodeIp"}}),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.version"),prop:"ServiceVersion"}}),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.configStatus")},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{style:e.getState(t.row.SettingState)},[e._v(e._s(t.row.SettingState))])]}}],null,!1,987565344)}),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.currStatus")},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{style:e.getState(t.row.PresentState)},[e._v(e._s(t.row.PresentState))])]}}],null,!1,1754665792)}),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.currMessage"),width:"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-tooltip",{staticClass:"tooltip",attrs:{placement:"top",content:t.row.PresentMessage||""}},[a("let-table-operation",[a("span",{staticClass:"over"},[e._v(e._s(t.row.PresentMessage))])])],1)]}}],null,!1,874570244)}),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.createTime"),prop:"CreateTime"}}),a("let-table-column",{attrs:{title:e.$t("operate.operates"),width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-table-operation",{on:{click:function(a){return e.deletePod(t.row)}}},[e._v(e._s(e.$t("operate.deletePod"))+" ")]),a("let-table-operation",{on:{click:function(a){return e.viewEvent(t.row)}}},[e._v(e._s(e.$t("operate.viewEvent"))+" ")])]}}],null,!1,702003604)})],1)],1):e._e(),a("div",{staticClass:"table_head"},[e.serverNotifyList&&e.showOthers?a("h4",[e._v(" "+e._s(this.$t("serverList.title.serverStatus"))+" "),a("i",{staticClass:"icon iconfont",staticStyle:{"font-family":"iconfont !important",cursor:"pointer"},on:{click:function(t){return e.getServerNotifyList()}}},[e._v("")])]):e._e()]),e.serverNotifyList&&e.showOthers?a("let-table",{ref:"serverNotifyListLoading",attrs:{data:e.serverNotifyList,stripe:"","empty-msg":e.$t("common.nodata")}},[a("let-table-column",{attrs:{title:e.$t("common.time"),width:"160px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticStyle:{"white-space":"nowrap"}},[e._v(e._s(t.row._source.timeStr))])]}}],null,!1,3973901746)}),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.serviceID"),prop:"AppServer"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticStyle:{"white-space":"nowrap"}},[e._v(e._s(t.row._source.app+"."+t.row._source.server))])]}}],null,!1,4255247636)}),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.podName"),prop:"PodName"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticStyle:{"white-space":"nowrap"}},[e._v(e._s(t.row._source.podName))])]}}],null,!1,1996751150)}),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.source"),prop:"NotifySource"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticStyle:{"white-space":"nowrap"}},[e._v(e._s(t.row._source.source))])]}}],null,!1,1994068079)}),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.result"),prop:"NotifyMessage"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{style:e.statusStyle(t.row._source.message)},[e._v(e._s(t.row._source.message))])]}}],null,!1,2929402306)})],1):e._e(),a("div",{staticStyle:{"margin-bottom":"20px"}},[a("let-pagination",{staticStyle:{float:"right"},attrs:{align:"right",page:e.notifyPagination.page,total:e.notifyPagination.total},on:{change:e.notifyGotoPage}})],1),a("let-modal",{attrs:{title:e.$t("serverList.dlg.title.editService"),width:"800px",footShow:!(!e.configModal.model||!e.configModal.model.ServerId)},on:{"on-confirm":e.saveConfig,close:e.closeConfigModal,"on-cancel":e.closeConfigModal},model:{value:e.configModal.show,callback:function(t){e.$set(e.configModal,"show",t)},expression:"configModal.show"}},[e.configModal.model&&e.configModal.model.ServerId?a("let-form",{ref:"configForm",staticClass:"two-columns",attrs:{itemWidth:"360px",columns:2}},[a("let-form-item",{attrs:{label:e.$t("common.template"),required:""}},[e.configModal.model.templates&&e.configModal.model.templates.length?a("let-select",{attrs:{size:"small",required:""},model:{value:e.configModal.model.ServerTemplate,callback:function(t){e.$set(e.configModal.model,"ServerTemplate",t)},expression:"configModal.model.ServerTemplate"}},e._l(e.configModal.model.templates,(function(t){return a("let-option",{key:t.TemplateName,attrs:{value:t.TemplateName}},[e._v(e._s(t.TemplateName)+" ")])})),1):a("span",[e._v(e._s(e.configModal.model.ServerTemplate))])],1),a("let-form-item",{attrs:{label:e.$t("serverList.dlg.asyncThread"),required:""}},[a("let-input",{attrs:{size:"small",placeholder:e.$t("serverList.dlg.placeholder.thread"),required:"",pattern:"tars.nodejs"===e.configModal.model.ServerTemplate?"^[1-9][0-9]*$":"^([3-9]|[1-9][0-9]+)$","pattern-tip":"$t('serverList.dlg.placeholder.thread')"},model:{value:e.configModal.model.AsyncThread,callback:function(t){e.$set(e.configModal.model,"AsyncThread",t)},expression:"configModal.model.AsyncThread"}})],1),a("let-form-item",{attrs:{label:e.$t("serverList.dlg.privateTemplate"),labelWidth:"150px",itemWidth:"724px"}},[a("let-input",{attrs:{size:"large",type:"textarea",rows:10},model:{value:e.configModal.model.ServerProfile,callback:function(t){e.$set(e.configModal.model,"ServerProfile",t)},expression:"configModal.model.ServerProfile"}})],1)],1):a("div",{ref:"configFormLoading",staticClass:"loading-placeholder"})],1),a("let-modal",{attrs:{title:e.$t("serverList.table.servant.title"),width:"1200px",footShow:!1},on:{close:e.closeServantModal},model:{value:e.servantModal.show,callback:function(t){e.$set(e.servantModal,"show",t)},expression:"servantModal.show"}},[a("let-button",{staticClass:"tbm16",attrs:{size:"small",theme:"primary"},on:{click:function(t){return e.configServant()}}},[e._v(e._s(e.$t("operate.add"))+" Servant ")]),e.servantModal.model?a("let-table",{attrs:{data:e.servantModal.model,"empty-msg":e.$t("common.nodata")}},[a("let-table-column",{attrs:{title:"OBJ",prop:"Name"}}),a("let-table-column",{attrs:{title:e.$t("deployService.table.th.port"),prop:"Port"}}),a("let-table-column",{attrs:{title:e.$t("deployService.table.th.protocol"),width:"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.IsTars?a("let-radio",{attrs:{label:!0},model:{value:t.row.IsTars,callback:function(a){e.$set(t.row,"IsTars",a)},expression:"props.row.IsTars"}},[e._v("TARS")]):a("let-radio",{attrs:{label:!1},model:{value:t.row.IsTars,callback:function(a){e.$set(t.row,"IsTars",a)},expression:"props.row.IsTars"}},[e._v("NOT TARS")])]}}],null,!1,3719090988)}),a("let-table-column",{attrs:{title:e.$t("deployService.form.portType"),width:"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.IsTcp?a("let-radio",{attrs:{label:!0},model:{value:t.row.IsTcp,callback:function(a){e.$set(t.row,"IsTcp",a)},expression:"props.row.IsTcp"}},[e._v("TCP")]):a("let-radio",{attrs:{label:!1},model:{value:t.row.IsTcp,callback:function(a){e.$set(t.row,"IsTcp",a)},expression:"props.row.IsTcp"}},[e._v("UDP")])]}}],null,!1,2027518380)}),a("let-table-column",{attrs:{title:e.$t("deployService.table.th.threads"),width:"80px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.Threads))]}}],null,!1,2683018496)}),a("let-table-column",{attrs:{title:e.$t("serverList.table.servant.connections"),width:"140px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.Connections))]}}],null,!1,192188376)}),a("let-table-column",{attrs:{title:e.$t("serverList.table.servant.capacity"),width:"140px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.Capacity))]}}],null,!1,4133537865)}),a("let-table-column",{attrs:{title:e.$t("serverList.table.servant.timeout"),width:"140px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.Timeout))]}}],null,!1,2137174470)}),a("let-table-column",{attrs:{title:e.$t("operate.operates"),width:"90px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-table-operation",{on:{click:function(a){return e.configServant(t.row.AdapterId)}}},[e._v(e._s(e.$t("operate.update"))+" ")]),a("let-table-operation",{staticClass:"danger",on:{click:function(a){return e.deleteServant(t.row.AdapterId)}}},[e._v(" "+e._s(e.$t("operate.delete"))+" ")])]}}],null,!1,2769818527)})],1):a("div",{ref:"servantModalLoading",staticClass:"loading-placeholder"})],1),a("let-modal",{attrs:{title:e.servantAddModal.isNew?e.$t("operate.title.add")+" Servant":e.$t("operate.title.update")+" Servant",width:"1200px",footShow:!!e.servantAddModal.model},on:{"on-confirm":e.saveServantAdd,close:e.closeServantAddModal,"on-cancel":e.closeServantAddModal},model:{value:e.servantAddModal.show,callback:function(t){e.$set(e.servantAddModal,"show",t)},expression:"servantAddModal.show"}},[e.servantAddModal.model&&e.servantAddModal.model.ServerServant?a("let-form",{ref:"servantAddForm"},[a("let-table",{attrs:{data:e.servantAddModal.model.ServerServant}},[a("let-table-column",{attrs:{title:"OBJ",width:"150px"},scopedSlots:e._u([{key:"head",fn:function(t){return[a("span",{staticClass:"required"},[e._v(e._s(t.column.title))])]}},{key:"default",fn:function(t){return[a("let-input",{attrs:{size:"small",placeholder:e.$t("deployService.form.placeholder"),required:"","required-tip":e.$t("deployService.form.objTips"),pattern:"^[a-zA-Z0-9]+$","pattern-tip":e.$t("deployService.form.placeholder")},model:{value:t.row.Name,callback:function(a){e.$set(t.row,"Name",a)},expression:"props.row.Name"}})]}}],null,!1,3758810427)}),a("let-table-column",{attrs:{title:e.$t("deployService.table.th.port"),width:"100px"},scopedSlots:e._u([{key:"head",fn:function(t){return[a("span",{staticClass:"required"},[e._v(e._s(t.column.title))])]}},{key:"default",fn:function(t){return[a("let-input",{attrs:{size:"small",type:"number",min:1,max:3e4,placeholder:"1-30000",required:"","required-tip":e.$t("deployService.table.tips.empty")},model:{value:t.row.Port,callback:function(a){e.$set(t.row,"Port",a)},expression:"props.row.Port"}})]}}],null,!1,2319070108)}),a("let-table-column",{attrs:{title:e.$t("deployService.form.portType"),width:"150px"},scopedSlots:e._u([{key:"head",fn:function(t){return[a("span",{staticClass:"required"},[e._v(e._s(t.column.title))])]}},{key:"default",fn:function(t){return[a("let-radio",{attrs:{label:!0},model:{value:t.row.IsTcp,callback:function(a){e.$set(t.row,"IsTcp",a)},expression:"props.row.IsTcp"}},[e._v("TCP")]),a("let-radio",{attrs:{label:!1},model:{value:t.row.IsTcp,callback:function(a){e.$set(t.row,"IsTcp",a)},expression:"props.row.IsTcp"}},[e._v("UDP")])]}}],null,!1,1519152386)}),a("let-table-column",{attrs:{title:e.$t("deployService.table.th.protocol"),width:"180px"},scopedSlots:e._u([{key:"head",fn:function(t){return[a("span",{staticClass:"required"},[e._v(e._s(t.column.title))])]}},{key:"default",fn:function(t){return[a("let-radio",{attrs:{label:!0},model:{value:t.row.IsTars,callback:function(a){e.$set(t.row,"IsTars",a)},expression:"props.row.IsTars"}},[e._v("TARS")]),a("let-radio",{attrs:{label:!1},model:{value:t.row.IsTars,callback:function(a){e.$set(t.row,"IsTars",a)},expression:"props.row.IsTars"}},[e._v("NOT TARS")])]}}],null,!1,3031957841)}),a("let-table-column",{attrs:{title:e.$t("deployService.table.th.threads"),width:"80px"},scopedSlots:e._u([{key:"head",fn:function(t){return[a("span",{staticClass:"required"},[e._v(e._s(t.column.title))])]}},{key:"default",fn:function(t){return[a("let-input",{attrs:{size:"small",type:"number",min:0,required:"","required-tip":e.$t("deployService.table.tips.empty")},model:{value:t.row.Threads,callback:function(a){e.$set(t.row,"Threads",a)},expression:"props.row.Threads"}})]}}],null,!1,1655720946)}),a("let-table-column",{attrs:{title:e.$t("serverList.table.servant.connections"),width:"140px"},scopedSlots:e._u([{key:"head",fn:function(t){return[a("span",{staticClass:"required"},[e._v(e._s(t.column.title))])]}},{key:"default",fn:function(t){return[a("let-input",{attrs:{size:"small",type:"number",min:0,required:"","required-tip":e.$t("deployService.table.tips.empty")},model:{value:t.row.Connections,callback:function(a){e.$set(t.row,"Connections",a)},expression:"props.row.Connections"}})]}}],null,!1,2060048682)}),a("let-table-column",{attrs:{title:e.$t("serverList.table.servant.capacity"),width:"140px"},scopedSlots:e._u([{key:"head",fn:function(t){return[a("span",{staticClass:"required"},[e._v(e._s(t.column.title))])]}},{key:"default",fn:function(t){return[a("let-input",{attrs:{size:"small",type:"number",min:0,required:"","required-tip":e.$t("deployService.table.tips.empty")},model:{value:t.row.Capacity,callback:function(a){e.$set(t.row,"Capacity",a)},expression:"props.row.Capacity"}})]}}],null,!1,58581595)}),a("let-table-column",{attrs:{title:e.$t("serverList.table.servant.timeout"),width:"140px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-input",{attrs:{size:"small",type:"number",min:0},model:{value:t.row.Timeout,callback:function(a){e.$set(t.row,"Timeout",a)},expression:"props.row.Timeout"}})]}}],null,!1,1471836343)}),a("let-table-column",{attrs:{title:e.$t("operate.operates"),width:"60px"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.$index===e.servantAddModal.model.ServerServant.length-1?a("let-table-operation",{on:{click:function(a){return e.addAdapter(t.row)}}},[e._v(" "+e._s(e.$t("operate.add"))+" ")]):a("let-table-operation",{staticClass:"danger",on:{click:function(a){return e.servantAddModal.model.ServerServant.splice(t.$index,1)}}},[e._v(e._s(e.$t("operate.delete"))+" ")])]}}],null,!1,1130946150)})],1)],1):e._e()],1),a("let-modal",{attrs:{title:e.servantDetailModal.isNew?e.$t("operate.title.add")+" Servant":e.$t("operate.title.update")+" Servant",width:"800px",footShow:!!e.servantDetailModal.model},on:{"on-confirm":e.saveServantDetail,close:e.closeServantDetailModal,"on-cancel":e.closeServantDetailModal},model:{value:e.servantDetailModal.show,callback:function(t){e.$set(e.servantDetailModal,"show",t)},expression:"servantDetailModal.show"}},[e.servantDetailModal.model&&1===e.servantDetailModal.model.ServerServant.length?a("let-form",{ref:"servantDetailForm",staticClass:"two-columns",attrs:{itemWidth:"360px",columns:2}},[a("let-form-item",{attrs:{label:e.$t("serverList.servant.objName"),required:""}},[a("let-input",{attrs:{size:"small",placeholder:e.$t("serverList.servant.c"),required:"",pattern:"^[A-Za-z0-9]+$","pattern-tip":e.$t("serverList.servant.obj")},model:{value:e.servantDetailModal.model.ServerServant[0].Name,callback:function(t){e.$set(e.servantDetailModal.model.ServerServant[0],"Name",t)},expression:"servantDetailModal.model.ServerServant[0].Name"}})],1),a("let-form-item",{attrs:{label:e.$t("deployService.table.th.port"),required:""}},[a("let-input",{attrs:{size:"small",type:"number",min:1,max:3e4,placeholder:"1-30000",required:"","required-tip":e.$t("deployService.table.tips.empty")},model:{value:e.servantDetailModal.model.ServerServant[0].Port,callback:function(t){e.$set(e.servantDetailModal.model.ServerServant[0],"Port",t)},expression:"servantDetailModal.model.ServerServant[0].Port"}})],1),a("let-form-item",{attrs:{label:e.$t("serverList.servant.numOfThread"),required:""}},[a("let-input",{attrs:{size:"small",type:"number",placeholder:e.$t("serverList.servant.thread"),required:"",pattern:"^[1-9][0-9]*$","pattern-tip":e.$t("serverList.servant.thread")},model:{value:e.servantDetailModal.model.ServerServant[0].Threads,callback:function(t){e.$set(e.servantDetailModal.model.ServerServant[0],"Threads",t)},expression:"servantDetailModal.model.ServerServant[0].Threads"}})],1),a("let-form-item",{attrs:{label:e.$t("serverList.servant.connections"),labelWidth:"150px"}},[a("let-input",{attrs:{size:"small",type:"number"},model:{value:e.servantDetailModal.model.ServerServant[0].Connections,callback:function(t){e.$set(e.servantDetailModal.model.ServerServant[0],"Connections",t)},expression:"servantDetailModal.model.ServerServant[0].Connections"}})],1),a("let-form-item",{attrs:{label:e.$t("serverList.servant.lengthOfQueue"),labelWidth:"150px"}},[a("let-input",{attrs:{size:"small",type:"number"},model:{value:e.servantDetailModal.model.ServerServant[0].Capacity,callback:function(t){e.$set(e.servantDetailModal.model.ServerServant[0],"Capacity",t)},expression:"servantDetailModal.model.ServerServant[0].Capacity"}})],1),a("let-form-item",{attrs:{label:e.$t("serverList.servant.queueTimeout"),labelWidth:"150px"}},[a("let-input",{attrs:{size:"small",type:"number"},model:{value:e.servantDetailModal.model.ServerServant[0].Timeout,callback:function(t){e.$set(e.servantDetailModal.model.ServerServant[0],"Timeout",t)},expression:"servantDetailModal.model.ServerServant[0].Timeout"}})],1),a("let-form-item",{attrs:{label:e.$t("serverList.servant.protocol"),required:""}},[a("let-radio",{attrs:{label:!0},model:{value:e.servantDetailModal.model.ServerServant[0].IsTars,callback:function(t){e.$set(e.servantDetailModal.model.ServerServant[0],"IsTars",t)},expression:"servantDetailModal.model.ServerServant[0].IsTars"}},[e._v("TARS")]),a("let-radio",{attrs:{label:!1},model:{value:e.servantDetailModal.model.ServerServant[0].IsTars,callback:function(t){e.$set(e.servantDetailModal.model.ServerServant[0],"IsTars",t)},expression:"servantDetailModal.model.ServerServant[0].IsTars"}},[e._v("NOT TARS")])],1),a("let-form-item",{attrs:{label:e.$t("deployService.form.portType"),required:""}},[a("let-radio",{attrs:{label:!0},model:{value:e.servantDetailModal.model.ServerServant[0].IsTcp,callback:function(t){e.$set(e.servantDetailModal.model.ServerServant[0],"IsTcp",t)},expression:"servantDetailModal.model.ServerServant[0].IsTcp"}},[e._v("TCP")]),a("let-radio",{attrs:{label:!1},model:{value:e.servantDetailModal.model.ServerServant[0].IsTcp,callback:function(t){e.$set(e.servantDetailModal.model.ServerServant[0],"IsTcp",t)},expression:"servantDetailModal.model.ServerServant[0].IsTcp"}},[e._v("UDP")])],1)],1):e._e()],1),a("k8sManager",{ref:"k8s"}),a("let-modal",{staticClass:"more-cmd",attrs:{title:e.$t("operate.title.more"),width:"700px"},on:{"on-confirm":e.invokeMoreCmd,close:e.closeMoreCmdModal,"on-cancel":e.closeMoreCmdModal},model:{value:e.moreCmdModal.show,callback:function(t){e.$set(e.moreCmdModal,"show",t)},expression:"moreCmdModal.show"}},[e.moreCmdModal.model?a("let-form",{ref:"moreCmdForm"},[a("let-form-item",{attrs:{itemWidth:"100%"}},[a("let-radio",{attrs:{label:"setloglevel"},model:{value:e.moreCmdModal.model.selected,callback:function(t){e.$set(e.moreCmdModal.model,"selected",t)},expression:"moreCmdModal.model.selected"}},[e._v(" "+e._s(e.$t("serverList.servant.logLevel"))+" ")]),a("let-select",{attrs:{size:"small",disabled:"setloglevel"!==e.moreCmdModal.model.selected},model:{value:e.moreCmdModal.model.setloglevel,callback:function(t){e.$set(e.moreCmdModal.model,"setloglevel",t)},expression:"moreCmdModal.model.setloglevel"}},e._l(e.logLevels,(function(t){return a("let-option",{key:t,attrs:{value:t}},[e._v(e._s(t))])})),1)],1),a("let-form-item",{attrs:{itemWidth:"100%"}},[a("let-radio",{attrs:{label:"loadconfig"},model:{value:e.moreCmdModal.model.selected,callback:function(t){e.$set(e.moreCmdModal.model,"selected",t)},expression:"moreCmdModal.model.selected"}},[e._v(" "+e._s(e.$t("serverList.servant.pushFile"))+" ")]),a("let-select",{attrs:{size:"small",placeholder:e.moreCmdModal.model.configs&&e.moreCmdModal.model.configs.length?e.$t("pub.dlg.defaultValue"):e.$t("pub.dlg.noConfFile"),disabled:!(e.moreCmdModal.model.configs&&e.moreCmdModal.model.configs.length)||"loadconfig"!==e.moreCmdModal.model.selected,required:"loadconfig"===e.moreCmdModal.model.selected},model:{value:e.moreCmdModal.model.loadconfig,callback:function(t){e.$set(e.moreCmdModal.model,"loadconfig",t)},expression:"moreCmdModal.model.loadconfig"}},e._l(e.moreCmdModal.model.configs,(function(t){return a("let-option",{key:t.filename,attrs:{value:t.filename}},[e._v(" "+e._s(t.filename)+" ")])})),1)],1),a("let-form-item",{attrs:{itemWidth:"100%"}},[a("let-radio",{attrs:{label:"command"},model:{value:e.moreCmdModal.model.selected,callback:function(t){e.$set(e.moreCmdModal.model,"selected",t)},expression:"moreCmdModal.model.selected"}},[e._v(" "+e._s(e.$t("serverList.servant.sendCommand"))+" ")]),a("let-input",{attrs:{size:"small",disabled:"command"!==e.moreCmdModal.model.selected,required:"command"===e.moreCmdModal.model.selected},model:{value:e.moreCmdModal.model.command,callback:function(t){e.$set(e.moreCmdModal.model,"command",t)},expression:"moreCmdModal.model.command"}})],1),a("let-form-item",{attrs:{itemWidth:"100%"}},[a("let-radio",{attrs:{label:"connection"},model:{value:e.moreCmdModal.model.selected,callback:function(t){e.$set(e.moreCmdModal.model,"selected",t)},expression:"moreCmdModal.model.selected"}},[e._v(" "+e._s(e.$t("serverList.servant.serviceLink"))+" ")])],1)],1):e._e()],1),a("let-modal",{attrs:{title:e.detailModal.title,width:"700px",footShow:!1},on:{close:e.closeDetailModal},model:{value:e.detailModal.show,callback:function(t){e.$set(e.detailModal,"show",t)},expression:"detailModal.show"}},[a("div",{staticStyle:{padding:"20px 0 0"}},[e.detailModal.model&&e.detailModal.model.detail?a("pre",[e._v(e._s(e.detailModal.model.detail||e.$t("cfg.msg.empty")))]):e._e(),a("div",{ref:"detailModalLoading",staticClass:"detail-loading"})])])],1)}),q=[],j=(a("99af"),a("7db0"),a("d81d"),a("96cf"),a("1da1")),z=a("5530"),V=a("dcab"),R=a("c1df"),E=a.n(R),B=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.DetailModel.show?a("el-dialog",{attrs:{title:e.$t("operate.k8s"),visible:e.DetailModel.show,width:"1060px","before-close":e.closeDetailModel,top:"10px","close-on-click-modal":!1},on:{"update:visible":function(t){return e.$set(e.DetailModel,"show",t)}}},[a("el-collapse",{attrs:{accordion:""},on:{change:e.HandleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-collapse-item",{attrs:{name:"0"}},[a("template",{slot:"title"},[a("b",[e._v(e._s(e.$t("operate.copyNode")))])]),a("k8s-manger",{attrs:{k8sModel:e.k8sModel,labelMatchArr:e.labelMatchArr,LabelMatchOperator:e.LabelMatchOperator,mode:"copyNode"}})],2),a("el-collapse-item",{attrs:{name:"1"}},[a("template",{slot:"title"},[a("b",[e._v(e._s(e.$t("operate.nodeSelect")))])]),a("k8s-manger",{attrs:{k8sModel:e.k8sModel,labelMatchArr:e.labelMatchArr,LabelMatchOperator:e.LabelMatchOperator,mode:"nodeSelect"}})],2),a("el-collapse-item",{attrs:{name:"2"}},[a("template",{slot:"title"},[a("b",[e._v(e._s(e.$t("operate.network")))])]),a("network-mapping",{attrs:{k8sModel:e.k8sModel}})],2),a("el-collapse-item",{attrs:{name:"3"}},[a("template",{slot:"title"},[a("b",[e._v(e._s(e.$t("operate.disk")))])]),a("disk-manger",{attrs:{k8sModel:e.k8sModel,mounts:e.mounts}})],2),a("el-collapse-item",{attrs:{name:"4"}},[a("template",{slot:"title"},[a("b",[e._v(e._s(e.$t("operate.resource")))])]),a("resource-manger",{attrs:{sourceModel:e.sourceModel}})],2),a("el-collapse-item",{attrs:{name:"6"}},[a("template",{slot:"title"},[a("b",[e._v(e._s(e.$t("operate.hpa")))])]),a("div",[a("hpa-manger",{attrs:{hpaModel:e.hpaModel,serverData:e.serverData,sourceModel:e.sourceModel,indicators:e.indicators}})],1)],2),a("el-collapse-item",{attrs:{name:"5"}},[a("template",{slot:"title"},[a("b",[e._v(e._s(e.$t("operate.yaml")))])]),a("k8s-yaml-edit",{ref:"yamlEdit",on:{flushOthers:e.show}})],2)],1)],1):e._e()},H=[],F=(a("b64b"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-card",[e.k8sModel?a("let-form",{ref:"k8sDetailForm",staticClass:"two-columns",attrs:{itemWidth:"360px",columns:2}},["copyNode"==e.mode?a("div",[a("let-form-item",{attrs:{label:e.$t("deployService.table.th.replicas")}},[a("let-input",{attrs:{size:"small",type:"number",min:0,placeholder:e.$t("deployService.form.placeholder"),required:"","required-tip":e.$t("deployService.table.tips.empty"),"pattern-tip":e.$t("deployService.form.placeholder")},model:{value:e.k8sModel.Replicas,callback:function(t){e.$set(e.k8sModel,"Replicas",t)},expression:"k8sModel.Replicas"}})],1)],1):e._e(),"nodeSelect"==e.mode?a("div",[a("let-form-item",{attrs:{label:e.$t("deployService.form.affinity"),itemWidth:"45%"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{size:"small"},model:{value:e.k8sModel.abilityAffinity,callback:function(t){e.$set(e.k8sModel,"abilityAffinity",t)},expression:"k8sModel.abilityAffinity"}},e._l(e.abilityAffinities,(function(t){return a("el-option",{key:t,attrs:{value:t}},[e._v(e._s(t))])})),1)],1),0==e.labelMatchArr.length?a("let-form-item",{attrs:{itemWidth:"45%"}},[a("el-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"text",size:"mini"},on:{click:function(t){return e.addItems(0,e.labelMatchArr)}}},[e._v(" "+e._s(e.$t("deployService.form.labelMatch.addLabel"))+" ")])],1):e._e(),e._l(e.labelMatchArr,(function(t,r){return a("div",[a("let-form-item",{attrs:{label:e.$t("nodeList.table.th.label"),itemWidth:"30%"}},[a("let-input",{attrs:{size:"small",placeholder:e.$t("nodeList.table.th.label"),"pattern-tip":e.$t("deployService.form.labelMatch.labelValid")},model:{value:t.key,callback:function(a){e.$set(t,"key",a)},expression:"item.key"}})],1),a("let-form-item",{attrs:{label:"operator",itemWidth:"15%"}},[a("el-select",{attrs:{size:"small"},on:{change:e.changeLabelOperator},model:{value:t.operator,callback:function(a){e.$set(t,"operator",a)},expression:"item.operator"}},e._l(e.LabelMatchOperator,(function(t){return a("el-option",{key:t,attrs:{value:t}},[e._v(e._s(t))])})),1)],1),a("let-form-item",{attrs:{label:e.$t("nodes.label.value"),itemWidth:"40%"}},[a("el-select",{staticStyle:{width:"95%"},attrs:{disabled:t.disableValue,multiple:"",filterable:"","allow-create":"","multiple-limit":63,"default-first-option":"",placeholder:e.$t("deployService.form.labelMatch.labelValue"),size:"small"},on:{change:function(t){e.addLabelValues(t,r)}},model:{value:t.values,callback:function(a){e.$set(t,"values",a)},expression:"item.values"}},e._l(t.values,(function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),a("el-button",{attrs:{type:"primary",icon:"el-icon-plus",size:"mini",circle:""},on:{click:function(t){return e.addItems(r,e.labelMatchArr)}}}),a("el-button",{attrs:{type:"danger",icon:"el-icon-minus",size:"mini",circle:""},on:{click:function(t){return e.delItems(r,e.labelMatchArr)}}})],1)}))],2):e._e()]):e._e(),a("el-row",{staticStyle:{"margin-top":"15px"},attrs:{type:"flex",justify:"end"}},[a("el-col",{attrs:{span:2}},[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.saveK8sDetail}},[e._v(e._s(e.$t("operate.save")))])],1)],1)],1)}),J=[],Y=(a("d3b7"),a("498a"),a("ddb0"),a("b85c")),U={props:["k8sModel","labelMatchArr","LabelMatchOperator","mode"],name:"k8sManager",data:function(){return{serverId:"",K8SNodeList:[],K8SisCheckedAll:!1,abilityAffinities:["AppRequired","ServerRequired","AppOrServerPreferred","None"]}},methods:{changeKind:function(){this.$forceUpdate()},adapterServerK8S:function(e){var t=Object.assign({},e),a=this.labelMatchArr.map((function(e){return{key:e.key,operator:e.operator,values:e.values}}));return delete t.NodeSelector.nodeBind,t.NodeSelector=a,t},saveK8sDetail:function(){var e=this;if(this.$refs.k8sDetailForm.validate()&&this.validateLabels(this.k8sModel)){var t=this.$Loading.show(),a=this.adapterServerK8S(this.k8sModel);this.$ajax.postJSON("/k8s/api/server_k8s_update",{ServerId:a.ServerId,Replicas:a.Replicas,abilityAffinity:a.abilityAffinity,NodeSelector:a.NodeSelector}).then((function(a){t.hide(),e.$message.success("".concat(e.$t("common.success")))})).catch((function(a){t.hide(),e.$message.error("".concat(e.$t("common.error"),": ").concat(a.err_msg||a.message))}))}},validateLabels:function(e){var t=!0;if("LabelMatch"===e.NodeSelector.Kind){var a,r=Object(Y["a"])(this.labelMatchArr);try{for(r.s();!(a=r.n()).done;){var o=a.value;if(""==o.key.trim()){this.$message.error("".concat(this.$t("deployService.form.labelMatch.errorKey"))),t=!1;break}if(-1=="Exists,DoesNotExist".indexOf(o.operator)&&0==o.values.length){this.$message.error("".concat(this.$t("deployService.form.labelMatch.errorValue"))),t=!1;break}}}catch(i){r.e(i)}finally{r.f()}return t}return!0},addLabelValues:function(e,t){var a=this,r=/^([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9]?$/;this.labelMatchArr[t].values.forEach((function(e,t){r.test(e)||(a.labelMatchArr[t].values.splice(t,1),a.$message.error("".concat(a.$t("deployService.form.labelMatch.labelValueValid"))))}))},changeLabelOperator:function(e){var t=this;this.labelMatchArr.forEach((function(e){"Exists"==e.operator||"DoesNotExist"==e.operator?(t.$set(e,"disableValue",!0),t.$set(e,"values",[])):t.$set(e,"disableValue",!1)}))},addItems:function(e,t){t.length>=63?this.$message.error("".concat(this.$t("deployService.form.labelMatch.labelMax"))):(t.splice(e+1,0,{key:"",operator:"In",values:[]}),this.$forceUpdate())},delItems:function(e,t){t.splice(e,1),this.$forceUpdate()}}},K=U,W=Object(w["a"])(K,F,J,!1,null,null,null),Z=W.exports,G=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-card",{attrs:{shadow:"never"}},[e.k8sModel?a("let-form",{ref:"k8sDetailForm",staticClass:"two-columns",attrs:{itemWidth:"360px",columns:2}},[a("div",[a("div",[a("let-form-item",{attrs:{label:e.$t("deployService.table.th.hostIpc"),itemWidth:"25%"}},[a("el-radio-group",{on:{change:e.changeKind},model:{value:e.k8sModel.HostIpc,callback:function(t){e.$set(e.k8sModel,"HostIpc",t)},expression:"k8sModel.HostIpc"}},[a("el-radio",{attrs:{label:!0}},[e._v(e._s(e.$t("common.true")))]),a("el-radio",{attrs:{label:!1}},[e._v(e._s(e.$t("common.false")))])],1)],1),a("let-form-item",{attrs:{label:e.$t("deployService.table.th.hostNetwork"),itemWidth:"25%"}},[a("el-radio-group",{on:{change:e.changeKind},model:{value:e.k8sModel.HostNetwork,callback:function(t){e.$set(e.k8sModel,"HostNetwork",t)},expression:"k8sModel.HostNetwork"}},[a("el-radio",{attrs:{label:!0}},[e._v(e._s(e.$t("common.true")))]),a("el-radio",{attrs:{label:!1}},[e._v(e._s(e.$t("common.false")))])],1)],1),a("let-form-item",{attrs:{label:e.$t("deployService.table.th.hostPort"),itemWidth:"25%"}},[a("el-radio-group",{on:{change:e.changeKind},model:{value:e.k8sModel.showHostPort,callback:function(t){e.$set(e.k8sModel,"showHostPort",t)},expression:"k8sModel.showHostPort"}},[a("el-radio",{attrs:{label:!0}},[e._v(e._s(e.$t("common.true")))]),a("el-radio",{attrs:{label:!1}},[e._v(e._s(e.$t("common.false")))])],1)],1)],1),e.k8sModel.showHostPort?a("div",{staticStyle:{"padding-right":"30px"}},[a("let-table",{attrs:{data:e.k8sModel.HostPortArr}},[a("let-table-column",{attrs:{title:"OBJ"},scopedSlots:e._u([{key:"head",fn:function(t){return[a("span",{staticClass:"required"},[e._v(e._s(t.column.title))])]}},{key:"default",fn:function(t){return[a("let-input",{attrs:{size:"small",placeholder:e.$t("deployService.form.placeholder"),required:"","required-tip":e.$t("deployService.form.objTips"),pattern:"^[a-zA-Z0-9]+$","pattern-tip":e.$t("deployService.form.placeholder")},model:{value:t.row.obj,callback:function(a){e.$set(t.row,"obj",a)},expression:"props.row.obj"}})]}}],null,!1,910875067)}),a("let-table-column",{attrs:{title:e.$t("deployService.table.th.hostPort")},scopedSlots:e._u([{key:"head",fn:function(t){return[a("span",{staticClass:"required"},[e._v(e._s(t.column.title))])]}},{key:"default",fn:function(t){return[a("let-input",{attrs:{size:"small",type:"number",min:1,max:65535,placeholder:"1-65535",required:"","required-tip":e.$t("deployService.table.tips.empty")},model:{value:t.row.HostPort,callback:function(a){e.$set(t.row,"HostPort",a)},expression:"props.row.HostPort"}})]}}],null,!1,4126442684)}),a("let-table-column",{scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-button",{staticClass:"port-button",attrs:{size:"small",theme:"primary"},on:{click:function(a){return e.generateHostPort(t.row)}}},[e._v(" "+e._s(e.$t("deployService.table.th.checkHostPort"))+" ")])]}}],null,!1,1424865976)})],1)],1):e._e()])]):e._e(),a("el-row",{attrs:{type:"flex",justify:"end"}},[a("el-col",{attrs:{span:2}},[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.saveK8sDetail}},[e._v(e._s(e.$t("operate.save")))])],1)],1)],1)},Q=[],X={props:["k8sModel"],name:"k8sManager",data:function(){return{serverId:"",K8SisCheckedAll:!1}},mounted:function(){},methods:{changeKind:function(){this.$forceUpdate()},adapterServerK8S:function(e){var t=Object.assign({},e);return t.HostNetwork&&t.showHostPort?this.$message.error("".concat(this.$t("deployService.form.portOrNetWork"))):(t.showHostPort&&(t.HostPort=[],t.HostPortArr&&t.HostPortArr.forEach((function(e){t.HostPort.push({NameRef:e.obj,Port:Math.floor(e.HostPort)})}))),t)},saveK8sDetail:function(){var e=this;if(this.$refs.k8sDetailForm.validate()){var t=this.$Loading.show(),a=this.adapterServerK8S(this.k8sModel);this.$ajax.postJSON("/k8s/api/server_k8s_update_network",a).then((function(a){t.hide(),e.$message.success("".concat(e.$t("common.success")))})).catch((function(a){t.hide(),e.$message.error("".concat(e.$t("common.error"),": ").concat(a.err_msg||a.message))}))}},generateHostPort:function(e){var t=this;this.$ajax.getJSON("/k8s/api/check_host_port",{NodePort:e.HostPort}).then((function(e){var a="";e.forEach((function(e){-1==e.ret?a+="<p>".concat(e.node,":").concat(e.port,": can use</p>"):a+='<p style="color: #F56C6C">'.concat(e.node,":").concat(e.port,": cannot use</p>")})),t.$message.success({dangerouslyUseHTMLString:!0,message:a})})).catch((function(e){t.$message.error("".concat(t.$t("common.error"),": ").concat(e.message||e.err_msg))}))}}},ee=X,te=Object(w["a"])(ee,G,Q,!1,null,null,null),ae=te.exports,re=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-card",{attrs:{shadow:"never"}},[0==e.mounts.length?a("div",[a("el-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"text",size:"mini"},on:{click:function(t){return e.addDisk(0,e.mounts)}}},[e._v(" "+e._s(e.$t("deployService.disk.addDisk"))+" ")])],1):e._e(),a("el-form",{ref:"disk",attrs:{"label-position":"top","label-width":"120px",size:"mini"}},[e._l(e.mounts,(function(t,r){return a("div",{key:r},[a("el-card",[a("el-row",{attrs:{gutter:22}},[a("el-col",{attrs:{span:10}},[a("el-form-item",{attrs:{label:e.$t("deployService.disk.diskName"),required:""}},[a("el-input",{model:{value:t.name,callback:function(a){e.$set(t,"name",a)},expression:"disk.name"}})],1)],1),a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{label:e.$t("deployService.disk.path"),required:""}},[a("el-input",{model:{value:t.mountPath,callback:function(a){e.$set(t,"mountPath",a)},expression:"disk.mountPath"}})],1)],1)],1),a("el-row",{attrs:{gutter:22}},[a("el-col",{attrs:{span:7}},[a("el-form-item",{attrs:{label:"uid",required:""}},[a("el-input",{attrs:{placeholder:"0"},model:{value:t.source.tLocalVolume.uid,callback:function(a){e.$set(t.source.tLocalVolume,"uid",a)},expression:"disk.source.tLocalVolume.uid"}})],1)],1),a("el-col",{attrs:{span:7}},[a("el-form-item",{attrs:{label:"gid",required:""}},[a("el-input",{attrs:{placeholder:"0"},model:{value:t.source.tLocalVolume.gid,callback:function(a){e.$set(t.source.tLocalVolume,"gid",a)},expression:"disk.source.tLocalVolume.gid"}})],1)],1),a("el-col",{attrs:{span:7}},[a("el-form-item",{attrs:{label:"mode",required:""}},[a("el-input",{attrs:{placeholder:"755"},model:{value:t.source.tLocalVolume.mode,callback:function(a){e.$set(t.source.tLocalVolume,"mode",a)},expression:"disk.source.tLocalVolume.mode"}})],1)],1)],1),a("el-row",[a("el-col",{attrs:{offset:18}},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.addDisk(r,e.mounts)}}},[e._v(" "+e._s(e.$t("deployService.disk.addDisk"))+" ")]),a("el-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"danger",size:"mini"},on:{click:function(t){return e.delDisk(r,e.mounts)}}},[e._v(" "+e._s(e.$t("deployService.disk.delDisk"))+" ")])],1)],1)],1)],1)})),a("el-row",{staticStyle:{"margin-top":"15px"},attrs:{type:"flex",justify:"end"}},[a("el-col",{attrs:{span:2}},[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.save}},[e._v(e._s(e.$t("operate.save")))])],1)],1)],2)],1)},oe=[],ie={props:["k8sModel","mounts"],name:"disk",methods:{validate:function(){},save:function(){var e=this;if(this.validate){var t=this.$Loading.show();this.$ajax.postJSON("/k8s/api/server_k8s_update_disk",{ServerId:this.k8sModel.ServerId,mounts:this.mounts}).then((function(a){t.hide(),e.$message.success("".concat(e.$t("common.success")))})).catch((function(a){t.hide(),e.$message.error("".concat(e.$t("common.error"),": ").concat(a.err_msg||a.message))}))}},addDisk:function(e,t){t.splice(e+1,0,{name:"",source:{tLocalVolume:{uid:"",gid:"",mode:""}},mountPath:""}),this.$forceUpdate()},delDisk:function(e,t){t.splice(e,1),this.$forceUpdate()}}},se=ie,le=Object(w["a"])(se,re,oe,!1,null,"3186cc02",null),ne=le.exports,ce=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-card",[a("el-form",{attrs:{"label-width":"100px","label-position":"top",size:"mini"}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:e.$t("deployService.resources.limitCpu"),itemWidth:"50%"}},[a("el-input",{attrs:{placeholder:e.$t("deployService.resources.example")+":1000",size:"small",onkeyup:"value=value.replace(/[^\\d]/g,'')"},model:{value:e.sourceModel.limitCpu,callback:function(t){e.$set(e.sourceModel,"limitCpu",t)},expression:"sourceModel.limitCpu"}},[a("template",{slot:"append"},[e._v("milli CPUs")])],2)],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:e.$t("deployService.resources.limitMem"),itemWidth:"50%"}},[a("el-input",{attrs:{placeholder:e.$t("deployService.resources.example")+":128",size:"small",onkeyup:"value=value.replace(/[^\\d]/g,'')"},model:{value:e.sourceModel.limitMem,callback:function(t){e.$set(e.sourceModel,"limitMem",t)},expression:"sourceModel.limitMem"}},[a("template",{slot:"append"},[e._v("MiB")])],2)],1)],1)],1),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:e.$t("deployService.resources.requestCpu"),itemWidth:"50%"}},[a("el-input",{attrs:{placeholder:e.$t("deployService.resources.example")+":1000",size:"small",onkeyup:"value=value.replace(/[^\\d]/g,'')"},model:{value:e.sourceModel.requestCpu,callback:function(t){e.$set(e.sourceModel,"requestCpu",t)},expression:"sourceModel.requestCpu"}},[a("template",{slot:"append"},[e._v("milli CPUs")])],2)],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:e.$t("deployService.resources.requestMem"),itemWidth:"50%"}},[a("el-input",{attrs:{placeholder:e.$t("deployService.resources.example")+":128",size:"small",onkeyup:"value=value.replace(/[^\\d]/g,'')"},model:{value:e.sourceModel.requestMem,callback:function(t){e.$set(e.sourceModel,"requestMem",t)},expression:"sourceModel.requestMem"}},[a("template",{slot:"append"},[e._v("MiB")])],2)],1)],1)],1),a("el-row",{attrs:{type:"flex",justify:"end"}},[a("el-col",{attrs:{span:2}},[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.save}},[e._v(e._s(e.$t("operate.save")))])],1)],1)],1)],1)},de=[],ue={props:["sourceModel"],name:"resource",methods:{save:function(){var e=this;this.$ajax.postJSON("/k8s/api/server_k8s_update_resource",this.sourceModel).then((function(t){e.$message.success("".concat(e.$t("common.success")))})).catch((function(t){e.$message.error("".concat(e.$t("common.error"),": ").concat(t.err_msg||t.message))}))}}},pe=ue,me=Object(w["a"])(pe,ce,de,!1,null,"04ef7cb6",null),fe=me.exports,he=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-card",[a("el-form",{ref:"hpaForm",attrs:{"label-position":"top",size:"small",model:e.hpaModel}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:e.$t("deployService.hpa.form.minReplicas"),prop:"minReplicas",rules:[{required:!0,message:e.$t("deployService.hpa.tip.minReplicas"),trigger:"blur"}]}},[a("el-input",{attrs:{oninput:"value=value.replace(/[^\\d]/g,'')",placeholder:e.$t("deployService.hpa.tip.minReplicas")},model:{value:e.hpaModel.minReplicas,callback:function(t){e.$set(e.hpaModel,"minReplicas",t)},expression:"hpaModel.minReplicas"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:e.$t("deployService.hpa.form.maxReplicas"),prop:"maxReplicas",rules:[{required:!0,message:e.$t("deployService.hpa.tip.maxReplicas")}]}},[a("el-input",{attrs:{oninput:"value=value.replace(/[^\\d]/g,'')",placeholder:e.$t("deployService.hpa.tip.maxReplicas")},model:{value:e.hpaModel.maxReplicas,callback:function(t){e.$set(e.hpaModel,"maxReplicas",t)},expression:"hpaModel.maxReplicas"}})],1)],1)],1),a("el-divider",{attrs:{"content-position":"left"}},[e._v(e._s(e.$t("inf.benchmark.detail")))]),e._l(e.hpaModel.indicatorData,(function(t,r){return a("el-card",{key:r,staticStyle:{"margin-bottom":"5px"},attrs:{shadow:"hover"}},[a("el-alert",{attrs:{type:"warning",title:e.$t("deployService.hpa.tip.t2"),"show-icon":"",closable:!1}}),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:e.$t("deployService.hpa.form.IndicatorName"),prop:"indicatorData."+r+".name",rules:[{required:!0,message:e.$t("deployService.hpa.tip.IndicatorName"),trigger:"change"}]}},[a("el-select",{staticStyle:{width:"100%"},attrs:{filterable:""},on:{change:function(a){return e.changeType(r,t.name)}},model:{value:t.name,callback:function(a){e.$set(t,"name",a)},expression:"item.name"}},e._l(e.customTargets,(function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1)],1)],1),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:e.$t("deployService.hpa.form.targetType"),prop:"indicatorData."+r+".targetType",rules:[{required:!0,message:e.$t("deployService.hpa.tip.targetType"),trigger:"change"}]}},[a("el-select",{staticStyle:{width:"100%"},on:{change:function(t){return e.$forceUpdate()}},model:{value:t.targetType,callback:function(a){e.$set(t,"targetType",a)},expression:"item.targetType"}},e._l(e.getTargetTypes(t.name),(function(e,t){return a("el-option",{key:t,attrs:{label:e,value:t}})})),1)],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:e.$t("deployService.hpa.form.value"),prop:"indicatorData."+r+".value",rules:[{required:!0,message:e.$t("deployService.hpa.tip.value"),trigger:"change"}]}},[a("el-input",{attrs:{onkeyup:"value=value.replace(/[^\\d]/g,'')"},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}},[a("template",{slot:"append"},[e._v(e._s(e._f("getValueUnit")(t.targetType)))])],2)],1)],1)],1),a("el-row",{attrs:{type:"flex",justify:"end"}},[a("el-col",{attrs:{span:3}},[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.addItems(r,e.hpaModel.indicatorData)}}},[e._v(" "+e._s(e.$t("deployService.hpa.form.addIndicator"))+" ")])],1),a("el-col",{attrs:{span:3}},[a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.delItems(r,e.hpaModel.indicatorData)}}},[e._v(" "+e._s(e.$t("deployService.hpa.form.delIndicator"))+" ")])],1)],1)],1)}))],2),a("el-row",{staticStyle:{"margin-top":"15px"},attrs:{type:"flex",justify:"end"}},[a("el-col",{attrs:{span:2}},[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.save}},[e._v(e._s(e.$t("operate.save")))])],1)],1)],1)},ve=[],ge=(a("4d63"),a("25f0"),a("466d"),{props:["hpaModel","serverData","sourceModel","indicators"],name:"hpa",data:function(){return{customTargets:["cpu","memory"]}},mounted:function(){},filters:{getValueUnit:function(e){return"averagevalue"==e.toLowerCase()?"MiB":"averageutilization"==e.toLowerCase()?"%":"MiB"}},methods:{save:function(){var e=this;this.sourceModel.limitCpu||this.sourceModel.limitMem||this.sourceModel.requestCpu||this.sourceModel.requestMem?this.$refs.hpaForm.validate((function(t){var a=Object.assign({},{ServerId:e.serverData.ServerId},e.hpaModel,{serverData:e.serverData});t?e.$ajax.postJSON("/k8s/api/create_hpa",a).then((function(t){e.$message.success("".concat(e.$t("common.success")))})).catch((function(t){e.$message.error("".concat(e.$t("common.error"),": ").concat(t.err_msg||t.message))})):e.$message.warning("".concat(e.$t("deployService.hpa.tip.checkForm")))})):this.$message.error("".concat(this.$t("deployService.resources.tip.resources")))},addItems:function(e,t){t.splice(e+1,0,{name:"cpu",targetType:"AverageUtilization",value:""}),this.$forceUpdate()},delItems:function(e,t){1!==t.length&&(t.splice(e,1),this.$forceUpdate())},changeType:function(e,t){var a=this.getMatchIndicators(t);this.$set(this.hpaModel.indicatorData[e],"targetType",a.target[0].type),this.$forceUpdate()},getMatchIndicators:function(e){var t,a,r=Object(Y["a"])(this.indicators);try{for(r.s();!(a=r.n()).done;){var o=a.value;if("exact"==o.matchType&&o.match.toLowerCase()==e.toLowerCase()){t=o;break}if("regex"==o.matchType){var i=new RegExp(o.match);if(i.test(e)){t=o;break}}}}catch(s){r.e(s)}finally{r.f()}return t||this.$message.error("".concat(this.$t("deployService.hpa.tip.noIndicator"))),t},getTargetTypes:function(e){var t=this,a=this.getMatchIndicators(e),r={};return a.target.forEach((function(e){e.type.toLowerCase()=="AverageValue".toLowerCase()&&(r[e.type]=t.$t("deployService.hpa.form.averageValue")),e.type.toLowerCase()=="AverageUtilization".toLowerCase()&&(r[e.type]=t.$t("deployService.hpa.form.averageUtilization"))})),r}}}),be=ge,$e=(a("6c7a"),Object(w["a"])(be,he,ve,!1,null,"23ac87cc",null)),ke=$e.exports,ye=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-card",{attrs:{shadow:"never"}},[a("div",{staticStyle:{border:"1px solid #595656","border-radius":"5px"}},[a("yaml-editor",{ref:"yamlEdit",staticStyle:{margin:"1px"},model:{value:e.yamlContent,callback:function(t){e.yamlContent=t},expression:"yamlContent"}})],1),a("div",{staticClass:"bottom"},[a("el-upload",{attrs:{"before-upload":e.uploadFile,"show-file-list":!1,action:"","list-type":"yml/yaml"}},[a("el-button",{attrs:{size:"mini",type:"primary"}},[e._v(e._s(e.$t("deployService.batchDeploy.btn.uploadApplyConf"))+" ")])],1),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",size:"mini"},on:{click:e.save}},[e._v(e._s(e.$t("operate.save"))+" ")])],1)])},Se=[],_e=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"yaml-editor"},[a("textarea",{ref:"textarea",attrs:{id:"textarea"}})])},we=[],Me=a("56b3"),xe=a.n(Me);a("0dd0"),a("a7be"),a("b866"),a("ced0"),a("8822"),a("b8d1");window.jsyaml=a("e2c1");var Ce={name:"yaml-editor",props:["value"],data:function(){return{yamlEditor:!1}},watch:{value:function(e){var t=this.yamlEditor.getValue();e!==t&&this.yamlEditor.setValue(this.value)}},mounted:function(){var e=this;this.yamlEditor=xe.a.fromTextArea(this.$refs.textarea,{lineNumbers:!0,mode:"text/x-yaml",theme:"idea",lint:!0,lineWrapping:!0,autofocus:!0,extraKeys:{"Ctrl-Space":"autocomplete"},foldGutter:!0,gutters:["CodeMirror-lint-markers"],smartIndent:!0}),this.yamlEditor.on("change",(function(t){e.$emit("changed",t.getValue()),e.$emit("input",t.getValue())})),this.yamlEditor.setValue(this.value),this.$nextTick((function(){var t=e;setInterval((function(){t.yamlEditor.refresh()}),500)}))},methods:{getValue:function(){return this.yamlEditor.getValue()},refresh:function(){this.yamlEditor.refresh()},readonly:function(){this.yamlEditor.setOption("readOnly",!0)}}},Ne=Ce,Le=(a("0d3c"),Object(w["a"])(Ne,_e,we,!1,null,"d17a4854",null)),Te=Le.exports,Ie={name:"k8sYamlEdit",components:{YamlEditor:Te},data:function(){return{ServerId:"",plural:"",yamlContent:""}},methods:{refresh:function(){this.$refs.yamlEdit.refresh()},readonly:function(){this.$refs.yamlEdit.readonly()},show:function(e,t){var a=this;this.ServerId=e,this.plural=t,this.$ajax.getJSON("/k8s/api/get_object",{plural:t,ServerId:e}).then((function(e){a.yamlContent=e})).catch((function(e){a.$message.error("".concat(a.$t("common.error"),": ").concat(e.err_msg||e.message))}))},save:function(){var e=this;this.$ajax.postJSON("/k8s/api/update_object",{plural:this.plural,ServerId:this.ServerId,yamlContent:this.yamlContent}).then((function(t){e.$emit("flushOthers",e.ServerId),e.$message.success("".concat(e.$t("common.success"))),e.$emit("successFun")})).catch((function(t){e.$message.error("".concat(e.$t("common.error"),": ").concat(t.err_msg||t.message))}))},uploadFile:function(e){var t=e.name;if(-1==t.lastIndexOf("."))return this.$message.error("".concat(this.$t("deployService.batchDeploy.errFile"))),!1;var a=".yml|.yaml|",r=t.substring(t.lastIndexOf(".")).toLowerCase();if(-1==a.indexOf(r+"|"))return this.$message.error("".concat(this.$t("deployService.batchDeploy.errFile"))),!1;var o=new FileReader;o.readAsText(e,"UTF-8");var i=this;o.onload=function(e){e.target.result;i.$nextTick((function(){i.yamlContent=o.result}))}}}},Ae=Ie,De=(a("ca6f"),Object(w["a"])(Ae,ye,Se,!1,null,"697eb848",null)),Pe=De.exports,Oe={name:"index",components:{k8sManger:Z,diskManger:ne,networkMapping:ae,resourceManger:fe,K8sYamlEdit:Pe,hpaManger:ke},data:function(){return{DetailModel:{show:!1},activeName:"0",k8sModel:{},labelMatchArr:[],LabelMatchOperator:[],sourceModel:{},serverData:{},hpaModel:{minReplicas:"",maxReplicas:"",indicatorData:[]},indicators:[],yamlContent:"",mounts:[],serverId:""}},methods:{HandleClick:function(e){var t=this;"5"==e&&this.$nextTick((function(){t.$refs.yamlEdit.show(t.serverId,"tservers"),t.$refs.yamlEdit.refresh()}))},closeDetailModel:function(){this.DetailModel.show=!1,this.k8sModel={},this.mounts=[],this.labelMatchArr=[],this.sourceModel={},this.serverData={},this.hpaModel={minReplicas:"",maxReplicas:"",indicatorData:[]}},show:function(e){var t=this;this.serverId=e,this.DetailModel.show=!0,this.getDefaultValue(),this.getServerInfo(e),this.getHpaInfo(e),this.$nextTick((function(){t.$refs.yamlEdit.show(e,"tservers")}))},getDefaultValue:function(){var e=this,t=this.LabelMatchOperator,a=this.indicators;this.$ajax.getJSON("/k8s/api/default",{}).then((function(r){e.defaultObj=r.ServerServantElem,r.LabelMatchOperator&&(t=r.LabelMatchOperator),r.indicators&&(a=r.indicators),e.LabelMatchOperator=t,e.indicators=a}))},getServerInfo:function(e){var t=this;this.$ajax.getJSON("/k8s/api/server_k8s_select",{ServerId:e}).then((function(a){if(a=a.Data[0],t.serverData=a,t.sourceModel.ServerId=e,a.resources&&Object.keys(a.resources).length>0&&(a.resources.limits&&(a.resources.limits.cpu&&t.$set(t.sourceModel,"limitCpu",a.resources.limits.cpu.replace(/m/g,"")),a.resources.limits.memory&&t.$set(t.sourceModel,"limitMem",a.resources.limits.memory.replace(/m/g,""))),a.resources.requests&&(a.resources.requests.cpu&&t.$set(t.sourceModel,"requestCpu",a.resources.requests.cpu.replace(/m/g,"")),a.resources.requests.memory&&t.$set(t.sourceModel,"requestMem",a.resources.requests.memory.replace(/m/g,"")))),a.showHostPort=!1,a&&a){var r=[];a.HostPort&&Object.keys(a.HostPort).length>0&&(a.showHostPort=!0,a.HostPort.forEach((function(e){r.push({obj:e.nameRef,HostPort:Math.floor(e.port)})})),a.HostPortArr=r),0===r.length&&t.$ajax.getJSON("/k8s/api/server_adapter_select",{ServerId:e}).then((function(e){e&&e.Data&&(e.Data.forEach((function(e){r.push({obj:e.Name,HostPort:0})})),a.HostPortArr=r)}))}a.NodeSelector=a.NodeSelector,t.labelMatchArr=a.NodeSelector,t.labelMatchArr.forEach((function(e){-1!="Exists,DoesNotExist".indexOf(e.operator)&&(e.disableValue=!0)})),t.k8sModel=a,t.mounts=a.mounts.filter((function(e){return e.source.hasOwnProperty("tLocalVolume")}))})).catch((function(e){t.$tip.error("".concat(t.$t("common.error"),": ").concat(e.err_msg||e.message))}))},getHpaInfo:function(e){var t=this;this.$ajax.getJSON("/k8s/api/get_hpa",{serverId:e.toLowerCase().replace(".","-")}).then((function(e){if(console.log("res:"+JSON.stringify(e,null,4)),e&&Object.keys(e).length>1){var a=e.body.spec;t.$set(t.hpaModel,"minReplicas",a.minReplicas),t.$set(t.hpaModel,"maxReplicas",a.maxReplicas),a.metrics.forEach((function(e,a){var r={};"Resource"==e.type&&(r.name=e.resource.name,"averagevalue"==e.resource.target.type.toLowerCase()?(r.targetType="AverageValue",r.value=e.resource.target.averageValue.replace(/m/g,"")):(r.targetType="AverageUtilization",r.value=e.resource.target.averageUtilization)),"Pods"==e.type&&(r.name=e.pods.metric.name,r.targetType=e.pods.target.type,r.value=e.pods.target.averageValue.replace(/m/g,"")),"object"==e.type.toLowerCase()&&(r.name=e.object.metric.name,"averagevalue"==e.object.target.type.toLowerCase()&&(r.targetType="AverageValue",r.value=e.object.target.averageValue.replace(/m/g,""))),t.$set(t.hpaModel.indicatorData,a,r)})),a.metrics&&0==a.metrics.length&&t.hpaModel.indicatorData.push({name:"cpu",targetType:"AverageValue",value:""})}else t.hpaModel.indicatorData.push({name:"cpu",targetType:"AverageUtilization",value:""})})).catch((function(e){t.$message.error("".concat(t.$t("common.error"),": ").concat(e.err_msg||e.message))}))}}},qe=Oe,je=Object(w["a"])(qe,B,H,!1,null,null,null),ze=je.exports,Ve={name:"ServerManage",components:{wrapper:V["a"],k8sManager:ze},data:function(){return{serverData:{level:5,application:"",server_name:"",server_type:""},isreloadlist:!0,reloadTask:null,reloadlist:null,serverList:[],serverNotifyList:[],notifyPagination:{page:1,size:10,total:1},defaultObj:{},configModal:{show:!1,model:null},servantAddModal:{show:!1,isNew:!0,model:null},servantModal:{show:!1,model:null,currentServer:null},servantDetailModal:{show:!1,isNew:!0,model:null},detailModal:{show:!1,title:"",model:null},logLevels:["NONE","DEBUG","TARS","INFO","WARN","ERROR"],moreCmdModal:{show:!1,model:null,currentServer:null},isCheckedAll:!1,checkedList:[]}},props:["treeid"],computed:{isApplication:function(){return-1==this.treeid.indexOf(".")},showOthers:function(){return 5===this.serverData.level},isEndpointValid:function(){return!(!this.servantDetailModal.model||!this.servantDetailModal.model.endpoint)&&this.checkServantEndpoint(this.servantDetailModal.model.endpoint)},isNormal:function(){return"normal"===this.serverData.server_type}},methods:{gotoLog:function(e){var t="/logview.html?History=false&NodeIP=".concat(e.NodeIp,"&ServerApp=").concat(e.ServerApp,"&ServerName=").concat(e.ServerName,"&PodName=").concat(e.PodName);window.open(t)},getServerId:function(){return this.treeid},getState:function(e){var t=e;switch("".concat(e)){case"Active":t="color: green";break;case"Inactive":case"Activating":case"Deactivating":case"Unknown":t="color: red";break}return t},reloadServerList:function(){var e=this;if(this.$parent.BTabs.length>0){var t=this.$parent.BTabs[0].path,a=t.substring(t.lastIndexOf("/")+1);"manage"!==a&&e.reloadTask||(e.reloadTask=setTimeout((function(){e.isreloadlist&&"#/server"==location.hash&&e.$parent.treeid==e.getServerId()&&(e.getServerList(),e.getServerNotifyList()),e.reloadServerList()}),3e3))}},startServerList:function(){this.isreloadlist=!0},stopServerList:function(){this.isreloadlist=!1},getServerList:function(){var e=this;this.$ajax.getJSON("/k8s/api/pod_list",{ServerId:this.getServerId()}).then((function(t){e.serverList=[],t.hasOwnProperty("Data")&&(t.Data.forEach((function(e){e.isChecked=!1,e.CreateTime=E()(e.CreateTime).format("YYYY-MM-DD HH:mm:ss"),e.StartTime=E()(e.StartTime).format("YYYY-MM-DD HH:mm:ss")})),e.serverList=t.Data)})).catch((function(e){}))},getServerNotifyList:function(){var e=this;this.showOthers&&this.$ajax.getJSON("/k8s/api/server_notify_list",{ServerId:this.getServerId(),size:this.notifyPagination.size,page:this.notifyPagination.page}).then((function(t){e.notifyPagination.total=Math.ceil(t.total.value/e.notifyPagination.size),e.serverNotifyList=t.hits||[],e.serverNotifyList.forEach((function(e){e._source.timeStr=E()(e._source.notifyTime).format("YYYY-MM-DD HH:mm:ss")}))})).catch((function(e){}))},statusStyle:function(e){return e=e||"","restart"==e||-1!=e.indexOf("[succ]")?"color: green":"stop"==e||-1!=e.indexOf("[alarm]")||-1!=e.indexOf("error")||-1!=e.indexOf("ERROR")?"color: red":""},notifyGotoPage:function(e){this.notifyPagination.page=e,this.getServerNotifyList()},getServerConfig:function(e){var t=this;this.stopServerList();var a=this.$loading.show({target:this.$refs.configFormLoading});this.$ajax.getJSON("/k8s/api/server_option_select",{ServerId:e}).then((function(e){a.hide(),t.configModal.model?t.configModal.model=Object.assign({},t.configModal.model,e.Data[0]):(e.templates=[],t.configModal.model=e.Data[0]),t.startServerList()})).catch((function(e){a.hide(),t.closeConfigModal(),t.startServerList(),t.$tip.error("".concat(t.$t("serverList.restart.failed"),": ").concat(e.err_msg||e.message))}))},configServer:function(){var e=this;this.stopServerList(),this.configModal.show=!0,this.$ajax.getJSON("/k8s/api/template_select").then((function(t){e.configModal.model?e.configModal.model.templates=t.Data:e.configModal.model={templates:t.Data},e.getServerConfig(e.getServerId()),e.startServerList()})).catch((function(t){e.startServerList(),e.$tip.error("".concat(e.$t("serverList.restart.failed"),": ").concat(t.err_msg||t.message))}))},saveConfig:function(){var e=this;if(this.$refs.configForm.validate()){var t=this.$Loading.show();this.$ajax.postJSON("/k8s/api/server_option_update",Object(z["a"])({isBak:this.configModal.model.bak_flag},this.configModal.model)).then((function(a){t.hide(),e.closeConfigModal(),e.$tip.success(e.$t("common.success"))}))}},closeConfigModal:function(){this.$refs.configForm&&this.$refs.configForm.resetValid(),this.configModal.show=!1,this.configModal.model=null,this.startServerList()},startServer:function(){var e=this;return Object(j["a"])(regeneratorRuntime.mark((function t(){var a,r,o,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.checkLauncherType();case 2:if(!t.sent){t.next=5;break}return e.$tip.warning(e.$t("pub.dlg.foregroundTip")),t.abrupt("return");case 5:if(e.stopServerList(),a=e.checkedList.filter((function(e){return e.isChecked})),!(a.length<=0)){t.next=10;break}return e.$tip.warning(e.$t("pub.dlg.a")),t.abrupt("return");case 10:r=a.map((function(e){return e.PodIp})),o=a[0].ServerApp,i=a[0].ServerName,e.$confirm(e.$t("serverList.startService.msg.startService"),e.$t("common.alert")).then((function(){e.$ajax.getJSON("/k8s/api/send_command",{command:"StartServer",podIp:r,serverApp:o,serverName:i}).then((function(t){e.$tip.success(e.$t("common.success")),e.startServerList(),e.getServerNotifyList()})).catch((function(t){e.$tip.error("".concat(e.$t("common.error"),": ").concat(t.err_msg||t.message))}))})).catch((function(){e.startServerList()}));case 14:case"end":return t.stop()}}),t)})))()},restartServer:function(){var e=this;return Object(j["a"])(regeneratorRuntime.mark((function t(){var a,r,o,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.checkLauncherType();case 2:if(!t.sent){t.next=5;break}return e.$tip.warning(e.$t("pub.dlg.foregroundTip")),t.abrupt("return");case 5:if(e.stopServerList(),a=e.checkedList.filter((function(e){return e.isChecked})),!(a.length<=0)){t.next=10;break}return e.$tip.warning(e.$t("pub.dlg.a")),t.abrupt("return");case 10:r=a.map((function(e){return e.PodIp})),o=a[0].ServerApp,i=a[0].ServerName,e.$confirm(e.$t("serverList.restartService.msg.restartService"),e.$t("common.alert")).then((function(){e.$ajax.getJSON("/k8s/api/send_command",{command:"RestartServer",podIp:r,serverApp:o,serverName:i}).then((function(t){e.$tip.success(e.$t("common.success")),e.startServerList(),e.getServerNotifyList()})).catch((function(t){e.$tip.error("".concat(e.$t("common.error"),": ").concat(t.err_msg||t.message))}))})).catch((function(){e.startServerList()}));case 14:case"end":return t.stop()}}),t)})))()},stopServer:function(){var e=this;return Object(j["a"])(regeneratorRuntime.mark((function t(){var a,r,o,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.checkLauncherType();case 2:if(!t.sent){t.next=5;break}return e.$tip.warning(e.$t("pub.dlg.foregroundTip")),t.abrupt("return");case 5:if(e.stopServerList(),a=e.checkedList.filter((function(e){return e.isChecked})),!(a.length<=0)){t.next=10;break}return e.$tip.warning(e.$t("pub.dlg.a")),t.abrupt("return");case 10:r=a.map((function(e){return e.PodIp})),o=a[0].ServerApp,i=a[0].ServerName,e.$confirm(e.$t("serverList.stopService.msg.stopService"),e.$t("common.alert")).then((function(){e.$ajax.getJSON("/k8s/api/send_command",{command:"StopServer",podIp:r,serverApp:o,serverName:i}).then((function(t){e.$tip.success(e.$t("common.success")),e.startServerList(),e.getServerNotifyList()})).catch((function(t){e.$tip.error("".concat(e.$t("common.error"),": ").concat(t.err_msg||t.message))}))})).catch((function(){e.startServerList()}));case 14:case"end":return t.stop()}}),t)})))()},deletePod:function(e){var t=this;this.$confirm(this.$t("serverList.tips.deletePod"),this.$t("common.alert")).then((function(){t.$ajax.getJSON("/k8s/api/delete_pod",{PodName:e.PodName}).then((function(e){t.$tip.success("".concat(t.$t("common.success"))),t.getServerList()})).catch((function(e){t.$tip.error("".concat(t.$t("common.error"),": ").concat(e.err_msg||e.message))}))}))},viewEvent:function(e){var t=Object.assign({},e),a={application:t.ServerApp,serverName:t.ServerName};this.$router.push({path:"/operation/event",query:a})},viewTemplate:function(){var e=this,t=this.$loading.show({target:this.$refs.servantModalLoading});this.$ajax.getJSON("/k8s/api/server_option_template",{ServerId:this.getServerId()}).then((function(a){t.hide(),e.detailModal.title=e.$t("cfg.title.viewTemplate"),e.detailModal.model={detail:a},e.detailModal.show=!0})).catch((function(a){t.hide(),e.$tip.error("".concat(e.$t("common.error"),": ").concat(a.err_msg||a.message))}))},privateTemplateManage:function(){var e=this,t=this.$loading.show({target:this.$refs.servantModalLoading});this.$ajax.getJSON("/k8s/api/server_option_select",{ServerId:this.getServerId()}).then((function(a){t.hide(),e.detailModal.title=e.$t("cfg.title.viewProfileTemplate"),e.detailModal.model={detail:a&&a.Data[0].ServerProfile||""},e.detailModal.show=!0})).catch((function(a){t.hide(),e.$tip.error("".concat(e.$t("common.error"),": ").concat(a.err_msg||a.message))}))},manageServant:function(e){var t=this;this.stopServerList(),this.servantModal.show=!0,this.$ajax.getJSON("/k8s/api/server_adapter_select",{ServerId:this.getServerId()}).then((function(a){t.servantModal.model=a.Data,t.servantModal.currentServer=e})).catch((function(e){t.$tip.error("".concat(t.$t("serverList.restart.failed"),": ").concat(e.err_msg||e.message))}))},manageK8S:function(){this.$refs.k8s.show(this.getServerId())},closeServantModal:function(){this.servantModal.show=!1,this.servantModal.model=null,this.servantModal.currentServer=null,this.startServerList()},addAdapter:function(e){this.servantAddModal.model.ServerServant.push(Object.assign({},e,{Port:this.getPort(e.Port)}))},getPort:function(e){var t=this.defaultObj,a=this.servantModal,r=0;if(e)r=e;else if(r=Math.floor(t.Port),a.model&&a.model.length>0){var o=a.model.sort((function(e,t){return t.Port-e.Port}))||[];r=Math.floor(o[0].Port)}return r++,19385===r&&r++,r},configServant:function(e){var t=this.defaultObj,a={ServerId:this.getServerId(),ServerServant:[{Name:"",Port:this.getPort()||0,Threads:t.Threads||0,Connections:t.Connections||0,Capacity:t.Capacity||0,Timeout:t.Timeout||0,IsTcp:t.IsTcp,IsTars:t.IsTars}]};if(e){this.servantDetailModal.model=a,this.servantDetailModal.isNew=!0;var r=this.servantModal.model.find((function(t){return t.AdapterId===e}));this.servantDetailModal.model={AdapterId:r.AdapterId,ServerServant:[r]},this.servantDetailModal.isNew=!1,this.servantDetailModal.show=!0}else this.servantAddModal.model=a,this.servantAddModal.isNew=!0,this.servantAddModal.show=!0},closeServantAddModal:function(){this.$refs.servantAddForm&&this.$refs.servantAddForm.resetValid(),this.servantAddModal.show=!1,this.servantAddModal.model=null},closeServantDetailModal:function(){this.$refs.servantDetailForm&&this.$refs.servantDetailForm.resetValid(),this.servantDetailModal.show=!1,this.servantDetailModal.model=null},checkServantEndpoint:function(e){var t=e.split(/\s-/),a=/^tcp|udp$/i,r=/^h\s(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/i,o=/^t\s([1-9]|[1-9]\d+)$/i,i=/^p\s\d{4,5}$/i,s=!0;if(a.test(t[0])){for(var l=0,n=1;n<t.length;n++)if(r&&r.test(t[n])&&(l++,this.servantDetailModal.model.node_name=t[n].split(/\s/)[1],r=null),o&&o.test(t[n])&&(l++,o=null),i&&i.test(t[n])){var c=t[n].substring(2);c<0||c>65535||l++,i=null}s=3===l}else s=!1;return s},saveServantAdd:function(){var e=this;if(this.$refs.servantAddForm.validate()){var t=this.$Loading.show();if(this.servantAddModal.isNew){var a=Object.assign({},this.servantAddModal.model);if(a.ServerServant){var r={};a.ServerServant.forEach((function(e){r[e.Name]=e})),a.ServerServant=r}this.$ajax.postJSON("/k8s/api/server_adapter_create",a).then((function(a){t.hide(),e.manageServant(),e.$tip.success(e.$t("common.success")),e.closeServantAddModal()})).catch((function(a){t.hide(),e.$tip.error("".concat(e.$t("common.error"),": ").concat(a.err_msg||a.message))}))}else t.hide()}},saveServantDetail:function(){var e=this;if(this.$refs.servantDetailForm.validate()){var t=this.$Loading.show();if(this.servantDetailModal.isNew){var a=this.servantDetailModal.model;this.$ajax.postJSON("/k8s/api/server_adapter_create",a).then((function(a){t.hide(),e.servantModal.model.unshift(a),e.$tip.success(e.$t("common.success")),e.closeServantDetailModal()})).catch((function(a){t.hide(),e.$tip.error("".concat(e.$t("common.error"),": ").concat(a.err_msg||a.message))}))}else{this.servantDetailModal.model.servant=this.servantDetailModal.model.application+"."+this.servantDetailModal.model.server_name+"."+this.servantDetailModal.model.obj_name;var r=Object.assign({},this.servantDetailModal.model);this.$ajax.postJSON("/k8s/api/server_adapter_update",r).then((function(a){t.hide(),e.$tip.success(e.$t("common.success")),e.closeServantDetailModal()})).catch((function(a){t.hide(),e.$tip.error("".concat(e.$t("common.error"),": ").concat(a.err_msg||a.message))}))}}},deleteServant:function(e){var t=this;this.$confirm(this.$t("serverList.servant.a"),this.$t("common.alert")).then((function(){var a=t.$Loading.show();t.$ajax.getJSON("/k8s/api/server_adapter_delete",{AdapterId:e}).then((function(r){a.hide(),t.servantModal.model=t.servantModal.model.filter((function(t){return t.AdapterId!==e})),t.$tip.success(t.$t("common.success"))})).catch((function(e){a.hide(),t.$tip.error("".concat(t.$t("common.error"),": ").concat(e.err_msg||e.message))}))}))},closeDetailModal:function(){this.detailModal.show=!1,this.detailModal.model=null},showMoreCmd:function(e){var t=this;this.stopServerList();var a=this.checkedList.filter((function(e){return e.isChecked}));if(a.length<=0)this.$tip.warning(this.$t("pub.dlg.a"));else{var r=a.map((function(e){return e.PodIp})),o=a[0].ServerApp,i=a[0].ServerName;this.moreCmdModal.model={podIp:r,serverApp:o,serverName:i,selected:"setloglevel",setloglevel:"NONE",loadconfig:"",command:"",configs:null},this.moreCmdModal.unwatch=this.$watch("moreCmdModal.model.selected",(function(){t.$refs.moreCmdForm&&t.$refs.moreCmdForm.resetValid()})),this.moreCmdModal.show=!0,this.moreCmdModal.currentServer=e}},sendCommand:function(e,t,a,r,o){var i=this,s=this.$Loading.show();this.$ajax.getJSON("/k8s/api/send_command",{serverApp:e,serverName:t,podIp:a,command:r}).then((function(e){s.hide();var t=e[0].err_msg.replace(/\n/g,"<br>");if(0!==e[0].ret_code)throw new Error(t);var a={title:i.$t("common.success"),message:t};o&&(a.duration=0),i.$tip.success(a),i.getServerNotifyList()})).catch((function(e){s.hide(),i.$tip.error({title:i.$t("common.error"),message:e.err_msg||e.message})}))},invokeMoreCmd:function(){var e=this.moreCmdModal.model;this.moreCmdModal.currentServer;"setloglevel"===e.selected?this.sendCommand(e.serverApp,e.serverName,e.podIp,"tars.setloglevel ".concat(e.setloglevel)):"loadconfig"===e.selected&&this.$refs.moreCmdForm.validate()?this.sendCommand(e.serverApp,e.serverName,e.podIp,"tars.loadconfig ".concat(e.loadconfig)):"command"===e.selected&&this.$refs.moreCmdForm.validate()?this.sendCommand(e.serverApp,e.serverName,e.podIp,e.command):"connection"===e.selected&&this.sendCommand(e.serverApp,e.serverName,e.podIp,"tars.connection",!0)},closeMoreCmdModal:function(){this.$refs.moreCmdForm&&this.$refs.moreCmdForm.resetValid(),this.moreCmdModal.unwatch&&this.moreCmdModal.unwatch(),this.checkedList=[],this.moreCmdModal.show=!1,this.moreCmdModal.model=null,this.startServerList()},checkChange:function(e){this.stopServerList();var t=this.checkedList,a=e.isChecked;if(a){var r=!1;t.forEach((function(t){t.PodId===e.PodId&&(r=!0)})),r||t.push(e)}else{var o=!1,i=-1;t.forEach((function(t,a){t.PodId===e.PodId&&(o=!0,i=a)})),o&&t.splice(i,1)}},checkLauncherType:function(){var e=this;return Object(j["a"])(regeneratorRuntime.mark((function t(){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$ajax.getJSON("/k8s/api/server_k8s_select",{ServerId:e.getServerId()});case 2:return a=t.sent,r=a.Data[0].launcherType,t.abrupt("return","foreground"==r);case 5:case"end":return t.stop()}}),t)})))()}},created:function(){var e=this;return Object(j["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.serverData=e.$parent.getServerData(),e.serverData.server_type){t.next=12;break}return t.prev=2,t.next=5,e.$ajax.getJSON("/k8s/api/server_option_select",{ServerId:e.treeid});case 5:a=t.sent,e.$set(e.serverData,"server_type",a.Data[0].serverType),t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](2),e.$set(e.serverData,"server_type","normal");case 12:case"end":return t.stop()}}),t,null,[[2,9]])})))()},mounted:function(){this.getServerList(),this.reloadServerList(),this.startServerList(),this.getServerNotifyList()},beforeMount:function(){this.startServerList()},beforeDestroy:function(){this.stopServerList()},watch:{isCheckedAll:function(){var e=this.isCheckedAll;this.serverList.forEach((function(t){t.isChecked=e})),this.checkedList=e?[].concat(this.serverList):[]},checkedList:function(){var e=this.checkedList;e.length>0?this.stopServerList():this.startServerList()}}},Re=Ve,Ee=(a("cb44"),Object(w["a"])(Re,O,q,!1,null,null,null)),Be=Ee.exports,He=a("67ac"),Fe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page_server_publish"},[e.buildList.length>0?a("div",[a("div",{staticClass:"table_head",staticStyle:{height:"50px"}},[a("h4",[e._v(e._s(this.$t("serverList.title.buildList"))+" "),a("i",{staticClass:"icon iconfont el-icon-third-shuaxin",staticStyle:{"font-family":"iconfont  !important",cursor:"pointer"},on:{click:function(t){return e.getBuildList()}}})])]),a("div",[a("let-table",{ref:"table",attrs:{data:e.buildList,"empty-msg":e.$t("common.nodata")}},[a("let-table-column",{attrs:{title:e.$t("deployService.form.buildId"),prop:"Id"}}),a("let-table-column",{attrs:{title:e.$t("deployService.form.image"),prop:"Image"}}),a("let-table-column",{attrs:{title:e.$t("deployService.form.phase"),prop:"Phase"}}),a("let-table-column",{attrs:{title:e.$t("deployService.form.message"),prop:"Message"}}),a("let-table-column",{attrs:{title:e.$t("deployService.form.createTime"),prop:"CreateTime"}}),a("let-table-column",{attrs:{title:e.$t("operate.operates"),width:"60px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-table-operation",{staticClass:"danger",on:{click:function(a){return e.deleteBuild(t.row)}}},[e._v(e._s(e.$t("operate.delete")))])]}}],null,!1,1926069341)})],1)],1)]):e._e(),a("div",{staticClass:"table_head",staticStyle:{height:"50px"}},[a("h4",[e._v(e._s(this.$t("serverList.title.patchList"))+" "),a("i",{staticClass:"icon iconfont el-icon-third-shuaxin",staticStyle:{"font-family":"iconfont  !important",cursor:"pointer"},on:{click:function(t){return e.getImageList()}}})])]),a("div",[a("let-table",{ref:"table",attrs:{data:e.serverList,"empty-msg":e.$t("common.nodata")}},[a("let-table-column",{attrs:{title:e.$t("deployService.form.id"),prop:"Id"}}),a("let-table-column",{attrs:{title:e.$t("deployService.form.image"),prop:"Image"}}),a("let-table-column",{attrs:{title:e.$t("deployService.form.secret"),prop:"Secret"}}),a("let-table-column",{attrs:{title:e.$t("deployService.form.currStatus")},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{class:e.getState(t.row.Enabled)})]}}])}),a("let-table-column",{attrs:{title:e.$t("deployService.form.mark"),prop:"Mark"}}),a("let-table-column",{attrs:{title:e.$t("deployService.form.createPerson"),prop:"CreatePerson"}}),a("let-table-column",{attrs:{title:e.$t("deployService.form.createTime"),prop:"CreateTime"}}),a("let-table-column",{attrs:{title:e.$t("operate.operates"),width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-table-operation",{on:{click:function(a){return e.removeReleaseItem(t.row)}}},[e._v(e._s(e.$t("operate.delete")))])]}}])})],1),a("div",{staticStyle:{overflow:"hidden"},attrs:{slot:"operations"},slot:"operations"},[a("let-button",{staticStyle:{float:"left","margin-right":"20px"},attrs:{theme:"primary",size:"small"},on:{click:e.showUploadModal}},[e._v(e._s(e.$t("pub.dlg.upload")))]),a("let-button",{staticStyle:{float:"left"},attrs:{theme:"primary",size:"small"},on:{click:e.showAddImageModal}},[e._v(e._s(e.$t("pub.dlg.image")))]),a("let-button",{staticStyle:{float:"right"},attrs:{theme:"primary",size:"small"},on:{click:e.openPublishVersionModal}},[e._v(e._s(e.$t("pub.btn.pubk8s")))])],1),a("let-modal",{attrs:{title:e.$t("index.rightView.tab.patch"),width:"880px",footShow:!1},on:{close:e.closePublishModal,"on-confirm":e.savePublishServer},model:{value:e.publishModal.show,callback:function(t){e.$set(e.publishModal,"show",t)},expression:"publishModal.show"}},[e.publishModal.model?a("let-form",{ref:"publishForm",attrs:{itemWidth:"100%"}},[[a("let-form-item",{attrs:{label:e.$t("pub.dlg.releaseVersion"),required:""}},[a("let-select",{attrs:{size:"small",required:"","required-tip":e.$t("pub.dlg.ab")},model:{value:e.publishModal.model.Id,callback:function(t){e.$set(e.publishModal.model,"Id",t)},expression:"publishModal.model.Id"}},e._l(e.publishModal.model.patchList,(function(t){return a("let-option",{key:t.Id,attrs:{value:t.Id}},[""+t.Enabled=="true"?a("span",{domProps:{innerHTML:e._s(e.imgCur)}}):a("span",{domProps:{innerHTML:e._s(e.imgSpace)}}),a("span",[e._v(e._s(t.Id)+" | "+e._s(t.CreateTime)+" | "+e._s(t.Image))])])})),1)],1),a("let-form-item",{attrs:{label:e.$t("pub.dlg.nodeImage"),required:""}},[a("let-select",{attrs:{size:"small",required:"","required-tip":e.$t("pub.dlg.nodeImageTip")},model:{value:e.publishModal.model.NodeImage,callback:function(t){e.$set(e.publishModal.model,"NodeImage",t)},expression:"publishModal.model.NodeImage"}},e._l(e.publishModal.model.nodeList,(function(t){return a("let-option",{key:t.Image,attrs:{value:t.Image}},[t.isDefaultTafNode?a("span",{domProps:{innerHTML:e._s(e.imgNew)}}):a("span",{domProps:{innerHTML:e._s(e.imgSpace)}}),t.isCurrTafNode?a("span",{domProps:{innerHTML:e._s(e.imgCur)}}):a("span",{domProps:{innerHTML:e._s(e.imgSpace)}}),a("span",[e._v(e._s(t.Id)+" | "+e._s(t.CreateTime)+" | "+e._s(t.Image))])])})),1)],1),a("let-form-item",{attrs:{label:e.$t("deployService.table.th.replicas")}},[a("let-input",{attrs:{size:"small",type:"number",min:1,placeholder:e.$t("deployService.form.placeholder"),required:"","required-tip":e.$t("deployService.table.tips.empty"),"pattern-tip":e.$t("deployService.form.placeholder")},model:{value:e.publishModal.model.Replicas,callback:function(t){e.$set(e.publishModal.model,"Replicas",t)},expression:"publishModal.model.Replicas"}})],1),a("let-form-item",{attrs:{label:e.$t("serverList.servant.comment")}},[a("let-input",{model:{value:e.publishModal.model.EnableMark,callback:function(t){e.$set(e.publishModal.model,"EnableMark",t)},expression:"publishModal.model.EnableMark"}}),a("let-button",{staticClass:"mt20",attrs:{theme:"primary",size:"small"},on:{click:e.savePublishServer}},[e._v(e._s(e.$t("common.patch")))])],1)]],2):e._e()],1),a("let-modal",{attrs:{title:e.$t("pub.dlg.upload"),width:"880px",footShow:!1},on:{"on-cancel":e.closeUploadModal},model:{value:e.uploadModal.show,callback:function(t){e.$set(e.uploadModal,"show",t)},expression:"uploadModal.show"}},[e.uploadModal.model?a("let-form",{ref:"uploadForm",attrs:{itemWidth:"100%"},nativeOn:{submit:function(t){return t.preventDefault(),e.uploadPatchPackage(t)}}},[a("let-form-item",{attrs:{label:e.$t("pub.dlg.releasePkg"),itemWidth:"400px"}},[a("let-uploader",{attrs:{placeholder:e.$t("pub.dlg.defaultValue")},on:{upload:e.uploadFile}},[e._v(e._s(e.$t("common.submit"))+" ")]),e.uploadModal.model.file?a("span",[e._v(e._s(e.uploadModal.model.file.name))]):e._e()],1),a("let-form-item",{attrs:{label:e.$t("deployService.form.serviceType"),required:""}},[a("let-select",{attrs:{size:"small",required:"","required-tip":e.$t("deployService.form.serviceTypeTips")},on:{change:e.changeServerType},model:{value:e.uploadModal.model.ServerType,callback:function(t){e.$set(e.uploadModal.model,"ServerType",t)},expression:"uploadModal.model.ServerType"}},e._l(e.serverType,(function(t){return a("let-option",{key:t,attrs:{value:t}},[e._v(e._s(t))])})),1)],1),a("let-form-item",{attrs:{label:e.$t("deployService.form.baseImage"),required:""}},[a("let-select",{attrs:{size:"small",required:"","required-tip":e.$t("deployService.form.baseImageTips")},on:{change:e.changeBaseImage},model:{value:e.uploadModal.model.BaseImage,callback:function(t){e.$set(e.uploadModal.model,"BaseImage",t)},expression:"uploadModal.model.BaseImage"}},e._l(e.baseImage,(function(t){return a("let-option",{key:t.Name,attrs:{value:t.Name}},[e._v(e._s(t.Name+"("+t.Mark+")"))])})),1)],1),a("let-form-item",{attrs:{label:e.$t("deployService.form.baseImageRelease"),required:""}},[a("let-select",{attrs:{size:"small",required:"","required-tip":e.$t("deployService.form.baseImageReleaseTips")},model:{value:e.uploadModal.model.BaseImageRelease,callback:function(t){e.$set(e.uploadModal.model,"BaseImageRelease",t)},expression:"uploadModal.model.BaseImageRelease"}},e._l(e.baseImageRelease,(function(t){return a("let-option",{key:t.Image,attrs:{value:t.Image}},[e._v(e._s(t.Image+"("+(t.Mark||t.Id)+")"))])})),1)],1),a("let-form-item",{attrs:{label:e.$t("deployService.form.serverTag")}},[a("let-input",{attrs:{type:"text",size:"small",placeholder:e.$t("deployService.form.serverTagTip")},model:{value:e.uploadModal.model.ServerTag,callback:function(t){e.$set(e.uploadModal.model,"ServerTag","string"===typeof t?t.trim():t)},expression:"uploadModal.model.ServerTag"}})],1),a("let-form-item",{attrs:{label:e.$t("serverList.servant.comment")}},[a("let-input",{attrs:{type:"textarea",rows:3},model:{value:e.uploadModal.model.comment,callback:function(t){e.$set(e.uploadModal.model,"comment",t)},expression:"uploadModal.model.comment"}})],1),a("let-button",{attrs:{type:"submit",theme:"primary"}},[e._v(e._s(e.$t("serverList.servant.upload")))])],1):e._e()],1),a("let-modal",{attrs:{title:e.$t("pub.dlg.image"),width:"600px",footShow:!1},on:{"on-cancel":e.closeAddImageModal},model:{value:e.addImageModal.show,callback:function(t){e.$set(e.addImageModal,"show",t)},expression:"addImageModal.show"}},[e.addImageModal.model?a("let-form",{ref:"addImageForm",attrs:{itemWidth:"100%"},nativeOn:{submit:function(t){return t.preventDefault(),e.addImage(t)}}},[a("let-form-item",{attrs:{label:e.$t("pub.dlg.imageAddress"),required:""}},[a("let-input",{attrs:{type:"text",size:"small",required:""},model:{value:e.addImageModal.model.Image,callback:function(t){e.$set(e.addImageModal.model,"Image",t)},expression:"addImageModal.model.Image"}})],1),a("let-form-item",{attrs:{label:e.$t("pub.dlg.secret"),required:""}},[a("let-input",{attrs:{type:"text",size:"small"},model:{value:e.addImageModal.model.Secret,callback:function(t){e.$set(e.addImageModal.model,"Secret",t)},expression:"addImageModal.model.Secret"}})],1),a("let-form-item",{attrs:{label:e.$t("pub.dlg.mark")}},[a("let-input",{attrs:{type:"text",size:"small"},model:{value:e.addImageModal.model.Mark,callback:function(t){e.$set(e.addImageModal.model,"Mark",t)},expression:"addImageModal.model.Mark"}})],1),a("let-button",{attrs:{type:"submit",theme:"primary"}},[e._v(e._s(e.$t("pub.dlg.add")))])],1):e._e()],1)],1)])},Je=[],Ye=a("2699"),Ue={name:"ServerPublish",data:function(){return{imgNew:'<img class="logo" src="/static/img/new.gif">',imgCur:'<img class="logo" src="/static/img/current.gif">',imgSpace:'<img class="logo" src="/static/img/space.png">',buildList:[],serverList:[],publishModal:{show:!1,model:{patchList:[],nodeList:[]}},reloadTask:null,serverK8S:{},serverType:[],baseImage:[],baseImageRelease:[],uploadModal:{show:!1,model:null},addImageModal:{show:!1,model:null}}},props:["treeid"],methods:{getServerId:function(){return this.treeid},getServerType:function(){return this.$ajax.getJSON("/k8s/api/server_list",{ServerId:this.getServerId()})},getDefault:function(){var e=this;this.$ajax.getJSON("/k8s/api/default").then((function(t){e.serverK8S=t.ServerK8S||{},e.serverType=t.ServerTypeOptional||[]}))},changeServerType:function(){var e=this;this.$ajax.getJSON("/k8s/api/base_image_list",{ServerType:this.uploadModal.model.ServerType}).then((function(t){e.baseImage=t.Data||[],e.uploadModal.model.BaseImage=e.baseImage[0].Name}))},changeBaseImage:function(){var e=this;this.baseImageRelease=this.baseImage.filter((function(t){return t.Name==e.uploadModal.model.BaseImage}))[0].Release,this.$set(this.uploadModal.model,"BaseImageRelease",this.baseImageRelease[this.baseImageRelease.length-1].Image)},getState:function(e){var t="";switch("".concat(e)){case"true":t="status-active";break}return t},formatDate:function(e,t){return Object(Ye["b"])(e,"YYYY-MM-DD HH:mm:ss")},reloadBuildList:function(){var e=this,t=this.$parent.BTabs[0].path,a=t.substring(t.lastIndexOf("/")+1);"publish"!==a&&e.reloadTask||(e.reloadTask=setTimeout((function(){e.$parent.treeid==e.getServerId()&&e.getBuildList(),e.reloadBuildList()}),3e3))},getBuildList:function(){var e=this;this.$ajax.getJSON("/k8s/api/build_list",{ServerId:this.getServerId()}).then((function(t){t.Data.forEach((function(t){t.CreateTime=e.formatDate(t.CreateTime)})),e.buildList=t.Data})).catch((function(t){e.$tip.error("".concat(e.$t("common.error"),": ").concat(t.message||t.err_msg))}))},deleteBuild:function(e){var t=this;this.$confirm(this.$t("deployService.form.delete"),this.$t("common.alert")).then((function(){t.$ajax.getJSON("/k8s/api/delete_build",{ImageName:e.ImageName}).then((function(){t.getBuildList(),t.getImageList()})).catch((function(e){t.$tip.error("".concat(t.$t("common.error"),": ").concat(e.message||e.err_msg))}))}))},getImageList:function(){var e=this;this.$ajax.getJSON("/k8s/api/patch_list",{ServerId:this.getServerId()}).then((function(t){e.getNowImages().then((function(a){var r=t.Data||[];r.forEach((function(t){t.Id==a.Id&&(t.Enabled=!0),t.CreateTime=e.formatDate(t.CreateTime)})),e.serverList=r})).catch((function(t){e.$confirm(t.err_msg||t.message||e.$t("serverList.table.msg.fail")).then((function(){e.getImageList()}))}))})).catch((function(t){e.$confirm(t.err_msg||t.message||e.$t("serverList.table.msg.fail")).then((function(){e.getImageList()}))}))},openPublishVersionModal:function(){var e=this;return Object(j["a"])(regeneratorRuntime.mark((function t(){var a,r,o,i,s,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e.getServerId(),e.publishModal.model={ServerId:a,Replicas:e.serverK8S.Replicas||1,show:!0},t.next=4,e.getPatchList(a);case 4:return r=t.sent,t.next=7,e.getK8SData();case 7:return o=t.sent,t.next=10,e.getNowImages();case 10:return i=t.sent,t.next=13,e.getTafNodes();case 13:return s=t.sent,t.next=16,e.getNodeImage();case 16:l=t.sent,e.publishModal.model.Replicas=o.Data[0].Replicas||e.serverK8S.Replicas||1,r.Data.forEach((function(t){t.CreateTime=e.formatDate(t.CreateTime),t.Image==i.Image&&(t.Enabled=!0)})),s.Data.forEach((function(e){e.Image==i.NodeImage&&(e.isCurrTafNode=!0),e.Image==l&&(e.isDefaultTafNode=!0)})),e.publishModal.model.patchList=r.Data,e.publishModal.model.nodeList=s.Data,e.publishModal.show=!0;case 23:case"end":return t.stop()}}),t)})))()},getPatchList:function(e){var t=this;return Object(j["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.$ajax.getJSON("/k8s/api/patch_list",{ServerId:e});case 2:return a.abrupt("return",a.sent);case 3:case"end":return a.stop()}}),a)})))()},getNowImages:function(){var e=this;return Object(j["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$ajax.getJSON("/k8s/api/get_now_image",{ServerId:e.getServerId()});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})))()},getK8SData:function(){var e=this;return Object(j["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$ajax.getJSON("/k8s/api/server_k8s_select",{ServerId:e.getServerId()});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})))()},getTafNodes:function(){var e=this;return Object(j["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$ajax.getJSON("/k8s/api/image_node_select");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})))()},getNodeImage:function(){var e=this;return Object(j["a"])(regeneratorRuntime.mark((function t(){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$ajax.getJSON("/k8s/api/get_tfc");case 2:return a=t.sent,r=a.filter((function(e){return"nodeImage.image"===e.column})),t.abrupt("return",1==r.length?r[0].value:"");case 5:case"end":return t.stop()}}),t)})))()},closePublishModal:function(){this.publishModal.show=!1,this.publishModal.modal=null,this.$refs.publishForm.resetValid()},savePublishServer:function(){var e=this,t=this.$Loading.show();this.$refs.publishForm.validate()&&(t.hide(),this.$ajax.postJSON("/k8s/api/patch_publish",{ServerId:this.publishModal.model.ServerId,Id:this.publishModal.model.Id,Replicas:this.publishModal.model.Replicas,EnableMark:this.publishModal.model.EnableMark,NodeImage:this.publishModal.model.NodeImage}).then((function(a){t.hide(),e.getImageList(),e.closePublishModal(),e.$tip.success(e.$t("common.success"))})).catch((function(a){t.hide(),e.$tip.error("".concat(e.$t("common.error"),": ").concat(a.message||a.err_msg))})))},updateServerInfo:function(e){this.$ajax.postJSON("/k8s/api/server_update",{ServerId:e.ServerId,ServerType:e.ServerType,ServerMark:e.ServerMark})},showUploadModal:function(){var e=this;this.getServerType().then((function(t){var a=e.getServerId();e.uploadModal.model={ServerId:a,file:null,ServerMark:"",ServerType:t.Data[0].ServerType},e.uploadModal.show=!0}))},showAddImageModal:function(){var e=this.getServerId();this.addImageModal.model={ServerId:e,Id:"",Image:"",Secret:"tars-image-secret",Mark:""},this.addImageModal.show=!0},closeAddImageModal:function(){this.addImageModal.show=!1,this.addImageModal.model=null,this.$refs.addImageForm.resetValid()},closeUploadModal:function(){this.uploadModal.show=!1,this.uploadModal.model=null,this.$refs.uploadForm.resetValid()},removeReleaseItem:function(e){var t=this;this.$confirm(this.$t("imageService.delete.confirmTips"),this.$t("common.alert")).then((function(){t.getServerId();var a=t.$Loading.show();t.$ajax.postJSON("/k8s/api/image_release_delete",{Name:e.Name,Id:e.Id}).then((function(){a.hide(),t.getImageList()})).catch((function(e){a.hide(),t.$tip.error("".concat(t.$t("common.error"),": ").concat(e.message||e.err_msg))}))})).catch((function(){}))},uploadFile:function(e){this.uploadModal.model.file=e},uploadPatchPackage:function(){var e=this,t=this.getServerId();if(this.$refs.uploadForm.validate()){var a=this.$Loading.show(),r=new FormData,o="",i=this.baseImageRelease.filter((function(t){return t.Image==e.uploadModal.model.BaseImageRelease}));1==i.length&&(o=i[0].Secret||""),r.append("ServerId",t),r.append("ServerType",this.uploadModal.model.ServerType),r.append("ServerTag",this.uploadModal.model.ServerTag),r.append("BaseImage",this.uploadModal.model.BaseImageRelease),r.append("Secret",o),r.append("suse",this.uploadModal.model.file),r.append("CreateMark",this.uploadModal.model.comment||""),this.$ajax.postForm("/k8s/api/patch_upload",r).then((function(t){e.closeUploadModal(),a.hide(),setTimeout(e.getImageList,1e3)})).catch((function(t){a.hide(),e.$tip.error("".concat(e.$t("common.error"),": ").concat(t.message||t.err_msg))}))}},addImage:function(){var e=this,t=this.getServerId();if(this.$refs.addImageForm.validate()){var a=this.$Loading.show(),r=new FormData;r.append("Name",t),r.append("Image",this.addImageModal.model.Image),r.append("Secret",this.addImageModal.model.Secret||""),r.append("Mark",this.addImageModal.model.Mark||""),this.$ajax.postForm("/k8s/api/image_release_create",r).then((function(t){e.closeAddImageModal(),a.hide(),setTimeout(e.getImageList,1e3)})).catch((function(t){a.hide(),e.$tip.error("".concat(e.$t("common.error"),": ").concat(t.message||t.err_msg))}))}},handleNoPublishedTime:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.$t("pub.dlg.unpublished");return"0000:00:00 00:00:00"===e?t:e}},mounted:function(){this.getImageList(),this.getDefault(),this.reloadBuildList()}},Ke=Ue,We=(a("9df2"),Object(w["a"])(Ke,Fe,Je,!1,null,null,null)),Ze=We.exports,Ge=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page_server_config"},[e.configList?a("wrapper",{ref:"configListLoading"},[a("div",{staticClass:"btn_group"},[a("let-button",{attrs:{size:"small",theme:"sub-primary"},on:{click:e.addConfig}},[e._v(e._s(e.$t("cfg.btn.add")))]),a("let-button",{attrs:{size:"small",theme:"primary"},on:{click:function(t){return e.nodeConfigAdd(e.configList,e.checkedConfigId)}}},[e._v(e._s(e.$t("filter.btn.addNode")))]),a("let-button",{attrs:{size:"small",theme:"primary"},on:{click:function(t){return e.changeConfig(e.configList,"ConfigName",e.checkedConfigId,"configList")}}},[e._v(e._s(e.$t("operate.update")))]),a("let-button",{attrs:{size:"small",theme:"primary"},on:{click:function(t){return e.deleteConfig(e.configList,"ConfigName",e.checkedConfigId)}}},[e._v(e._s(e.$t("operate.delete")))]),a("let-button",{attrs:{size:"small",theme:"primary"},on:{click:function(t){return e.showDetail(e.configList,"ConfigName",e.checkedConfigId)}}},[e._v(e._s(e.$t("cfg.title.viewConf")))]),a("let-button",{attrs:{size:"small",theme:"primary"},on:{click:function(t){return e.showHistory(e.configList,"ConfigName",e.checkedConfigId)}}},[e._v(e._s(e.$t("pub.btn.history")))])],1),a("let-table",{attrs:{data:e.configList,title:e.$t("cfg.title.a"),"empty-msg":e.$t("common.nodata")}},[a("let-table-column",{attrs:{width:"40px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-radio",{attrs:{label:t.row.ConfigName},model:{value:e.checkedConfigId,callback:function(t){e.checkedConfigId=t},expression:"checkedConfigId"}},[a("span",{staticStyle:{"font-size":"0"}},[e._v(e._s(t.row.ConfigName))])])]}}],null,!1,367281790)}),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.service"),width:"250px",prop:"ServerId"}}),a("let-table-column",{attrs:{title:e.$t("cfg.btn.fileName"),width:"250px",prop:"ConfigName"}}),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.version"),prop:"ConfigVersion"}}),a("let-table-column",{attrs:{title:e.$t("cfg.btn.lastUpdate"),prop:"CreateTime",width:"250px"}})],1)],1):e._e(),e.nodeConfigList&&e.showOthers?a("wrapper",{ref:"nodeConfigListLoading"},[a("div",{staticClass:"btn_group"},[a("let-button",{attrs:{size:"small",theme:"primary"},on:{click:function(t){return e.changeConfig(e.nodeConfigList,"ConfigId",e.nodeCheckList,"nodeConfigList")}}},[e._v(e._s(e.$t("cfg.table.modCfg")))]),a("let-button",{attrs:{size:"small",theme:"primary"},on:{click:function(t){return e.showMergedDetail(e.nodeConfigList,"ConfigId",e.nodeCheckList)}}},[e._v(e._s(e.$t("cfg.table.viewMerge")))]),a("let-button",{attrs:{size:"small",theme:"primary"},on:{click:function(t){return e.deleteConfig(e.nodeConfigList,"ConfigId",e.nodeCheckList)}}},[e._v(e._s(e.$t("operate.delete")))]),a("let-button",{attrs:{size:"small",theme:"primary"},on:{click:function(t){return e.showDetail(e.nodeConfigList,"ConfigId",e.nodeCheckList)}}},[e._v(e._s(e.$t("cfg.table.viewIpContent")))]),a("let-button",{attrs:{size:"small",theme:"primary"},on:{click:function(t){return e.showHistory(e.nodeConfigList,"ConfigId",e.nodeCheckList)}}},[e._v(e._s(e.$t("pub.btn.history")))])],1),e.nodeConfigList.length?a("let-checkbox",{staticClass:"check-all",model:{value:e.nodeCheckAll,callback:function(t){e.nodeCheckAll=t},expression:"nodeCheckAll"}}):e._e(),a("let-table",{attrs:{data:e.nodeConfigList,title:e.$t("cfg.title.c"),"empty-msg":e.$t("common.nodata")}},[a("let-table-column",{attrs:{width:"40px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-checkbox",{attrs:{label:t.row.ConfigId},model:{value:e.nodeCheckList,callback:function(t){e.nodeCheckList=t},expression:"nodeCheckList"}})]}}],null,!1,1794674851)}),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.service"),width:"250px",prop:"ServerId"}}),a("let-table-column",{attrs:{title:e.$t("cfg.btn.fileName"),width:"250px",prop:"ConfigName"}}),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.ip"),prop:"PodSeq"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.ServerId.replace(/\./g,"-").toLocaleLowerCase())+"-"+e._s(t.row.PodSeq)+" ")]}}],null,!1,3730132245)}),a("let-table-column",{attrs:{title:e.$t("cfg.btn.lastUpdate"),prop:"CreateTime",width:"180px"}})],1)],1):e._e(),a("let-modal",{attrs:{title:e.configModal.isNew?e.$t("operate.title.add")+" "+e.$t("common.config"):e.$t("operate.title.update")+" "+e.$t("common.config"),width:"800px"},on:{"on-confirm":e.configDiff,close:e.closeConfigModal,"on-cancel":e.closeConfigModal},model:{value:e.configModal.show,callback:function(t){e.$set(e.configModal,"show",t)},expression:"configModal.show"}},[e.configModal.model?a("let-form",{ref:"configForm",attrs:{itemWidth:"100%"}},[a("let-form-item",{attrs:{label:e.$t("cfg.btn.fileName"),required:""}},[a("let-input",{attrs:{size:"small",disabled:!e.configModal.isNew,required:""},model:{value:e.configModal.model.ConfigName,callback:function(t){e.$set(e.configModal.model,"ConfigName",t)},expression:"configModal.model.ConfigName"}})],1),e.configModal.isNew?e._e():a("let-form-item",{attrs:{label:e.$t("cfg.btn.reason"),required:""}},[a("let-input",{attrs:{size:"small",required:""},model:{value:e.configModal.model.ConfigMark,callback:function(t){e.$set(e.configModal.model,"ConfigMark",t)},expression:"configModal.model.ConfigMark"}})],1),a("let-form-item",{attrs:{label:e.$t("cfg.btn.content"),required:""}},[a("let-input",{attrs:{size:"large",type:"textarea",rows:16,required:""},model:{value:e.configContent,callback:function(t){e.configContent=t},expression:"configContent"}})],1)],1):e._e()],1),a("let-modal",{attrs:{title:e.nodeConfigModal.isNew?e.$t("operate.title.add")+" "+e.$t("common.config"):e.$t("operate.title.update")+" "+e.$t("common.config"),width:"1000px"},on:{"on-confirm":e.updateNodeConfigFile,close:e.closeNodeConfigModal,"on-cancel":e.closeNodeConfigModal},model:{value:e.nodeConfigModal.show,callback:function(t){e.$set(e.nodeConfigModal,"show",t)},expression:"nodeConfigModal.show"}},[e.nodeConfigModal.model?a("let-form",{ref:"nodeConfigForm",attrs:{itemWidth:"100%"}},[a("let-form-item",{attrs:{label:e.$t("cfg.btn.fileName"),required:""}},[a("let-input",{attrs:{disabled:"",size:"small",required:""},model:{value:e.nodeConfigModal.model.ConfigName,callback:function(t){e.$set(e.nodeConfigModal.model,"ConfigName",t)},expression:"nodeConfigModal.model.ConfigName"}})],1),a("let-form-item",{attrs:{label:e.$t("serverList.table.th.ip"),required:""}},[a("div",{staticStyle:{display:"flex"}},[a("span",{staticStyle:{display:"block"}},[e._v(e._s(e.nodeConfigModal.model.ServerId.replace(/\./g,"-").toLocaleLowerCase())+"-")]),a("let-input",{staticStyle:{display:"block",flex:"1"},attrs:{type:"number",min:0,max:20,size:"small",required:""},model:{value:e.nodeConfigModal.model.PodSeq,callback:function(t){e.$set(e.nodeConfigModal.model,"PodSeq",t)},expression:"nodeConfigModal.model.PodSeq"}})],1)]),a("let-form-item",{attrs:{label:e.$t("cfg.btn.content"),required:""}},[a("let-input",{attrs:{size:"large",type:"textarea",rows:16,required:""},model:{value:e.nodeConfigModal.model.ConfigContent,callback:function(t){e.$set(e.nodeConfigModal.model,"ConfigContent",t)},expression:"nodeConfigModal.model.ConfigContent"}})],1)],1):e._e()],1),a("let-modal",{attrs:{title:e.$t("filter.title.diffTxt"),width:"1200px"},on:{"on-confirm":e.updateConfigDiff,close:e.closeConfigDiffModal,"on-cancel":e.closeConfigDiffModal},model:{value:e.configDiffModal.show,callback:function(t){e.$set(e.configDiffModal,"show",t)},expression:"configDiffModal.show"}},[e.configDiffModal.model?a("div",{staticStyle:{"padding-top":"30px"}},[a("div",{staticClass:"codediff_head"},[a("div",{staticClass:"codediff_th"},[e._v("OLD:")]),a("div",{staticClass:"codediff_th"},[e._v("NEW:")])]),a("diff",{attrs:{"old-string":e.configDiffModal.model.oldData,"new-string":e.configDiffModal.model.newData,context:10,"output-format":"side-by-side"}})],1):e._e()]),a("let-modal",{attrs:{title:e.detailModal.title,width:"1200px",footShow:!1},on:{close:e.closeDetailModal},model:{value:e.detailModal.show,callback:function(t){e.$set(e.detailModal,"show",t)},expression:"detailModal.show"}},[e.detailModal.model&&e.detailModal.model.table?a("let-button",{staticStyle:{"margin-top":"20px"},attrs:{theme:"primary",size:"small"},on:{click:e.backConfig}},[e._v("恢复")]):e._e(),e.detailModal.model&&e.detailModal.model.table?a("let-table",{staticClass:"history-table",attrs:{data:e.detailModal.model.table,"empty-msg":e.$t("common.nodata")}},[a("let-table-column",{attrs:{width:"40px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-radio",{attrs:{label:t.row.ConfigId},model:{value:e.backConfigId,callback:function(t){e.backConfigId=t},expression:"backConfigId"}},[e._v(e._s(""))])]}}],null,!1,316818822)}),a("let-table-column",{attrs:{title:e.$t("common.time"),prop:"CreateTime"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{on:{click:function(a){return e.historyClick(t.row)}}},[e._v(e._s(t.row.CreateTime))])]}}],null,!1,2382811015)}),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.version"),prop:"ConfigVersion"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{on:{click:function(a){return e.historyClick(t.row)}}},[e._v(e._s(t.row.ConfigVersion))])]}}],null,!1,3065663174)}),a("let-table-column",{attrs:{width:"400px",title:e.$t("cfg.btn.reason"),prop:"ConfigMark"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{on:{click:function(a){return e.historyClick(t.row)}}},[e._v(e._s(t.row.ConfigMark||" "))])]}}],null,!1,1879717673)}),a("let-table-column",{attrs:{title:e.$t("cfg.btn.content"),width:"90px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-table-operation",{on:{click:function(a){return e.showTableDeatil(t.row)}}},[e._v(e._s(e.$t("operate.view")))])]}}],null,!1,3538701521)})],1):e._e(),e.detailModal.model&&!e.detailModal.model.table||e.detailModal.model&&e.detailModal.model.table&&e.detailModal.model.detail?a("pre",[e._v(e._s(e.detailModal.model.detail||e.$t("cfg.msg.empty")))]):e._e(),a("div",{ref:"detailModalLoading",staticClass:"detail-loading"})],1)],1)},Qe=[],Xe=(a("8a79"),a("e68e")),et={name:"ServerConfig",components:{wrapper:V["a"],diff:Xe["a"]},data:function(){return{oldStr:"old code",newStr:"new code",serverData:{ServerId:""},checkedConfigId:"",backConfigId:"",configList:[],nodeConfigList:null,nodeCheckList:[],configContent:"",configModal:{show:!1,isNew:!0,model:null},nodeConfigContent:"",nodeConfigModal:{show:!1,isNew:!0,model:null},configDiffModal:{type:"",show:!1,isNew:!0,model:null},detailModal:{show:!1,title:"",model:null},refFileModal:{show:!1,model:{fileList:[]}},nodeRefFileListModal:{show:!1,model:null},pushResultModal:{show:!1,model:null}}},props:["treeid"],computed:{showOthers:function(){return 5===this.serverData.level},nodeCheckAll:{get:function(){return!(!this.nodeConfigList||!this.nodeConfigList.length)&&this.nodeCheckList.length===this.nodeConfigList.length},set:function(e){this.nodeCheckList=e?this.nodeConfigList.map((function(e){return e.ConfigId})):[]}}},watch:{checkedConfigId:function(){var e=this;this.$nextTick((function(){e.getNodeConfigList()}))}},methods:{getServerId:function(){return this.treeid},getConfigList:function(e){var t=this,a=this.$refs.configListLoading.$loading.show(),r=this.getServerId();this.$ajax.getJSON("/k8s/api/server_config_select",{ServerId:r}).then((function(e){a.hide(),t.configList=[],t.refFileList=[],t.nodeConfigList=[],e.hasOwnProperty("Data")&&(e.Data[0]&&e.Data[0].ConfigId&&(t.checkedConfigId=e.Data[0].ConfigName,t.getNodeConfigList()),e.Data.forEach((function(e){e.CreateTime=Object(Ye["b"])(e.CreateTime)})),t.configList=e.Data)})).catch((function(e){a.hide(),t.$confirm(e.err_msg||e.message||t.$t("common.error"),t.$t("common.retry"),t.$t("common.alert")).then((function(){t.getConfigList()}))}))},addConfig:function(){var e=this.getServerId().split(".")[1]||"";this.configContent="",this.configModal.model={ConfigName:e&&"".concat(e,".conf")||"",ConfigContent:""},this.configModal.isNew=!0,this.configModal.show=!0},changeConfig:function(e,t,a,r){var o=e.filter((function(e){return e[t]===a||e[t]===a[0]}));if(!a||0===a.length||0==o.length)return this.$tip.warning(this.$t("dialog.tips.item"));this.configContent=o[0].ConfigContent,this.configModal.model=Object.assign(o[0],{ConfigMark:""}),this.configModal.target=r,this.configModal.isNew=!1,this.configModal.show=!0},updateConfigFile:function(){var e=this;if(this.$refs.configForm.validate()){var t=this.$Loading.show(),a=this.configModal.model;if(this.configModal.isNew){var r=Object.assign({ServerId:this.getServerId()},a);this.$ajax.postJSON("/k8s/api/server_config_create",r).then((function(a){t.hide(),e.$tip.success(e.$t("common.success")),e.getConfigList(),e.closeConfigModal(),e.closeConfigDiffModal()})).catch((function(a){t.hide(),e.$tip.error(e.$t("common.error"))}))}else this.$ajax.postJSON("/k8s/api/server_config_update",{ConfigId:a.ConfigId,ConfigMark:a.ConfigMark,ConfigContent:a.ConfigContent}).then((function(a){t.hide(),e.$tip.success(e.$t("common.success")),e.getConfigList(),e.closeConfigModal(),e.closeConfigDiffModal()})).catch((function(a){t.hide(),e.$tip.error(e.$t("common.error"))}))}},updateNodeConfigFile:function(){var e=this;if(this.$refs.nodeConfigForm.validate()){var t=this.$Loading.show(),a=this.nodeConfigModal.model;if(this.nodeConfigModal.isNew){var r=Object.assign({ServerId:this.getServerId()},a);this.$ajax.postJSON("/k8s/api/server_config_create",r).then((function(a){t.hide(),e.$tip.success(e.$t("common.success")),e.getConfigList(),e.closeNodeConfigModal()})).catch((function(a){t.hide(),e.$tip.error(a.err_msg)}))}}},backConfig:function(){var e=this,t=this.backConfigId;if(!t)return this.$tip.error("请先选择一项");var a=this.$Loading.show();this.$ajax.postJSON("/k8s/api/server_config_history_back",{HistoryId:t}).then((function(t){a.hide(),e.$tip.success(e.$t("common.success")),e.getConfigList(),e.closeDetailModal()})).catch((function(){a.hide(),e.$tip.error(e.$t("common.error"))}))},closeConfigModal:function(){this.$refs.configForm&&this.$refs.configForm.resetValid(),this.configModal.show=!1},closeNodeConfigModal:function(){this.$refs.nodeConfigForm&&this.$refs.nodeConfigForm.resetValid(),this.nodeConfigModal.show=!1},deleteConfig:function(e,t,a){var r=this;if(!a)return this.$tip.warning(this.$t("dialog.tips.item"));var o=e.filter((function(e){return e[t]===a||e[t]===a[0]}));this.$confirm(this.$t("cfg.msg.confirmCfg"),this.$t("common.alert")).then((function(){var e=r.$Loading.show();r.$ajax.getJSON("/k8s/api/server_config_delete",{ConfigId:o[0].ConfigId}).then((function(t){e.hide(),r.getConfigList(r.serverData),r.$tip.success(r.$t("common.success"))})).catch((function(t){e.hide(),r.$tip.error("".concat(r.$t("common.error"),": ").concat(t.err_msg||t.message))}))}))},getNodeConfigList:function(){var e=this;if(this.showOthers){var t={ServerId:this.getServerId(),ConfigName:this.checkedConfigId};this.$ajax.getJSON("/k8s/api/server_config_select",t).then((function(t){t.Data.forEach((function(e){e.CreateTime=Object(Ye["b"])(e.CreateTime)})),e.nodeCheckList=[],e.nodeConfigList=t.Data})).catch((function(t){e.nodeConfigList=[],e.$tip.error({title:e.$t("common.error"),message:t.err_msg||t.message||e.$t("common.networkErr")})}))}},nodeConfigAdd:function(e,t){if(!t)return this.$tip.warning(this.$t("dialog.tips.item"));var a=e.filter((function(e){return e.ConfigName===t}));this.nodeConfigModal.model={ServerId:a[0].ServerId,ConfigName:a[0].ConfigName,ConfigContent:""},this.nodeConfigModal.isNew=!0,this.nodeConfigModal.show=!0},showDetail:function(e,t,a){if(!a||0===a.length)return this.$tip.warning(this.$t("dialog.tips.item"));var r=e.filter((function(e){return e[t]===a||e[t]===a[0]}));this.detailModal.title=this.$t("cfg.title.viewConf"),this.detailModal.model={detail:r[0].ConfigContent},this.detailModal.show=!0},showMergedDetail:function(e,t,a){var r=this;if(!a||0===a.length)return this.$tip.warning(this.$t("dialog.tips.item"));var o=e.filter((function(e){return e[t]===a||e[t]===a[0]}));this.detailModal.title=this.$t("cfg.title.viewMerged"),this.detailModal.show=!0;var i=this.$loading.show({target:this.$refs.detailModalLoading});this.$ajax.getJSON("/k8s/api/merged_node_config",{ServerId:o[0].ServerId,ConfigName:o[0].ConfigName,PodSeq:o[0].PodSeq}).then((function(e){i.hide(),r.detailModal.model={detail:e}})).catch((function(e){i.hide(),r.$tip.error("".concat(r.$t("common.error"),": ").concat(e.err_msg||e.message))}))},showHistory:function(e,t,a){var r=this;if(!a||0===a.length)return this.$tip.warning(this.$t("dialog.tips.item"));var o=e.filter((function(e){return e[t]===a||e[t]===a[0]}));this.detailModal.title=this.$t("cfg.title.viewHistory"),this.detailModal.show=!0;var i=this.$loading.show({target:this.$refs.detailModalLoading});this.$ajax.getJSON("/k8s/api/server_config_history_select",{ConfigId:o[0].ConfigId}).then((function(e){i.hide(),e.Data.forEach((function(e){e.CreateTime=Object(Ye["b"])(e.CreateTime)})),r.detailModal.model={currentVersion:o[0].ConfigVersion,ConfigId:o[0].ConfigId,table:e.Data,detail:""}})).catch((function(e){i.hide(),r.$tip.error("".concat(r.$t("common.error"),": ").concat(e.err_msg||e.message))}))},showTableDeatil:function(e){this.detailModal.model.detail=e.ConfigContent},closeDetailModal:function(){this.backConfigId="",this.detailModal.show=!1,this.detailModal.model=null},configDiff:function(){this.$refs.configForm.validate()&&(this.configDiffModal.type="config",this.configDiffModal.show=!0,this.configDiffModal.isNew=!1,this.configDiffModal.model={oldData:this.configModal.model.ConfigContent,newData:this.configContent})},updateConfigDiff:function(){var e=this.configDiffModal.type,t=this.configModal.model;if(t.ConfigName.toLowerCase().endsWith(".json"))try{JSON.parse(this.configContent)}catch(s){return void alert("config format error:"+s.toString())}if(t.ConfigName.toLowerCase().endsWith(".xml"))try{var a=new DOMParser,r=a.parseFromString(this.configContent,"text/xml"),o=r.getElementsByTagName("parsererror"),i="";if(o.length>0)return i="parsererror"==r.documentElement.nodeName?r.documentElement.childNodes[0].nodeValue:r.getElementsByTagName("parsererror")[0].innerHTML,void alert("config format error:"+i)}catch(s){return void alert("config format error:"+s.toString())}"config"===e&&(this.configModal.model.ConfigContent=this.configContent,this.updateConfigFile())},closeConfigDiffModal:function(){this.configDiffModal.show=!1},nodeConfigDiff:function(){this.$refs.nodeConfigForm.validate()&&(this.configDiffModal.type="nodeConfig",this.configDiffModal.show=!0,this.configDiffModal.isNew=!1,this.configDiffModal.model={oldData:this.nodeConfigModal.model.ConfigContent,newData:this.nodeConfigContent})},historyClick:function(e){this.backConfigId=e.HistoryId}},created:function(){this.serverData=this.$parent.getServerData()},mounted:function(){this.getConfigList(this.serverData)}},tt=et,at=(a("44ae"),Object(w["a"])(tt,Ge,Qe,!1,null,null,null)),rt=at.exports,ot=a("c9e9"),it=a("4527"),st=a("c2de"),lt=a("3430"),nt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page_server_manage"},[a("div",{staticClass:"table_head",staticStyle:{height:"50px"}},[a("h4",[e._v(e._s(this.$t("serverList.title.serverList"))+" "),a("i",{staticClass:"icon iconfont el-icon-third-shuaxin",staticStyle:{"font-family":"iconfont  !important",cursor:"pointer"},on:{click:function(t){return e.getServerList()}}})])]),e.serverList?a("let-table",{attrs:{data:e.serverList,"empty-msg":e.$t("common.nodata")}},[a("let-table-column",{attrs:{title:e.$t("deployService.form.app"),prop:"ServerApp"}}),a("let-table-column",{attrs:{title:e.$t("deployService.form.serviceName"),prop:"ServerName"}}),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.podName"),prop:"PodName"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-table-operation",{on:{click:function(a){return e.gotoLog(t.row)}}},[e._v(e._s(t.row.PodName))])]}}],null,!1,2844911292)}),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.podIP"),prop:"PodIp"}}),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.ip"),prop:"NodeIp"}}),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.version"),prop:"ServiceVersion"}}),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.createTime"),prop:"CreateTime"}}),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.deleteTime"),prop:"DeleteTime"}})],1):e._e()],1)},ct=[],dt={name:"ServerManage",data:function(){return{serverList:[]}},props:["treeid"],methods:{gotoLog:function(e){var t="/logview.html?History=true&NodeIP=".concat(e.NodeIp,"&ServerApp=").concat(e.ServerApp,"&ServerName=").concat(e.ServerName,"&PodName=").concat(e.PodName);window.open(t)},getServerId:function(){return this.treeid},getServerList:function(e){var t=this;this.$ajax.getJSON("/k8s/api/pod_history_list",{ServerId:this.getServerId()}).then((function(e){e.Data.forEach((function(e){e.CreateTime=E()(e.CreateTime).format("YYYY-MM-DD HH:mm:ss"),e.DeleteTime=E()(e.DeleteTime).format("YYYY-MM-DD HH:mm:ss")})),t.serverList=e.Data})).catch((function(e){t.$confirm(e.err_msg||e.message||t.$t("serverList.msg.fail"),t.$t("common.alert")).then((function(){t.getServerList()}))}))},more:function(){this.getServerList(this.continue)}},created:function(){},mounted:function(){this.getServerList()}},ut=dt,pt=(a("29ca"),Object(w["a"])(ut,nt,ct,!1,null,null,null)),mt=pt.exports,ft=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page_server_history"},[e.serverListShow?a("div",{staticClass:"table_wrap"},[a("div",{staticClass:"table_head"},[a("h4",[e._v(e._s(this.$t("serverList.title.serverList")))])]),a("let-table",{attrs:{data:e.serverList,"empty-msg":e.$t("common.nodata")}},[a("let-table-column",{attrs:{title:e.$t("deployService.form.app"),prop:"ServerApp"}}),a("let-table-column",{attrs:{title:e.$t("deployService.form.serviceName"),prop:"ServerName"}}),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.podName"),prop:"PodName"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-table-operation",{on:{click:function(a){return e.gotoLog(t.row)}}},[e._v(e._s(t.row.PodName))])]}}],null,!1,2844911292)}),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.podIP"),prop:"PodIp"}}),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.ip"),prop:"NodeIp"}}),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.version"),prop:"ServiceVersion"}}),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.configStatus")},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{style:e.getState(t.row.SettingState)},[e._v(e._s(t.row.SettingState))])]}}],null,!1,987565344)}),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.currStatus")},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{style:e.getState(t.row.PresentState)},[e._v(e._s(t.row.PresentState))])]}}],null,!1,1754665792)}),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.currMessage"),width:"80px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-tooltip",{staticClass:"tooltip",attrs:{placement:"top",content:t.row.PresentMessage||""}},[a("let-table-operation",[e._v(e._s(t.row.PresentMessage))])],1)]}}],null,!1,524765591)}),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.createTime"),prop:"CreateTime"}}),a("let-table-column",{attrs:{title:e.$t("operate.operates"),width:"100px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-table-operation",{on:{click:function(a){return e.historyLink(t.row.id)}}},[e._v(e._s(e.$t("operate.goto")))])]}}],null,!1,1230847586)})],1),a("let-button",{attrs:{theme:"danger"},on:{click:function(t){return e.getMore()}}},[e._v(e._s(e.$t("operate.more")))])],1):a("div",{staticClass:"history_search"},[a("label",{staticClass:"history_search_box"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.historySearchKey,expression:"historySearchKey"}],staticClass:"history_search_key",attrs:{type:"text",placeholder:"请输入 应用名/服务名/IP地址 搜索"},domProps:{value:e.historySearchKey},on:{blur:e.historySearch,keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.historySearch(t)},input:function(t){t.target.composing||(e.historySearchKey=t.target.value)}}})]),a("div",{staticClass:"history_list_wrap"},[a("div",{staticClass:"history_list_title"},[e._v("最近访问：")]),a("ul",{staticClass:"history_list"},e._l(e.historySearchList,(function(t){return a("li",{key:t,staticClass:"history_item"},[a("a",{staticClass:"history_link",attrs:{href:"javascript:;"},on:{click:function(a){return e.historySearchLink(t)}}},[e._v(e._s(t))])])})),0)])])])},ht=[],vt=(a("fb6a"),{name:"ServerHistory",data:function(){return{historySearchKey:"",historySearchList:[],serverList:[],serverListShow:!1,continue:null}},mounted:function(){this.updateHistorySearchKey()},methods:{gotoLog:function(e){var t="/logview.html?History=false&NodeIP=".concat(e.NodeIp,"&ServerApp=").concat(e.ServerApp,"&ServerName=").concat(e.ServerName,"&PodName=").concat(e.PodName);window.open(t)},getState:function(e){var t=e;switch("".concat(e)){case"Active":t="color: green";break;case"Inactive":case"Activating":case"Deactivating":case"Unknown":t="color: red";break}return t},getMore:function(){this.historySearch(this.continue)},historySearch:function(e){var t=this,a=this.historySearchKey;a&&(this.updateHistorySearchKey(),this.$ajax.getJSON("/k8s/api/server_search",{searchkey:a,continue:e}).then((function(e){t.continue=e.continue,t.serverList=e.rows,t.serverListShow=!0})).catch((function(e){t.$tip.error("".concat(t.$t("common.error"),": ").concat(e.err_msg||e.message))})))},historySearchLink:function(e){this.historySearchKey=e,this.historySearch()},historyLink:function(e){var t=this;this.$nextTick((function(){t.$parent.selectTree(e),t.$parent.getTreeData()}))},updateHistorySearchKey:function(){var e=this.historySearchKey,t=this.getLocalStorage("taf_history_key")||[];if(e){if(t&&t.length>0){var a=-1;t.forEach((function(t,r){t===e&&(a=r)})),-1!==a&&t.splice(a,1),t.unshift(e)}else t=[e];this.historySearchList=t.slice(0,20),this.setLocalStorage("taf_history_key",JSON.stringify(t))}else this.historySearchList=t},getLocalStorage:function(e){var t="";return window.localStorage&&(t=JSON.parse(JSON.parse(localStorage.getItem(e)))),t},setLocalStorage:function(e,t){var a="";return window.localStorage&&(a=localStorage.setItem(e,JSON.stringify(t))),a}}}),gt=vt,bt=(a("98b3"),Object(w["a"])(gt,ft,ht,!1,null,null,null)),$t=bt.exports,kt={name:"Server",components:{callChain:He["a"],manage:Be,publish:Ze,config:rt,"server-monitor":ot["a"],"property-monitor":it["a"],"interface-debuger":st["a"],"user-manage":lt["a"],history:mt,serverHistory:$t},data:function(){return{treeErrMsg:"load failed",treeData:null,treeSearchKey:"",treeid:"",isIconPlay:!1,serverData:{level:5,application:"",server_name:""},BTabs:[],defaultProps:{children:"children",label:"name"},openDelay:1e3,loading:!1,homeTab:"home"}},computed:{base:function(){return"/k8s/".concat(this.treeid)}},filters:{serverTypeFilter:function(e){return"tars"==e?"el-icon-tickets":"el-icon-document-copy"}},watch:{treeid:function(e){this.serverData=this.getServerData()},$route:function(e,t){"/server"===e.path&&this.getTreeData()}},directives:{vscroll:{componentUpdated:function(e){var t=e||"",a=e.children||[],r="";if(a.forEach((function(e){var t=e.getAttribute("class");t.indexOf("active")>-1&&(r=e)})),r.offsetLeft<t.scrollLeft){var o=r.offsetLeft;t.scrollTo(o,0)}else if(r.offsetLeft+r.offsetWidth>t.scrollLeft+t.offsetWidth){var i=r.offsetLeft+r.offsetWidth-t.offsetWidth;t.scrollTo(i,0)}}}},methods:{getName:function(e){var t="";return e.lastIndexOf("/")>-1&&(t=e.substring(e.lastIndexOf("/")+1,e.length)),t},iconLoading:function(){var e=this;e.isIconPlay||(e.isIconPlay=!0,setTimeout((function(){e.isIconPlay=!1}),1e3))},handleNodeClick:function(e){e.id&&0!=e.type&&(this.selectBTabs(e.id),this.checkCurrBTabs())},filterTextChange:function(){this.$refs.trees.filter(this.treeSearchKey)},filterNode:function(e,t){return!e||-1!==t.name.toLowerCase().indexOf(e.toLowerCase())},treeSearch:function(e){this.iconLoading(),this.getTreeData(this.treeSearchKey,e)},handleData:function(e,t){var a=this;e&&e.length&&e.forEach((function(e){e.label=e.name,e.nodeKey="0"!==e.type?e.id:"",a.treeSearchKey&&(e.expand=!0),e.children&&e.children.length&&a.handleData(e.children)}))},getTreeData:function(e,t){var a=this;this.treeData=null,this.$nextTick((function(){a.loading=!0,a.$ajax.getJSON("/k8s/api/tree",{searchKey:e||"",type:t}).then((function(e){a.loading=!1,a.treeData=e,a.handleData(a.treeData,!0)})).catch((function(e){a.loading=!1,a.treeErrMsg=e.err_msg||e.message||"load failed",a.treeData=!1}))}))},getServerData:function(){this.treeid||(this.treeid=this.getLocalStorage("k8s_treeid"));var e="";if(this.$refs.trees){var t=this.$refs.trees.getNode(this.treeid);t&&(e=t.data.serverType||"")}var a=this.treeid.split("."),r={level:1==a.length?1:5,application:a[0],server_name:a[1]||"",server_type:e};return this.treeid?(this.treeid,r):{}},checkTreeid:function(){this.treeid=this.getLocalStorage("k8s_treeid")||""},clickTab:function(e){var t=this.treeid,a=this.BTabs;a&&a.forEach((function(a){a.id===t&&(a.path=e)})),this.setLocalStorage("k8s_tabs",JSON.stringify(a))},isTrueTreeLevel:function(){var e=this.$route.path.split("/"),t=e[e.length-1],a=!1;"server"===t&&1!==this.serverData.level&&(a=!0),2===this.serverData.level||"manage"!==t&&"history"!==t&&"publish"!==t||(a=!0),a&&(1===this.serverData.level?this.$router.replace("server"):2===this.serverData.level&&this.$router.replace("manage"))},checkBTabs:function(){var e=this.BTabs,t=this.getLocalStorage("k8s_tabs");t&&t.length>0&&t.forEach((function(t){e.push({id:t.id,path:t.path})}))},checkCurrBTabs:function(){var e=this;this.$nextTick((function(){var t=e.$refs.btabs||"",a=t.children||[],r="";if(a.forEach((function(e){var t=e.getAttribute("class");t.indexOf("active")>-1&&(r=e)})),r.offsetLeft<t.scrollLeft){var o=r.offsetLeft;t.scrollTo(o,0)}else if(r.offsetLeft+r.offsetWidth>t.scrollLeft+t.offsetWidth){var i=r.offsetLeft+r.offsetWidth-t.offsetWidth;t.scrollTo(i,0)}}))},selectBTabs:function(e){var t=this.BTabs,a=!1;t.forEach((function(t){t.id===e&&(a=!0,t.path="/server/".concat(e,"/manage"))})),a||this.BTabs.push({id:e,path:"/server/".concat(e,"/manage")}),this.treeid=e,this.setLocalStorage("k8s_treeid",JSON.stringify(e)),this.setLocalStorage("k8s_tabs",JSON.stringify(t))},clickBTabs:function(e,t){t==this.homeTab&&($t.data.serverListShow=!1),this.treeid=t,this.setLocalStorage("k8s_treeid",JSON.stringify(t))},closeBTabs:function(e){var t=this.BTabs,a=0;t.forEach((function(t,r){t.id===e&&(a=r)})),t.splice(a,1),this.setLocalStorage("k8s_tabs",JSON.stringify(t)),t.length>0?this.treeid=t[t.length-1].id:this.treeid="home",this.setLocalStorage("k8s_treeid",JSON.stringify(this.treeid))},closeAllBTabs:function(){this.BTabs=[],this.treeid="home",this.setLocalStorage("k8s_tabs",JSON.stringify(this.BTabs)),this.setLocalStorage("k8s_treeid",JSON.stringify(this.treeid)),this.getTreeData()},getLocalStorage:function(e){var t="";return window.localStorage&&(t=JSON.parse(JSON.parse(localStorage.getItem(e)))),t},setLocalStorage:function(e,t){var a="";return window.localStorage&&(a=localStorage.setItem(e,JSON.stringify(t))),a}},created:function(){this.serverData=this.getServerData(),this.isTrueTreeLevel()},mounted:function(){this.checkTreeid(),this.checkBTabs(),this.getTreeData(),this.treeid||(this.treeid="home")}},yt=kt,St=(a("5d82"),Object(w["a"])(yt,D,P,!1,null,null,null)),_t=St.exports,wt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page_operation"},[a("let-tabs",{attrs:{activekey:e.$route.path},on:{click:e.onTabClick}},[a("let-tab-pane",{attrs:{tab:e.$t("deployService.title.deploy"),tabkey:"/operation/deploy"}}),a("let-tab-pane",{attrs:{tab:e.$t("deployService.title.approval"),tabkey:"/operation/approval"}}),a("let-tab-pane",{attrs:{tab:e.$t("deployService.title.history"),tabkey:"/operation/history"}}),a("let-tab-pane",{attrs:{tab:e.$t("deployService.title.undeploy"),tabkey:"/operation/undeploy"}}),a("let-tab-pane",{attrs:{tab:e.$t("deployService.title.template"),tabkey:"/operation/templates"}}),a("let-tab-pane",{attrs:{tab:e.$t("deployService.title.business"),tabkey:"/operation/business"}}),a("let-tab-pane",{attrs:{tab:e.$t("deployService.title.application"),tabkey:"/operation/application"}}),a("let-tab-pane",{attrs:{tab:e.$t("deployService.title.node"),tabkey:"/operation/node"}}),a("let-tab-pane",{attrs:{tab:e.$t("deployService.title.event"),tabkey:"/operation/event"}}),a("let-tab-pane",{attrs:{tab:e.$t("deployService.title.image"),tabkey:"/operation/image"}}),e.isAdmin?a("let-tab-pane",{attrs:{tab:e.$t("deployService.title.framework"),tabkey:"/operation/tfc"}}):e._e()],1),a("router-view",{staticClass:"page_operation_children"})],1)},Mt=[],xt="/operation/deploy",Ct={name:"Operation",data:function(){return{isAdmin:!1}},beforeRouteEnter:function(e,t,a){"/operation"===e.path?a(xt):a()},beforeRouteLeave:function(e,t,a){xt=t.path,a()},created:function(){this.checkAdmin()},methods:{checkAdmin:function(){var e=this;return Object(j["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.isAdmin=!1,t.abrupt("return",e.$ajax.getJSON("/server/api/isAdmin").then((function(t){e.isAdmin=t.admin})).catch((function(e){})));case 2:case"end":return t.stop()}}),t)})))()},selectTree:function(e){"/operation"===this.$route.path?this.$router.push(xt):this.$router.push({params:{treeid:e}})},onTabClick:function(e){this.$router.replace(e)}}},Nt=Ct,Lt=(a("04e5"),Object(w["a"])(Nt,wt,Mt,!1,null,null,null)),Tt=Lt.exports,It=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page_operation_deploy"},[a("let-form",{ref:"form",attrs:{inline:"","label-position":"top",itemWidth:"480px"},nativeOn:{submit:function(t){return t.preventDefault(),e.save(t)}}},[a("let-form-item",{attrs:{label:e.$t("deployService.form.app"),itemWidth:"45%",required:""}},[a("let-select",{attrs:{disabled:e.k8sApplyShow,size:"small",placeholder:e.$t("deployService.form.placeholder"),required:"","required-tip":e.$t("deployService.form.appTips"),pattern:"^[a-zA-Z0-9]+$","pattern-tip":e.$t("deployService.form.placeholder")},model:{value:e.model.ServerApp,callback:function(t){e.$set(e.model,"ServerApp",t)},expression:"model.ServerApp"}},e._l(e.appList,(function(t){return a("let-option",{key:t.ServerApp,attrs:{value:t.ServerApp}},[e._v(e._s(t.ServerApp))])})),1)],1),a("let-form-item",{attrs:{label:e.$t("deployService.form.serviceName"),itemWidth:"45%",required:""}},[a("let-input",{attrs:{disabled:e.k8sApplyShow,size:"small",placeholder:e.$t("deployService.form.serviceFormatTips"),required:"","required-tip":e.$t("deployService.form.serviceTips"),pattern:"^[a-zA-Z]([a-zA-Z0-9]+)?$","pattern-tip":e.$t("deployService.form.serviceFormatTips")},model:{value:e.model.ServerName,callback:function(t){e.$set(e.model,"ServerName",t)},expression:"model.ServerName"}})],1),a("let-form-item",{attrs:{label:e.$t("deployService.form.template"),itemWidth:"45%",required:""}},[a("let-select",{attrs:{disabled:e.k8sApplyShow,size:"small",placeholder:e.$t("pub.dlg.defaultValue"),required:"","required-tip":e.$t("deployService.form.templateTips")},model:{value:e.model.ServerOption.ServerTemplate,callback:function(t){e.$set(e.model.ServerOption,"ServerTemplate",t)},expression:"model.ServerOption.ServerTemplate"}},e._l(e.templates,(function(t){return a("let-option",{key:t.TemplateName,attrs:{value:t.TemplateName}},[e._v(e._s(t.TemplateName)+" ")])})),1)],1),a("let-form-item",{attrs:{label:e.$t("deployService.form.serviceMark"),itemWidth:"45%"}},[a("let-input",{attrs:{disabled:e.k8sApplyShow,size:"small",placeholder:e.$t("deployService.form.serviceMark")},model:{value:e.model.ServerMark,callback:function(t){e.$set(e.model,"ServerMark",t)},expression:"model.ServerMark"}})],1),a("let-table",{attrs:{data:e.model.ServerServant}},[a("let-table-column",{attrs:{title:"OBJ",width:"150px"},scopedSlots:e._u([{key:"head",fn:function(t){return[a("span",{staticClass:"required"},[e._v(e._s(t.column.title))])]}},{key:"default",fn:function(t){return[a("let-input",{attrs:{disabled:e.k8sApplyShow,size:"small",placeholder:e.$t("deployService.form.placeholder"),required:"","required-tip":e.$t("deployService.form.objTips"),pattern:"^[a-zA-Z0-9]+$","pattern-tip":e.$t("deployService.form.placeholder")},model:{value:t.row.Name,callback:function(a){e.$set(t.row,"Name",a)},expression:"props.row.Name"}})]}}])}),a("let-table-column",{attrs:{title:e.$t("deployService.table.th.port"),width:"100px"},scopedSlots:e._u([{key:"head",fn:function(t){return[a("span",{staticClass:"required"},[e._v(e._s(t.column.title))])]}},{key:"default",fn:function(t){return[a("let-input",{attrs:{disabled:e.k8sApplyShow,size:"small",type:"number",min:1,max:3e4,placeholder:"1-30000",required:"","required-tip":e.$t("deployService.table.tips.empty")},model:{value:t.row.Port,callback:function(a){e.$set(t.row,"Port",a)},expression:"props.row.Port"}})]}}])}),a("let-table-column",{attrs:{title:e.$t("deployService.form.portType"),width:"150px"},scopedSlots:e._u([{key:"head",fn:function(t){return[a("span",{staticClass:"required"},[e._v(e._s(t.column.title))])]}},{key:"default",fn:function(t){return[a("let-radio",{attrs:{label:!0,disabled:e.k8sApplyShow},model:{value:t.row.IsTcp,callback:function(a){e.$set(t.row,"IsTcp",a)},expression:"props.row.IsTcp"}},[e._v("TCP")]),a("let-radio",{attrs:{label:!1,disabled:e.k8sApplyShow},model:{value:t.row.IsTcp,callback:function(a){e.$set(t.row,"IsTcp",a)},expression:"props.row.IsTcp"}},[e._v("UDP")])]}}])}),a("let-table-column",{attrs:{title:e.$t("deployService.table.th.protocol"),width:"180px"},scopedSlots:e._u([{key:"head",fn:function(t){return[a("span",{staticClass:"required"},[e._v(e._s(t.column.title))])]}},{key:"default",fn:function(t){return[a("let-radio",{attrs:{label:!0,disabled:e.k8sApplyShow},model:{value:t.row.IsTaf,callback:function(a){e.$set(t.row,"IsTaf",a)},expression:"props.row.IsTaf"}},[e._v("TARS")]),a("let-radio",{attrs:{label:!1,disabled:e.k8sApplyShow},model:{value:t.row.IsTaf,callback:function(a){e.$set(t.row,"IsTaf",a)},expression:"props.row.IsTaf"}},[e._v("NOT TARS")])]}}])}),a("let-table-column",{attrs:{title:e.$t("deployService.table.th.threads"),width:"80px"},scopedSlots:e._u([{key:"head",fn:function(t){return[a("span",{staticClass:"required"},[e._v(e._s(t.column.title))])]}},{key:"default",fn:function(t){return[a("let-input",{attrs:{disabled:e.k8sApplyShow,size:"small",type:"number",min:0,required:"","required-tip":e.$t("deployService.table.tips.empty")},model:{value:t.row.Threads,callback:function(a){e.$set(t.row,"Threads",a)},expression:"props.row.Threads"}})]}}])}),a("let-table-column",{attrs:{title:e.$t("serverList.table.servant.connections"),width:"140px"},scopedSlots:e._u([{key:"head",fn:function(t){return[a("span",{staticClass:"required"},[e._v(e._s(t.column.title))])]}},{key:"default",fn:function(t){return[a("let-input",{attrs:{disabled:e.k8sApplyShow,size:"small",type:"number",min:0,required:"","required-tip":e.$t("deployService.table.tips.empty")},model:{value:t.row.Connections,callback:function(a){e.$set(t.row,"Connections",a)},expression:"props.row.Connections"}})]}}])}),a("let-table-column",{attrs:{title:e.$t("serverList.table.servant.capacity"),width:"140px"},scopedSlots:e._u([{key:"head",fn:function(t){return[a("span",{staticClass:"required"},[e._v(e._s(t.column.title))])]}},{key:"default",fn:function(t){return[a("let-input",{attrs:{disabled:e.k8sApplyShow,size:"small",type:"number",min:0,required:"","required-tip":e.$t("deployService.table.tips.empty")},model:{value:t.row.Capacity,callback:function(a){e.$set(t.row,"Capacity",a)},expression:"props.row.Capacity"}})]}}])}),a("let-table-column",{attrs:{title:e.$t("serverList.table.servant.timeout"),width:"140px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-input",{attrs:{disabled:e.k8sApplyShow,size:"small",type:"number",min:0},model:{value:t.row.Timeout,callback:function(a){e.$set(t.row,"Timeout",a)},expression:"props.row.Timeout"}})]}}])}),e.k8sApplyShow?e._e():a("let-table-column",{attrs:{title:e.$t("operate.operates"),width:"60px"},scopedSlots:e._u([{key:"default",fn:function(t){return[0===t.$index?a("let-table-operation",{on:{click:function(a){return e.addAdapter(t.row)}}},[e._v(e._s(e.$t("operate.add"))+" ")]):e._e(),t.$index?a("let-table-operation",{staticClass:"danger",on:{click:function(a){return e.model.ServerServant.splice(t.$index,1)}}},[e._v(e._s(e.$t("operate.delete"))+" ")]):e._e()]}}],null,!1,434370726)})],1),e.k8sApplyShow?e._e():a("let-button",{attrs:{type:"submit",theme:"primary"}},[e._v(e._s(e.$t("common.submit")))])],1),e.k8sApplyShow?a("div",[a("b",[e._v(e._s(e.$t("deployService.form.k8sExtra")))]),a("el-collapse",{staticStyle:{"margin-top":"5px"},attrs:{accordion:""},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("el-collapse-item",{attrs:{name:"0"}},[a("template",{slot:"title"},[a("b",[e._v(e._s(e.$t("operate.nodeSelect")))])]),a("let-form",{ref:"nodeSelect",staticClass:"two-columns",attrs:{itemWidth:"360px",columns:2}},[a("let-form-item",{attrs:{label:e.$t("deployService.form.affinity"),itemWidth:"45%"}},[a("el-select",{staticStyle:{width:"95%"},attrs:{size:"small"},model:{value:e.k8sApplyModel.abilityAffinity,callback:function(t){e.$set(e.k8sApplyModel,"abilityAffinity",t)},expression:"k8sApplyModel.abilityAffinity"}},e._l(e.abilityAffinities,(function(t){return a("el-option",{key:t,attrs:{value:t}},[e._v(e._s(t))])})),1)],1),0==e.k8sApplyModel.NodeSelector.length?a("let-form-item",{attrs:{itemWidth:"45%"}},[a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.addItems(0,e.k8sApplyModel.NodeSelector)}}},[e._v(" "+e._s(e.$t("deployService.form.labelMatch.addLabel"))+" ")])],1):e._e(),e._l(e.k8sApplyModel.NodeSelector,(function(t,r){return a("div",[a("let-form-item",{attrs:{label:e.$t("nodeList.table.th.label"),itemWidth:"15%"}},[a("el-input",{staticStyle:{width:"95%"},attrs:{size:"small"},model:{value:t.key,callback:function(a){e.$set(t,"key",a)},expression:"item.key"}})],1),a("let-form-item",{attrs:{label:"operator",itemWidth:"10%"}},[a("el-select",{staticStyle:{width:"95%"},attrs:{size:"small"},on:{change:e.changeLabelOperator},model:{value:t.operator,callback:function(a){e.$set(t,"operator",a)},expression:"item.operator"}},e._l(e.LabelMatchOperator,(function(t){return a("el-option",{key:t,attrs:{value:t}},[e._v(e._s(t))])})),1)],1),a("let-form-item",{attrs:{label:e.$t("nodes.label.value"),itemWidth:"20%"}},[a("el-select",{staticStyle:{width:"95%"},attrs:{disabled:t.disableValue,multiple:"",filterable:"","allow-create":"","multiple-limit":63,"default-first-option":"",placeholder:e.$t("deployService.form.labelMatch.labelValue"),size:"small"},on:{change:function(t){e.addLabelValues(t,r)}},model:{value:t.values,callback:function(a){e.$set(t,"values",a)},expression:"item.values"}},e._l(t.values,(function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),a("el-button",{attrs:{type:"primary",icon:"el-icon-plus",size:"mini",circle:""},on:{click:function(t){return e.addItems(r,e.k8sApplyModel.NodeSelector)}}}),a("el-button",{attrs:{type:"danger",icon:"el-icon-minus",size:"mini",circle:""},on:{click:function(t){return e.delItems(r,e.k8sApplyModel.NodeSelector)}}})],1)}))],2)],2),a("el-collapse-item",{attrs:{name:"1"}},[a("template",{slot:"title"},[a("b",[e._v(e._s(e.$t("operate.network")))])]),a("let-form",{ref:"networkForm",staticClass:"two-columns",attrs:{itemWidth:"360px",columns:2}},[a("let-form-item",{attrs:{label:e.$t("deployService.table.th.hostIpc"),itemWidth:"25%"}},[a("el-radio-group",{on:{change:e.changeKind},model:{value:e.k8sApplyModel.HostIpc,callback:function(t){e.$set(e.k8sApplyModel,"HostIpc",t)},expression:"k8sApplyModel.HostIpc"}},[a("el-radio",{attrs:{label:!0}},[e._v(e._s(e.$t("common.true")))]),a("el-radio",{attrs:{label:!1}},[e._v(e._s(e.$t("common.false")))])],1)],1),a("let-form-item",{attrs:{label:e.$t("deployService.table.th.hostNetwork"),itemWidth:"25%"}},[a("el-radio-group",{on:{change:e.changeKind},model:{value:e.k8sApplyModel.HostNetwork,callback:function(t){e.$set(e.k8sApplyModel,"HostNetwork",t)},expression:"k8sApplyModel.HostNetwork"}},[a("el-radio",{attrs:{label:!0}},[e._v(e._s(e.$t("common.true")))]),a("el-radio",{attrs:{label:!1}},[e._v(e._s(e.$t("common.false")))])],1)],1),a("let-form-item",{attrs:{label:e.$t("deployService.table.th.hostPort"),itemWidth:"25%"}},[a("el-radio-group",{on:{change:e.changeKind},model:{value:e.k8sApplyModel.showHostPort,callback:function(t){e.$set(e.k8sApplyModel,"showHostPort",t)},expression:"k8sApplyModel.showHostPort"}},[a("el-radio",{attrs:{label:!0}},[e._v(e._s(e.$t("common.true")))]),a("el-radio",{attrs:{label:!1}},[e._v(e._s(e.$t("common.false")))])],1)],1),e.k8sApplyModel.showHostPort?a("div",{staticStyle:{"padding-right":"30px"}},[a("let-table",{attrs:{data:e.k8sApplyModel.HostPortArr}},[a("let-table-column",{attrs:{title:"OBJ"},scopedSlots:e._u([{key:"head",fn:function(t){return[a("span",{staticClass:"required"},[e._v(e._s(t.column.title))])]}},{key:"default",fn:function(t){return[a("let-input",{attrs:{size:"small",placeholder:e.$t("deployService.form.placeholder"),required:"","required-tip":e.$t("deployService.form.objTips"),pattern:"^[a-zA-Z0-9]+$","pattern-tip":e.$t("deployService.form.placeholder")},model:{value:t.row.obj,callback:function(a){e.$set(t.row,"obj",a)},expression:"props.row.obj"}})]}}],null,!1,910875067)}),a("let-table-column",{attrs:{title:e.$t("deployService.table.th.hostPort")},scopedSlots:e._u([{key:"head",fn:function(t){return[a("span",{staticClass:"required"},[e._v(e._s(t.column.title))])]}},{key:"default",fn:function(t){return[a("let-input",{attrs:{size:"small",type:"number",min:1,max:65535,placeholder:"1-65535",required:"","required-tip":e.$t("deployService.table.tips.empty")},model:{value:t.row.HostPort,callback:function(a){e.$set(t.row,"HostPort",a)},expression:"props.row.HostPort"}})]}}],null,!1,4126442684)}),a("let-table-column",{scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-button",{staticClass:"port-button",attrs:{size:"small",theme:"primary"},on:{click:function(a){return e.generateHostPort(t.row)}}},[e._v(" "+e._s(e.$t("deployService.table.th.checkHostPort"))+" ")])]}}],null,!1,642882776)})],1)],1):e._e()],1)],2),a("el-collapse-item",{attrs:{name:"2"}},[a("template",{slot:"title"},[a("b",[e._v(e._s(e.$t("operate.disk")))])]),0==e.k8sApplyModel.mounts.length?a("div",[a("el-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"text",size:"mini"},on:{click:function(t){return e.addDisk(0,e.k8sApplyModel.mounts)}}},[e._v(" "+e._s(e.$t("deployService.disk.addDisk"))+" ")])],1):e._e(),a("el-form",{ref:"disk",attrs:{"label-position":"top","label-width":"120px",size:"mini"}},e._l(e.k8sApplyModel.mounts,(function(t,r){return a("div",{key:r},[a("el-card",[a("el-row",{attrs:{gutter:18}},[a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:e.$t("deployService.disk.diskName"),required:""}},[a("el-input",{model:{value:t.name,callback:function(a){e.$set(t,"name",a)},expression:"disk.name"}})],1)],1),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:e.$t("deployService.disk.path"),required:""}},[a("el-input",{model:{value:t.mountPath,callback:function(a){e.$set(t,"mountPath",a)},expression:"disk.mountPath"}})],1)],1)],1),a("el-row",{attrs:{gutter:18}},[a("el-col",{attrs:{span:4}},[a("el-form-item",{attrs:{label:"uid",required:""}},[a("el-input",{attrs:{placeholder:"0"},model:{value:t.source.tLocalVolume.uid,callback:function(a){e.$set(t.source.tLocalVolume,"uid",a)},expression:"disk.source.tLocalVolume.uid"}})],1)],1),a("el-col",{attrs:{span:4}},[a("el-form-item",{attrs:{label:"gid",required:""}},[a("el-input",{attrs:{placeholder:"0"},model:{value:t.source.tLocalVolume.gid,callback:function(a){e.$set(t.source.tLocalVolume,"gid",a)},expression:"disk.source.tLocalVolume.gid"}})],1)],1),a("el-col",{attrs:{span:4}},[a("el-form-item",{attrs:{label:"mode",required:""}},[a("el-input",{attrs:{placeholder:"755"},model:{value:t.source.tLocalVolume.mode,callback:function(a){e.$set(t.source.tLocalVolume,"mode",a)},expression:"disk.source.tLocalVolume.mode"}})],1)],1)],1),a("el-row",[a("el-col",{attrs:{offset:9}},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.addDisk(r,e.k8sApplyModel.mounts)}}},[e._v(" "+e._s(e.$t("deployService.disk.addDisk"))+" ")]),a("el-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"danger",size:"mini"},on:{click:function(t){return e.delDisk(r,e.k8sApplyModel.mounts)}}},[e._v(" "+e._s(e.$t("deployService.disk.delDisk"))+" ")])],1)],1)],1)],1)})),0)],2),a("el-collapse-item",{attrs:{name:"3"}},[a("template",{slot:"title"},[a("b",[e._v(e._s(e.$t("operate.resource")))])]),a("el-form",{attrs:{"label-width":"100px","label-position":"top",size:"mini"}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:e.$t("deployService.resources.limitCpu"),itemWidth:"50%"}},[a("el-input",{attrs:{placeholder:e.$t("deployService.resources.example")+":1000",size:"small",onkeyup:"value=value.replace(/[^\\d]/g,'')"},model:{value:e.k8sApplyModel.resources.limitCpu,callback:function(t){e.$set(e.k8sApplyModel.resources,"limitCpu",t)},expression:"k8sApplyModel.resources.limitCpu"}},[a("template",{slot:"append"},[e._v("milli CPUs")])],2)],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:e.$t("deployService.resources.limitMem"),itemWidth:"50%"}},[a("el-input",{attrs:{placeholder:e.$t("deployService.resources.example")+":128",size:"small",onkeyup:"value=value.replace(/[^\\d]/g,'')"},model:{value:e.k8sApplyModel.resources.limitMem,callback:function(t){e.$set(e.k8sApplyModel.resources,"limitMem",t)},expression:"k8sApplyModel.resources.limitMem"}},[a("template",{slot:"append"},[e._v("MiB")])],2)],1)],1)],1),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:e.$t("deployService.resources.requestCpu"),itemWidth:"50%"}},[a("el-input",{attrs:{placeholder:e.$t("deployService.resources.example")+":1000",size:"small",onkeyup:"value=value.replace(/[^\\d]/g,'')"},model:{value:e.k8sApplyModel.resources.requestCpu,callback:function(t){e.$set(e.k8sApplyModel.resources,"requestCpu",t)},expression:"k8sApplyModel.resources.requestCpu"}},[a("template",{slot:"append"},[e._v("milli CPUs")])],2)],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:e.$t("deployService.resources.requestMem"),itemWidth:"50%"}},[a("el-input",{attrs:{placeholder:e.$t("deployService.resources.example")+":128",size:"small",onkeyup:"value=value.replace(/[^\\d]/g,'')"},model:{value:e.k8sApplyModel.resources.requestMem,callback:function(t){e.$set(e.k8sApplyModel.resources,"requestMem",t)},expression:"k8sApplyModel.resources.requestMem"}},[a("template",{slot:"append"},[e._v("MiB")])],2)],1)],1)],1)],1)],2)],1),a("el-button",{staticStyle:{"margin-top":"10px"},on:{click:e.editYaml}},[e._v("yaml编辑")]),a("el-button",{staticStyle:{"margin-top":"10px"},attrs:{type:"primary"},on:{click:e.saveK8s}},[e._v(e._s(e.$t("operate.save")))])],1):e._e(),a("let-modal",{staticClass:"more-cmd",attrs:{width:"1000px",footShow:!1},on:{close:e.closeYamlModel,"on-cancel":e.closeYamlModel},model:{value:e.yamlModel.show,callback:function(t){e.$set(e.yamlModel,"show",t)},expression:"yamlModel.show"}},[a("k8s-yaml-edit",{ref:"yamlEdit",on:{successFun:e.closeYamlModel}})],1),a("let-modal",{staticClass:"more-cmd",attrs:{width:"700px",footShow:!1},on:{close:e.closeResultModal,"on-cancel":e.closeResultModal},model:{value:e.resultModal.show,callback:function(t){e.$set(e.resultModal,"show",t)},expression:"resultModal.show"}},[a("p",{staticClass:"result-text"},[e._v(" "+e._s(e.$t("deployService.form.ret.success"))+e._s(e.$t("resource.installRstMsg"))+" ")]),a("let-table",{attrs:{data:e.resultModal.resultList,"empty-msg":e.$t("common.nodata"),"row-class-name":e.resultModal.rowClassName}},[a("let-table-column",{attrs:{title:"ip",prop:"ip"}}),a("let-table-column",{attrs:{title:e.$t("resource.installResult"),prop:"rst"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("p",{domProps:{textContent:e._s(t.row.rst?e.$t("common.success"):e.$t("common.error"))}})]}}])}),a("let-table-column",{attrs:{title:e.$t("common.message"),prop:"msg"}})],1)],1)],1)},At=[],Dt=a("2494"),Pt=a("2ef0"),Ot=a.n(Pt),qt=["taf_cpp","taf_java","taf_php","taf_node","not_taf","taf_go"],jt=function(){return{ServerApp:"",ServerName:"",ServerMark:"",ServerServant:[{Name:"",Port:"",HostPort:0,showHostPort:!1,Threads:0,Connections:0,Capacity:0,Timeout:0,IsTcp:!0,IsTars:!1}],ServerOption:{ServerImportant:0}}},zt={name:"OperationDeploy",components:{SetInputer:Dt["a"],K8sYamlEdit:Pe},data:function(){return{types:qt,templates:[],appList:[],isCheckedAll:!1,NodeList:[],NodeListArr:[],model:jt(),enableAuth:!1,resultModal:{show:!1,resultList:[],rowClassName:function(e){return e&&e.row&&!e.row.rst?"err-row":""}},DeployId:"",activeTab:"0",k8sApplyShow:!1,k8sApplyModel:{NodeSelector:[],tars:{},resources:{},mounts:[]},abilityAffinities:["AppRequired","ServerRequired","AppOrServerPreferred","None"],LabelMatchOperator:[],yamlModel:{show:!1}}},mounted:function(){var e=this;this.getServerTemplate(),this.getDefaultValue(),this.getAppList(),this.getNodeList(),this.$watch("model.ServerName",(function(e,t){})),this.$watch("model.node_name",(function(t,a){t!==a&&e.model.ServerServant.forEach((function(e){e.bind_ip=t}))}))},methods:{showHostPort:function(e){e.showHostPort=!0},hideHostPort:function(e){e.HostPort=0,e.showHostPort=!1},checkedChange:function(e){this.NodeListArr.indexOf(e)>-1?this.NodeListArr.splice(this.NodeListArr.indexOf(e),1):this.NodeListArr.push(e),0===this.NodeListArr.length&&(this.isCheckedAll=!1)},addAdapter:function(e){e=this.model.ServerServant[this.model.ServerServant.length-1];var t=e.Port+1,a=Object.assign({},e,{Port:t});this.model.ServerServant.push(Object.assign({},a))},deploy:function(){var e=this;this.$refs.form.validate()&&this.$confirm(this.$t("deployService.form.deployServiceTip"),this.$t("common.alert")).then((function(){var t=e.$Loading.show();e.$ajax.postJSON("/k8s/api/deploy_create",e.model).then((function(a){t.hide(),e.DeployId=a.metadata.name,e.showK8sExtra(a.metadata.name)})).catch((function(a){t.hide(),e.$tip.error("".concat(e.$t("common.error"),": ").concat(a.message||a.err_msg))}))}))},getServerTemplate:function(){var e=this;this.$ajax.getJSON("/k8s/api/template_select",{isAll:!0}).then((function(t){e.templates=t.Data})).catch((function(t){e.$tip.error("".concat(e.$t("common.error"),": ").concat(t.message||t.err_msg))}))},save:function(){this.deploy()},showResultModal:function(e){this.resultModal.resultList=e,this.resultModal.show=!0},closeResultModal:function(){this.resultModal.show=!1,this.resultModal.resultList=[]},getDefaultValue:function(){var e=this,t=this.model,a=t.ServerServant,r=t.ServerOption;this.$ajax.getJSON("/k8s/api/default",{}).then((function(t){t.ServerServantElem&&a.forEach((function(e){e.Port=t.ServerServantElem.Port,e.HostPort=t.ServerServantElem.HostPort,e.showHostPort=!1,e.Capacity=t.ServerServantElem.Capacity,e.Connections=t.ServerServantElem.Connections,e.Threads=t.ServerServantElem.Threads,e.Timeout=t.ServerServantElem.Timeout,e.IsTcp=t.ServerServantElem.IsTcp,e.IsTars=t.ServerServantElem.IsTars})),t.ServerOption&&(r=t.ServerOption),e.model.ServerServant=a,e.model.ServerOption=r,e.LabelMatchOperator=t.LabelMatchOperator})).catch((function(t){e.$tip.error("".concat(e.$t("common.error"),": ").concat(t.message||t.err_msg))}))},getAppList:function(){var e=this;this.$ajax.getJSON("/k8s/api/application_select",{isAll:!0}).then((function(t){e.appList=t.Data}))},getNodeList:function(){var e=this;this.$ajax.getJSON("/k8s/api/node_list",{isAll:!0}).then((function(t){e.NodeList=t}))},showK8sExtra:function(e){var t=this;this.k8sApplyShow=!0,this.$ajax.getJSON("/k8s/api/deploy_select",{deployName:e}).then((function(e){var a=Ot.a.cloneDeep(e.Data[0]);console.log("deploy:"+JSON.stringify(a,null,4)),t.k8sApplyModel={abilityAffinity:a.ServerK8S.abilityAffinity,NodeSelector:a.ServerK8S.NodeSelector,HostIpc:a.ServerK8S.HostIpc,HostNetwork:a.ServerK8S.HostNetwork,mounts:a.Mounts.filter((function(e){return e.source.hasOwnProperty("tLocalVolume")})),resources:a.resources};var r=[];if(a.ServerK8S.HostPort&&Object.keys(a.ServerK8S.HostPort).length>0&&(t.k8sApplyModel.showHostPort=!0,a.ServerK8S.HostPort.forEach((function(e){r.push({obj:e.NameRef,HostPort:Math.floor(e.Port)})})),t.k8sApplyModel.HostPortArr=r),0==r.length)for(var o in t.k8sApplyModel.showHostPort=!1,t.k8sApplyModel.HostPortArr=[],a.ServerServant)t.k8sApplyModel.HostPortArr.push({obj:o,HostPort:0})})).catch((function(e){t.$tip.error("".concat(t.$t("common.error"),": ").concat(e.message||e.err_msg))}))},addItems:function(e,t){t.length>=63?this.$message.error("".concat(this.$t("deployService.form.labelMatch.labelMax"))):(t.splice(e+1,0,{key:"",operator:"In",values:[]}),this.$forceUpdate())},delItems:function(e,t){t.splice(e,1),this.$forceUpdate()},addLabelValues:function(e,t){var a=this,r=/^([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9]?$/;this.labelMatchArr[t].values.forEach((function(e,t){r.test(e)||(a.labelMatchArr[t].values.splice(t,1),a.$message.error("".concat(a.$t("deployService.form.labelMatch.labelValueValid"))))}))},changeLabelOperator:function(e){var t=this;this.labelMatchArr.forEach((function(e){"Exists"==e.operator||"DoesNotExist"==e.operator?(t.$set(e,"disableValue",!0),t.$set(e,"values",[])):t.$set(e,"disableValue",!1)}))},changeKind:function(){this.$forceUpdate()},generateHostPort:function(e){var t=this;this.$ajax.getJSON("/k8s/api/check_host_port",{NodePort:e.HostPort}).then((function(e){var a="";e.forEach((function(e){-1==e.ret?a+="<p>".concat(e.node,":").concat(e.port,": can use</p>"):a+='<p style="color: #F56C6C">'.concat(e.node,":").concat(e.port,": cannot use</p>")})),t.$message.success({dangerouslyUseHTMLString:!0,message:a})})).catch((function(e){t.$message.error("".concat(t.$t("common.error"),": ").concat(e.message||e.err_msg))}))},addDisk:function(e,t){t.splice(e+1,0,{name:"",source:{tLocalVolume:{uid:"",gid:"",mode:""}},mountPath:""}),this.$forceUpdate()},delDisk:function(e,t){t.splice(e,1),this.$forceUpdate()},saveK8s:function(){var e=this;console.log("this.model:"+JSON.stringify(this.model,null,4)),console.log("this.k8sApplyModel:"+JSON.stringify(this.k8sApplyModel,null,4)),this.$ajax.postJSON("/k8s/api/deploy_update",{DeployId:this.DeployId,ServerServant:this.model.ServerServant,ServerOption:this.model.ServerOption,ServerK8S:this.k8sApplyModel}).then((function(t){e.$tip.success("".concat(e.$t("common.success"))),e.$router.replace("/operation/approval")})).catch((function(t){e.$tip.error("".concat(e.$t("common.error"),": ").concat(t.message||t.err_msg))}))},editYaml:function(){this.yamlModel.show=!0,this.$refs.yamlEdit.show(this.DeployId,"tdeploys")},closeYamlModel:function(){this.yamlModel.show=!1}}},Vt=zt,Rt=(a("4917"),Object(w["a"])(Vt,It,At,!1,null,null,null)),Et=Rt.exports,Bt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page_operation_approval"},[a("let-form",{attrs:{inline:"",itemWidth:"200px"},nativeOn:{submit:function(t){return t.preventDefault(),e.search(t)}}},[a("let-form-item",{attrs:{label:e.$t("deployService.form.app")}},[a("let-input",{attrs:{size:"small"},model:{value:e.query.ServerApp,callback:function(t){e.$set(e.query,"ServerApp",t)},expression:"query.ServerApp"}})],1),a("let-form-item",{attrs:{label:e.$t("deployService.form.serviceName")}},[a("let-input",{attrs:{size:"small"},model:{value:e.query.ServerName,callback:function(t){e.$set(e.query,"ServerName",t)},expression:"query.ServerName"}})],1),a("let-form-item",[a("let-button",{attrs:{size:"small",type:"submit",theme:"primary"}},[e._v(e._s(e.$t("operate.search")))])],1)],1),a("let-table",{ref:"table",attrs:{data:e.items,"empty-msg":e.$t("common.nodata")}},[a("let-table-column",{attrs:{title:e.$t("deployService.form.app"),prop:"ServerApp",width:"15%"}}),a("let-table-column",{attrs:{title:e.$t("deployService.form.serviceName"),prop:"ServerName",width:"20%"}}),a("let-table-column",{attrs:{title:e.$t("serviceApproval.RequestPerson"),prop:"RequestPerson",width:"15%"}}),a("let-table-column",{attrs:{title:e.$t("serviceApproval.RequestMark"),prop:"RequestMark"}}),a("let-table-column",{attrs:{title:e.$t("serviceApproval.RequestTime"),prop:"RequestTime"}}),a("let-table-column",{attrs:{title:e.$t("operate.operates"),width:"180px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-table-operation",{on:{click:function(a){return e.editItem(t.row)}}},[e._v(e._s(e.$t("operate.update")))]),a("let-table-operation",{on:{click:function(a){return e.approvalItem(t.row)}}},[e._v(e._s(e.$t("operate.approval")))]),a("let-table-operation",{on:{click:function(a){return e.removeItem(t.row)}}},[e._v(e._s(e.$t("operate.delete")))])]}}])})],1),a("let-modal",{attrs:{title:e.$t("template.view.title"),width:"800px"},model:{value:e.viewModal.show,callback:function(t){e.$set(e.viewModal,"show",t)},expression:"viewModal.show"}},[e.viewModal.model?a("pre",[e._v(e._s(e.viewModal.model))]):e._e(),a("div",{attrs:{slot:"foot"},slot:"foot"})]),a("let-modal",{attrs:{title:e.detailModal.isNew?this.$t("dialog.title.add"):this.$t("dialog.title.edit"),width:"80%"},on:{"on-confirm":e.saveItem,"on-cancel":e.closeDetailModal},model:{value:e.detailModal.show,callback:function(t){e.$set(e.detailModal,"show",t)},expression:"detailModal.show"}},[e.detailModal.model?a("let-form",{ref:"detailForm",attrs:{inline:""}},[a("let-form-item",{attrs:{label:e.$t("deployService.form.app"),itemWidth:"45%",required:""}},[a("let-input",{attrs:{size:"small",placeholder:e.$t("deployService.form.placeholder"),required:"","required-tip":e.$t("deployService.form.appTips"),pattern:"^[a-zA-Z0-9]+$","pattern-tip":e.$t("deployService.form.placeholder")},model:{value:e.detailModal.model.ServerApp,callback:function(t){e.$set(e.detailModal.model,"ServerApp",t)},expression:"detailModal.model.ServerApp"}})],1),a("let-form-item",{attrs:{label:e.$t("deployService.form.serviceName"),itemWidth:"45%",required:""}},[a("let-input",{attrs:{size:"small",placeholder:e.$t("deployService.form.serviceFormatTips"),required:"","required-tip":e.$t("deployService.form.serviceTips"),pattern:"^[a-zA-Z]([a-zA-Z0-9]+)?$","pattern-tip":e.$t("deployService.form.serviceFormatTips")},model:{value:e.detailModal.model.ServerName,callback:function(t){e.$set(e.detailModal.model,"ServerName",t)},expression:"detailModal.model.ServerName"}})],1),a("let-form-item",{attrs:{label:e.$t("deployService.form.template"),itemWidth:"45%",required:""}},[a("let-select",{attrs:{size:"small",required:"","required-tip":e.$t("deployService.form.templateTips")},model:{value:e.detailModal.model.ServerOption.ServerTemplate,callback:function(t){e.$set(e.detailModal.model.ServerOption,"ServerTemplate",t)},expression:"detailModal.model.ServerOption.ServerTemplate"}},e._l(e.templates,(function(t){return a("let-option",{key:t.TemplateName,attrs:{value:t.TemplateName}},[e._v(e._s(t.TemplateName))])})),1)],1),a("let-form-item",{attrs:{label:e.$t("deployService.form.serviceMark"),itemWidth:"45%"}},[a("let-input",{attrs:{size:"small",placeholder:e.$t("deployService.form.serviceMark")},model:{value:e.detailModal.model.ServerMark,callback:function(t){e.$set(e.detailModal.model,"ServerMark",t)},expression:"detailModal.model.ServerMark"}})],1),a("let-table",{attrs:{data:e.detailModal.model.ServerServant}},[a("let-table-column",{attrs:{title:"OBJ",width:"150px"},scopedSlots:e._u([{key:"head",fn:function(t){return[a("span",{staticClass:"required"},[e._v(e._s(t.column.title))])]}},{key:"default",fn:function(t){return[a("let-input",{attrs:{size:"small",placeholder:e.$t("deployService.form.placeholder"),required:"","required-tip":e.$t("deployService.form.objTips"),pattern:"^[a-zA-Z0-9]+$","pattern-tip":e.$t("deployService.form.placeholder")},model:{value:t.row.Name,callback:function(a){e.$set(t.row,"Name",a)},expression:"props.row.Name"}})]}}],null,!1,3758810427)}),a("let-table-column",{attrs:{title:e.$t("deployService.table.th.port"),width:"100px"},scopedSlots:e._u([{key:"head",fn:function(t){return[a("span",{staticClass:"required"},[e._v(e._s(t.column.title))])]}},{key:"default",fn:function(t){return[a("let-input",{attrs:{size:"small",type:"number",min:0,max:65535,placeholder:"0-65535",required:"","required-tip":e.$t("deployService.table.tips.empty")},model:{value:t.row.Port,callback:function(a){e.$set(t.row,"Port",a)},expression:"props.row.Port"}})]}}],null,!1,826062684)}),a("let-table-column",{attrs:{title:e.$t("deployService.form.portType"),width:"150px"},scopedSlots:e._u([{key:"head",fn:function(t){return[a("span",{staticClass:"required"},[e._v(e._s(t.column.title))])]}},{key:"default",fn:function(t){return[a("let-radio",{attrs:{label:!0},model:{value:t.row.IsTcp,callback:function(a){e.$set(t.row,"IsTcp",a)},expression:"props.row.IsTcp"}},[e._v("TCP")]),a("let-radio",{attrs:{label:!1},model:{value:t.row.IsTcp,callback:function(a){e.$set(t.row,"IsTcp",a)},expression:"props.row.IsTcp"}},[e._v("UDP")])]}}],null,!1,1519152386)}),a("let-table-column",{attrs:{title:e.$t("deployService.table.th.protocol"),width:"180px"},scopedSlots:e._u([{key:"head",fn:function(t){return[a("span",{staticClass:"required"},[e._v(e._s(t.column.title))])]}},{key:"default",fn:function(t){return[a("let-radio",{attrs:{label:!0},model:{value:t.row.IsTars,callback:function(a){e.$set(t.row,"IsTars",a)},expression:"props.row.IsTars"}},[e._v("TARS")]),a("let-radio",{attrs:{label:!1},model:{value:t.row.IsTars,callback:function(a){e.$set(t.row,"IsTars",a)},expression:"props.row.IsTars"}},[e._v("NOT TARS")])]}}],null,!1,3031957841)}),a("let-table-column",{attrs:{title:e.$t("deployService.table.th.threads"),width:"80px"},scopedSlots:e._u([{key:"head",fn:function(t){return[a("span",{staticClass:"required"},[e._v(e._s(t.column.title))])]}},{key:"default",fn:function(t){return[a("let-input",{attrs:{size:"small",type:"number",min:0,required:"","required-tip":e.$t("deployService.table.tips.empty")},model:{value:t.row.Threads,callback:function(a){e.$set(t.row,"Threads",a)},expression:"props.row.Threads"}})]}}],null,!1,1655720946)}),a("let-table-column",{attrs:{title:e.$t("serverList.table.servant.connections"),width:"100px"},scopedSlots:e._u([{key:"head",fn:function(t){return[a("span",{staticClass:"required"},[e._v(e._s(t.column.title))])]}},{key:"default",fn:function(t){return[a("let-input",{attrs:{size:"small",type:"number",min:0,required:"","required-tip":e.$t("deployService.table.tips.empty")},model:{value:t.row.Connections,callback:function(a){e.$set(t.row,"Connections",a)},expression:"props.row.Connections"}})]}}],null,!1,2060048682)}),a("let-table-column",{attrs:{title:e.$t("serverList.table.servant.capacity"),width:"120px"},scopedSlots:e._u([{key:"head",fn:function(t){return[a("span",{staticClass:"required"},[e._v(e._s(t.column.title))])]}},{key:"default",fn:function(t){return[a("let-input",{attrs:{size:"small",type:"number",min:0,required:"","required-tip":e.$t("deployService.table.tips.empty")},model:{value:t.row.Capacity,callback:function(a){e.$set(t.row,"Capacity",a)},expression:"props.row.Capacity"}})]}}],null,!1,58581595)}),a("let-table-column",{attrs:{title:e.$t("serverList.table.servant.timeout"),width:"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-input",{attrs:{size:"small",type:"number",min:0},model:{value:t.row.Timeout,callback:function(a){e.$set(t.row,"Timeout",a)},expression:"props.row.Timeout"}})]}}],null,!1,1471836343)}),a("let-table-column",{attrs:{width:"10px"}})],1)],1):e._e()],1),a("let-modal",{attrs:{title:(e.approvalModal.isNew,this.$t("deployService.title.approval")),width:"80%"},on:{"on-confirm":e.saveApprovalItem,"on-cancel":e.closeApprovalModal},model:{value:e.approvalModal.show,callback:function(t){e.$set(e.approvalModal,"show",t)},expression:"approvalModal.show"}},[e.approvalModal.model?a("let-form",{ref:"approvalForm",attrs:{inline:""}},[a("let-form-item",{attrs:{label:e.$t("deployService.form.app"),itemWidth:"45%",required:""}},[a("let-input",{attrs:{disabled:"",size:"small",placeholder:e.$t("deployService.form.placeholder"),required:"","required-tip":e.$t("deployService.form.appTips"),pattern:"^[a-zA-Z0-9]+$","pattern-tip":e.$t("deployService.form.placeholder")},model:{value:e.approvalModal.model.ServerApp,callback:function(t){e.$set(e.approvalModal.model,"ServerApp",t)},expression:"approvalModal.model.ServerApp"}})],1),a("let-form-item",{attrs:{label:e.$t("deployService.form.serviceName"),itemWidth:"45%",required:""}},[a("let-input",{attrs:{disabled:"",size:"small",placeholder:e.$t("deployService.form.serviceFormatTips"),required:"","required-tip":e.$t("deployService.form.serviceTips"),pattern:"^[a-zA-Z]([a-zA-Z0-9]+)?$","pattern-tip":e.$t("deployService.form.serviceFormatTips")},model:{value:e.approvalModal.model.ServerName,callback:function(t){e.$set(e.approvalModal.model,"ServerName",t)},expression:"approvalModal.model.ServerName"}})],1),a("let-form-item",{attrs:{label:e.$t("deployService.form.template"),itemWidth:"45%",required:""}},[a("let-select",{attrs:{disabled:"",size:"small",required:"","required-tip":e.$t("deployService.form.templateTips")},model:{value:e.approvalModal.model.ServerOption.ServerTemplate,callback:function(t){e.$set(e.approvalModal.model.ServerOption,"ServerTemplate",t)},expression:"approvalModal.model.ServerOption.ServerTemplate"}},e._l(e.templates,(function(t){return a("let-option",{key:t.TemplateName,attrs:{value:t.TemplateName}},[e._v(e._s(t.TemplateName))])})),1)],1),a("let-form-item",{attrs:{label:e.$t("deployService.form.serviceMark"),itemWidth:"45%"}},[a("let-input",{attrs:{disabled:"",size:"small",placeholder:e.$t("deployService.form.serviceMark")},model:{value:e.approvalModal.model.ServerMark,callback:function(t){e.$set(e.approvalModal.model,"ServerMark",t)},expression:"approvalModal.model.ServerMark"}})],1),a("let-table",{attrs:{data:e.approvalModal.model.ServerServant}},[a("let-table-column",{attrs:{title:"OBJ",width:"150px"},scopedSlots:e._u([{key:"head",fn:function(t){return[a("span",{staticClass:"required"},[e._v(e._s(t.column.title))])]}},{key:"default",fn:function(t){return[a("let-input",{attrs:{disabled:"",size:"small",placeholder:e.$t("deployService.form.placeholder"),required:"","required-tip":e.$t("deployService.form.objTips"),pattern:"^[a-zA-Z0-9]+$","pattern-tip":e.$t("deployService.form.placeholder")},model:{value:t.row.Name,callback:function(a){e.$set(t.row,"Name",a)},expression:"props.row.Name"}})]}}],null,!1,3088624381)}),a("let-table-column",{attrs:{title:e.$t("deployService.table.th.port"),width:"100px"},scopedSlots:e._u([{key:"head",fn:function(t){return[a("span",{staticClass:"required"},[e._v(e._s(t.column.title))])]}},{key:"default",fn:function(t){return[a("let-input",{attrs:{disabled:"",size:"small",type:"number",min:0,max:65535,placeholder:"0-65535",required:"","required-tip":e.$t("deployService.table.tips.empty")},model:{value:t.row.Port,callback:function(a){e.$set(t.row,"Port",a)},expression:"props.row.Port"}})]}}],null,!1,2426397722)}),a("let-table-column",{attrs:{title:e.$t("deployService.form.portType"),width:"150px"},scopedSlots:e._u([{key:"head",fn:function(t){return[a("span",{staticClass:"required"},[e._v(e._s(t.column.title))])]}},{key:"default",fn:function(t){return[a("let-radio",{attrs:{disabled:"",label:!0},model:{value:t.row.IsTcp,callback:function(a){e.$set(t.row,"IsTcp",a)},expression:"props.row.IsTcp"}},[e._v("TCP")]),a("let-radio",{attrs:{disabled:"",label:!1},model:{value:t.row.IsTcp,callback:function(a){e.$set(t.row,"IsTcp",a)},expression:"props.row.IsTcp"}},[e._v("UDP")])]}}],null,!1,1671426050)}),a("let-table-column",{attrs:{title:e.$t("deployService.table.th.protocol"),width:"180px"},scopedSlots:e._u([{key:"head",fn:function(t){return[a("span",{staticClass:"required"},[e._v(e._s(t.column.title))])]}},{key:"default",fn:function(t){return[a("let-radio",{attrs:{disabled:"",label:!0},model:{value:t.row.IsTars,callback:function(a){e.$set(t.row,"IsTars",a)},expression:"props.row.IsTars"}},[e._v("TARS")]),a("let-radio",{attrs:{disabled:"",label:!1},model:{value:t.row.IsTars,callback:function(a){e.$set(t.row,"IsTars",a)},expression:"props.row.IsTars"}},[e._v("NOT TARS")])]}}],null,!1,2516800849)}),a("let-table-column",{attrs:{title:e.$t("deployService.table.th.threads"),width:"80px"},scopedSlots:e._u([{key:"head",fn:function(t){return[a("span",{staticClass:"required"},[e._v(e._s(t.column.title))])]}},{key:"default",fn:function(t){return[a("let-input",{attrs:{disabled:"",size:"small",type:"number",min:0,required:"","required-tip":e.$t("deployService.table.tips.empty")},model:{value:t.row.Threads,callback:function(a){e.$set(t.row,"Threads",a)},expression:"props.row.Threads"}})]}}],null,!1,2306495156)}),a("let-table-column",{attrs:{title:e.$t("serverList.table.servant.connections"),width:"140px"},scopedSlots:e._u([{key:"head",fn:function(t){return[a("span",{staticClass:"required"},[e._v(e._s(t.column.title))])]}},{key:"default",fn:function(t){return[a("let-input",{attrs:{disabled:"",size:"small",type:"number",min:0,required:"","required-tip":e.$t("deployService.table.tips.empty")},model:{value:t.row.Connections,callback:function(a){e.$set(t.row,"Connections",a)},expression:"props.row.Connections"}})]}}],null,!1,2695745772)}),a("let-table-column",{attrs:{title:e.$t("serverList.table.servant.capacity"),width:"140px"},scopedSlots:e._u([{key:"head",fn:function(t){return[a("span",{staticClass:"required"},[e._v(e._s(t.column.title))])]}},{key:"default",fn:function(t){return[a("let-input",{attrs:{disabled:"",size:"small",type:"number",min:0,required:"","required-tip":e.$t("deployService.table.tips.empty")},model:{value:t.row.Capacity,callback:function(a){e.$set(t.row,"Capacity",a)},expression:"props.row.Capacity"}})]}}],null,!1,1268742429)}),a("let-table-column",{attrs:{title:e.$t("serverList.table.servant.timeout"),width:"140px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-input",{attrs:{disabled:"",size:"small",type:"number",min:0},model:{value:t.row.Timeout,callback:function(a){e.$set(t.row,"Timeout",a)},expression:"props.row.Timeout"}})]}}],null,!1,882398385)}),a("let-table-column",{attrs:{width:"10px"}})],1),a("div",[a("let-form-item",{attrs:{label:e.$t("serviceApproval.ApprovalResult"),required:""}},[a("let-select",{attrs:{size:"small",required:"","required-tip":e.$t("deployService.table.tips.empty")},model:{value:e.approvalModal.model.ApprovalResult,callback:function(t){e.$set(e.approvalModal.model,"ApprovalResult",t)},expression:"approvalModal.model.ApprovalResult"}},e._l(e.approvalResult,(function(t){return a("let-option",{key:t.label,attrs:{value:t.value}},[e._v(e._s(t.label))])})),1)],1)],1),a("div",[a("let-form-item",{attrs:{label:e.$t("serviceApproval.ApprovalMark"),required:""}},[a("let-input",{attrs:{type:"textarea",rows:3,placeholder:e.$t("serviceApproval.ApprovalMark"),required:"","required-tip":e.$t("deployService.table.tips.empty")},model:{value:e.approvalModal.model.ApprovalMark,callback:function(t){e.$set(e.approvalModal.model,"ApprovalMark",t)},expression:"approvalModal.model.ApprovalMark"}})],1)],1)],1):e._e()],1)],1)},Ht=[],Ft=[{label:"Approve",value:"true"},{label:"Reject",value:"false"}],Jt={name:"OperationApproval",data:function(){return{approvalResult:Ft,templates:[],query:{ServerApp:"",ServerName:""},items:[],K8SisCheckedAll:!1,K8SNodeList:[],K8SNodeListArr:[],viewModal:{show:!1,model:null},detailModal:{show:!1,model:null,isNew:!1},approvalModal:{show:!1,model:null,isNew:!1},k8sApplyModel:{NodeSelector:[],tars:{},resources:{},mounts:[]}}},watch:{K8SisCheckedAll:function(){var e=this,t=this.K8SisCheckedAll;t?this.K8SNodeList.forEach((function(t){-1===e.K8SNodeListArr.indexOf(t)&&e.K8SNodeListArr.push(t)})):this.K8SNodeListArr=[]}},mounted:function(){this.getServerTemplate(),this.getNodeList(),this.fetchData()},methods:{K8ScheckedChange:function(e){this.K8SNodeListArr.indexOf(e)>-1?this.K8SNodeListArr.splice(this.K8SNodeListArr.indexOf(e),1):this.K8SNodeListArr.push(e),0===this.K8SNodeListArr.length&&(this.K8SisCheckedAll=!1)},fetchData:function(){var e=this,t=this.$refs.table.$loading.show();return this.$ajax.getJSON("/k8s/api/deploy_select",{ServerApp:this.query.ServerApp,ServerName:this.query.ServerName}).then((function(a){if(t.hide(),e.items=[],a.hasOwnProperty("Data")){for(var r=0;r<a.Data.length;r++){a.Data[r].RequestTime=Object(Ye["b"])(a.Data[r].RequestTime,"YYYY-MM-DD HH:mm:ss");var o=[];for(var i in a.Data[r].ServerServant)o.push(a.Data[r].ServerServant[i]);if(a.Data[r].ServerServant=o,0==a.Data[r].ServerK8S.HostPort.length)for(var s in a.Data[r].ServerServant)a.Data[r].ServerK8S.HostPort.push({NameRef:a.Data[r].ServerServant[s].Name,Port:a.Data[r].ServerServant[s].Port})}e.items=a.Data}})).catch((function(a){t.hide(),e.$tip.error("".concat(e.$t("common.error"),": ").concat(a.message||a.err_msg))}))},search:function(){this.fetchData()},closeDetailModal:function(){this.$refs.detailForm.resetValid(),this.detailModal.show=!1,this.detailModal.model=null},closeApprovalModal:function(){this.$refs.approvalForm.resetValid(),this.approvalModal.show=!1,this.approvalModal.model=null},addItem:function(){this.detailModal.model={},this.detailModal.show=!0,this.detailModal.isNew=!0},viewItem:function(e){this.viewModal.model=e,this.viewModal.show=!0},editItem:function(e){this.detailModal.model=e,this.detailModal.show=!0,this.detailModal.isNew=!1},approvalItem:function(e){this.approvalModal.model=e,this.approvalModal.show=!0,this.approvalModal.isNew=!1},adapterServerK8S:function(e){var t=Object.assign({},e),a={};return t.ServerServant.forEach((function(e){a[e.Name]=e})),t.ServerServant=a,t},saveItem:function(){var e=this;if(this.$refs.detailForm.validate()){var t=this.adapterServerK8S(this.detailModal.model);if(!t)return;var a=this.$Loading.show();this.k8sApplyModel={abilityAffinity:t.ServerK8S.abilityAffinity,NodeSelector:t.ServerK8S.NodeSelector,HostIpc:t.ServerK8S.HostIpc,HostNetwork:t.ServerK8S.HostNetwork,mounts:t.Mounts.filter((function(e){return e.source.hasOwnProperty("tLocalVolume")})),resources:t.resources};var r=[];if(t.ServerK8S.HostPort&&Object.keys(t.ServerK8S.HostPort).length>0&&(this.k8sApplyModel.showHostPort=!0,t.ServerK8S.HostPort.forEach((function(e){r.push({obj:e.NameRef,HostPort:Math.floor(e.Port)})})),this.k8sApplyModel.HostPortArr=r),0==r.length)for(var o in this.k8sApplyModel.showHostPort=!1,this.k8sApplyModel.HostPortArr=[],t.ServerServant)this.k8sApplyModel.HostPortArr.push({obj:o,HostPort:0});this.$ajax.postJSON("/k8s/api/deploy_update",{DeployId:t.DeployId,ServerServant:t.ServerServant,ServerOption:t.ServerOption,ServerK8S:this.k8sApplyModel}).then((function(){a.hide(),e.fetchData().then((function(){e.detailModal.show=!1,e.$tip.success(e.$t("common.success"))}))})).catch((function(t){a.hide(),e.$tip.error("".concat(e.$t("common.error"),": ").concat(t.message||t.err_msg))}))}},saveApprovalItem:function(){var e=this;if(this.$refs.approvalForm.validate()){var t=this.approvalModal.model,a=this.$Loading.show();this.$ajax.postJSON("/k8s/api/approval_create",t).then((function(){a.hide(),e.fetchData().then((function(){e.approvalModal.show=!1,e.$tip.success(e.$t("common.success"))}))})).catch((function(t){a.hide(),e.$tip.error("".concat(e.$t("common.error"),": ").concat(t.message||t.err_msg))}))}},removeItem:function(e){var t=this;this.$confirm(this.$t("template.delete.confirmTips"),this.$t("common.alert")).then((function(){var a=t.$Loading.show();t.$ajax.getJSON("/k8s/api/deploy_delete",{DeployId:e.DeployId}).then((function(){a.hide(),t.fetchData().then((function(){t.$tip.success(t.$t("common.success"))}))})).catch((function(e){a.hide(),t.$tip.error("".concat(t.$t("common.error"),": ").concat(e.message||e.err_msg))}))})).catch((function(){}))},getServerTemplate:function(){var e=this;this.$ajax.getJSON("/k8s/api/template_select",{isAll:!0}).then((function(t){e.templates=t.Data})).catch((function(t){e.$tip.error("".concat(e.$t("common.error"),": ").concat(t.message||t.err_msg))}))},getNodeList:function(){var e=this;this.$ajax.getJSON("/k8s/api/node_list",{isAll:!0}).then((function(t){e.K8SNodeList=t}))}}},Yt=Jt,Ut=(a("244f"),Object(w["a"])(Yt,Bt,Ht,!1,null,null,null)),Kt=Ut.exports,Wt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page_operation_history"},[a("let-table",{ref:"table",attrs:{data:e.items,"empty-msg":e.$t("common.nodata")}},[a("let-table-column",{attrs:{title:e.$t("deployService.form.app"),prop:"ServerApp",width:"15%"}}),a("let-table-column",{attrs:{title:e.$t("deployService.form.serviceName"),prop:"ServerName",width:"15%"}}),a("let-table-column",{attrs:{title:e.$t("serviceApproval.RequestPerson"),prop:"RequestPerson",width:"15%"}}),a("let-table-column",{attrs:{title:e.$t("serviceApproval.ApprovalTime"),prop:"ApprovalTime"}}),a("let-table-column",{attrs:{title:e.$t("serviceApproval.ApprovalResult"),prop:"ApprovalResult"},scopedSlots:e._u([{key:"default",fn:function(t){return[""+t.row.ApprovalResult==="true"?a("span",{staticClass:"success"},[e._v("Approval")]):""+t.row.ApprovalResult==="false"?a("span",{staticClass:"warn"},[e._v("Reject")]):a("span",[e._v(e._s(t.row.ApprovalResult))])]}}])}),a("let-table-column",{attrs:{title:e.$t("serviceApproval.ApprovalMark"),prop:"ApprovalMark"}}),a("let-table-column",{attrs:{title:e.$t("operate.operates"),width:"180px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-table-operation",{on:{click:function(a){return e.viewItem(t.row)}}},[e._v(e._s(e.$t("operate.view")))])]}}])})],1),""!=this.Continue?a("let-button",{on:{click:e.fetchData}},[e._v("more")]):e._e(),a("let-modal",{attrs:{title:e.$t("deployService.title.history"),width:"80%"},on:{"on-confirm":e.closeViewModal,"on-cancel":e.closeViewModal},model:{value:e.viewModal.show,callback:function(t){e.$set(e.viewModal,"show",t)},expression:"viewModal.show"}},[e.viewModal.model?a("let-form",{ref:"viewForm",attrs:{inline:""}},[a("let-form-item",{attrs:{label:e.$t("deployService.form.app"),itemWidth:"45%"}},[e._v(e._s(e.viewModal.model.ServerApp))]),a("let-form-item",{attrs:{label:e.$t("deployService.form.serviceName"),itemWidth:"45%"}},[e._v(e._s(e.viewModal.model.ServerName))]),a("let-form-item",{attrs:{label:e.$t("deployService.form.serviceMark"),itemWidth:"45%"}},[e._v(e._s(e.viewModal.model.ServerMark))]),a("let-table",{attrs:{data:e.viewModal.model.ServerServant}},[a("let-table-column",{attrs:{title:"OBJ"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.Name))]}}],null,!1,1485259994)}),a("let-table-column",{attrs:{title:e.$t("deployService.table.th.port")},scopedSlots:e._u([{key:"head",fn:function(t){return[a("span",{staticClass:"required"},[e._v(e._s(t.column.title))])]}},{key:"default",fn:function(t){return[e._v(e._s(t.row.Port))]}}],null,!1,1805883483)}),a("let-table-column",{attrs:{title:e.$t("deployService.form.portType")},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.IsTcp?a("let-radio",{attrs:{label:!0},model:{value:t.row.IsTcp,callback:function(a){e.$set(t.row,"IsTcp",a)},expression:"props.row.IsTcp"}},[e._v("TCP")]):a("let-radio",{attrs:{label:!1},model:{value:t.row.IsTcp,callback:function(a){e.$set(t.row,"IsTcp",a)},expression:"props.row.IsTcp"}},[e._v("UDP")])]}}],null,!1,2027518380)}),a("let-table-column",{attrs:{title:e.$t("deployService.table.th.protocol")},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.IsTars?a("let-radio",{attrs:{label:!0},model:{value:t.row.IsTars,callback:function(a){e.$set(t.row,"IsTars",a)},expression:"props.row.IsTars"}},[e._v("TARS")]):a("let-radio",{attrs:{label:!1},model:{value:t.row.IsTars,callback:function(a){e.$set(t.row,"IsTars",a)},expression:"props.row.IsTars"}},[e._v(e._s(e.$t("serverList.servant.notTARS")))])]}}],null,!1,387019230)}),a("let-table-column",{attrs:{title:e.$t("deployService.table.th.threads"),width:"80px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.Threads))]}}],null,!1,2683018496)}),a("let-table-column",{attrs:{title:e.$t("serverList.table.servant.connections"),width:"140px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.Connections))]}}],null,!1,192188376)}),a("let-table-column",{attrs:{title:e.$t("serverList.table.servant.capacity"),width:"140px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.Capacity))]}}],null,!1,4133537865)}),a("let-table-column",{attrs:{title:e.$t("serverList.table.servant.timeout"),width:"140px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.Timeout))]}}],null,!1,2137174470)}),a("let-table-column",{attrs:{width:"10px"}})],1),a("let-form-item",{attrs:{label:e.$t("serviceApproval.ApprovalResult")}},[e.viewModal.model.ApprovalResult?a("span",{class:e.viewModal.model.ApprovalResult?"success":"warn"},[e._v(e._s(e.viewModal.model.ApprovalResult?"通过":"驳回"))]):e._e()]),a("let-form-item",{attrs:{label:e.$t("serviceApproval.ApprovalMark"),itemWidth:"100%"}},[e._v(e._s(e.viewModal.model.ApprovalMark))])],1):e._e()],1)],1)},Zt=[],Gt={name:"OperationHistory",data:function(){return{items:[],Continue:null,viewModal:{show:!1,model:null},K8SisCheckedAll:!1,K8SNodeList:[]}},mounted:function(){this.getDefaultValue(),this.getNodeList(),this.fetchData()},methods:{fetchData:function(){var e=this,t=this.$refs.table.$loading.show();return this.$ajax.getJSON("/k8s/api/approval_select",{Continue:this.Continue}).then((function(a){t.hide(),e.Continue=a.Continue,a.Data&&a.Data.forEach((function(t){var a=[];if(t.ServerServant){for(var r in t.ServerServant)a.push(t.ServerServant[r]);t.ServerServant=a}t.ApprovalTime=Object(Ye["b"])(t.ApprovalTime,"YYYY-MM-DD HH:mm:ss"),e.items.push(t)}))})).catch((function(a){t.hide(),e.$tip.error("".concat(e.$t("common.error"),": ").concat(a.message||a.err_msg))}))},getNodeList:function(){var e=this;this.$ajax.getJSON("/k8s/api/node_list",{isAll:!0}).then((function(t){e.K8SNodeList=t}))},search:function(){this.fetchData()},closeViewModal:function(){this.viewModal.show=!1,this.viewModal.model=null},viewItem:function(e){var t=this.adapterServerK8S(e);this.viewModal.model=t,this.viewModal.show=!0},adapterServerK8S:function(e){return e}}},Qt=Gt,Xt=(a("afb9"),Object(w["a"])(Qt,Wt,Zt,!1,null,null,null)),ea=Xt.exports,ta=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page_operation_undeploy"},[a("let-form",{attrs:{inline:"",itemWidth:"200px"},nativeOn:{submit:function(t){return t.preventDefault(),e.search(t)}}},[a("let-form-item",{attrs:{label:e.$t("deployService.form.app")}},[a("let-input",{attrs:{size:"small"},model:{value:e.query.ServerApp,callback:function(t){e.$set(e.query,"ServerApp",t)},expression:"query.ServerApp"}})],1),a("let-form-item",{attrs:{label:e.$t("deployService.form.serviceName")}},[a("let-input",{attrs:{size:"small"},model:{value:e.query.ServerName,callback:function(t){e.$set(e.query,"ServerName",t)},expression:"query.ServerName"}})],1),a("let-form-item",[a("let-button",{attrs:{size:"small",type:"submit",theme:"primary"}},[e._v(e._s(e.$t("operate.search")))])],1)],1),a("let-table",{ref:"table",attrs:{data:e.serverList,"empty-msg":e.$t("common.nodata")}},[a("let-table-column",{attrs:{width:"60px"},scopedSlots:e._u([{key:"head",fn:function(t){return[a("let-checkbox",{model:{value:e.isCheckedAll,callback:function(t){e.isCheckedAll=t},expression:"isCheckedAll"}})]}},{key:"default",fn:function(t){return[a("let-checkbox",{on:{change:function(a){return e.checkChange(t.row)}},model:{value:t.row.isChecked,callback:function(a){e.$set(t.row,"isChecked",a)},expression:"scope.row.isChecked"}})]}}])}),a("let-table-column",{attrs:{title:e.$t("deployService.form.app"),prop:"ServerApp"}}),a("let-table-column",{attrs:{title:e.$t("deployService.form.serviceName"),prop:"ServerName"}})],1),a("div",{staticStyle:{overflow:"hidden"}},[a("div",{staticClass:"btn_group"},[a("let-button",{attrs:{theme:"primary",size:"small"},on:{click:e.undeployServer}},[e._v(e._s(e.$t("operate.undeploy")))])],1),a("let-pagination",{staticStyle:{float:"right"},attrs:{align:"right",page:e.pagination.page,total:e.pagination.total},on:{change:e.gotoPage}})],1)],1)},aa=[],ra={name:"OperationUndeploy",data:function(){return{query:{ServerApp:"",ServerName:""},pagination:{page:1,size:10,total:1},viewModal:{show:!1,model:null},serverList:[],isCheckedAll:!1,checkedList:[]}},watch:{isCheckedAll:function(){var e=this.isCheckedAll;this.serverList.forEach((function(t){t.isChecked=e})),this.checkedList=e?[].concat(this.serverList):[]}},mounted:function(){this.fetchData()},methods:{gotoPage:function(e){this.pagination.page=e,this.fetchData()},fetchData:function(){var e=this,t=this.$refs.table.$loading.show();return this.$ajax.getJSON("/k8s/api/server_list",{ServerApp:this.query.ServerApp,ServerName:this.query.ServerName,page:this.pagination.page,size:this.pagination.size}).then((function(a){t.hide(),e.serverList=[],a.hasOwnProperty("Data")&&(a.Data.forEach((function(e){e.isChecked=!1})),e.serverList=a.Data),e.pagination.total=Math.ceil(a.Count.AllCount/e.pagination.size)})).catch((function(a){t.hide(),e.$tip.error("".concat(e.$t("common.error"),": ").concat(a.message||a.err_msg))}))},search:function(){this.fetchData()},closeViewModal:function(){this.viewModal.show=!1,this.viewModal.model=null},viewItem:function(e){this.viewModal.model=e,this.viewModal.show=!0},checkChange:function(e){var t=this.checkedList,a=e.isChecked;if(a){var r=!1;t.forEach((function(t){t.ServerId===e.ServerId&&(r=!0)})),r||t.push(e)}else{var o=!1,i=-1;t.forEach((function(t,a){t.ServerId===e.ServerId&&(o=!0,i=a)})),o&&t.splice(i,1)}},undeployServer:function(){var e=this,t=this.checkedList.filter((function(e){return e.isChecked}));if(t.length<=0)this.$tip.warning(this.$t("dialog.tips.item"));else{var a=t.map((function(e){return e.ServerId}));this.$confirm(this.$t("serverList.dlg.msg.undeploy"),this.$t("common.alert")).then((function(){var t=e.$Loading.show();e.$ajax.postJSON("/k8s/api/server_undeploy",{ServerId:a}).then((function(a){t.hide(),e.fetchData(),e.$tip.success(e.$t("common.success"))})).catch((function(a){t.hide(),e.$tip.error("".concat(e.$t("common.error"),": ").concat(a.err_msg||a.message))}))}))}}}},oa=ra,ia=(a("4e15"),Object(w["a"])(oa,ta,aa,!1,null,null,null)),sa=ia.exports,la=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page_operation_templates"},[a("let-form",{attrs:{inline:"",itemWidth:"200px"},nativeOn:{submit:function(t){return t.preventDefault(),e.search(t)}}},[a("let-form-item",{attrs:{label:e.$t("deployService.form.template")}},[a("let-input",{attrs:{size:"small"},model:{value:e.query.template_name,callback:function(t){e.$set(e.query,"template_name",t)},expression:"query.template_name"}})],1),a("let-form-item",{attrs:{label:e.$t("template.search.parentTemplate")}},[a("let-input",{attrs:{size:"small"},model:{value:e.query.parents_name,callback:function(t){e.$set(e.query,"parents_name",t)},expression:"query.parents_name"}})],1),a("let-form-item",[a("let-button",{attrs:{size:"small",type:"submit",theme:"primary"}},[e._v(e._s(e.$t("operate.search")))]),e._v(" "),a("let-button",{attrs:{size:"small",theme:"primary"},on:{click:e.addItem}},[e._v(e._s(e.$t("template.btn.addTempate")))])],1)],1),a("let-table",{ref:"table",attrs:{data:e.items,"empty-msg":e.$t("common.nodata")}},[a("let-table-column",{attrs:{title:e.$t("deployService.form.template"),prop:"TemplateName",width:"25%"}}),a("let-table-column",{attrs:{title:e.$t("template.search.parentTemplate"),prop:"TemplateParent",width:"25%"}}),a("let-table-column",{attrs:{title:e.$t("cfg.btn.lastUpdate"),prop:"UpdateTime"}}),a("let-table-column",{attrs:{title:e.$t("operate.operates"),width:"180px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-table-operation",{on:{click:function(a){return e.viewItem(t.row)}}},[e._v(e._s(e.$t("operate.view")))]),a("let-table-operation",{on:{click:function(a){return e.editItem(t.row)}}},[e._v(e._s(e.$t("operate.update")))]),a("let-table-operation",{on:{click:function(a){return e.removeItem(t.row)}}},[e._v(e._s(e.$t("operate.delete")))])]}}])})],1),a("let-modal",{attrs:{title:e.$t("template.view.title"),width:"800px"},model:{value:e.viewModal.show,callback:function(t){e.$set(e.viewModal,"show",t)},expression:"viewModal.show"}},[e.viewModal.model?a("pre",[e._v(e._s(e.viewModal.model.TemplateContent))]):e._e(),a("div",{attrs:{slot:"foot"},slot:"foot"})]),a("let-modal",{attrs:{title:e.detailModal.isNew?this.$t("template.add.title"):this.$t("template.update.title"),width:"800px"},on:{"on-confirm":e.saveItem,"on-cancel":e.closeDetailModal},model:{value:e.detailModal.show,callback:function(t){e.$set(e.detailModal,"show",t)},expression:"detailModal.show"}},[e.detailModal.model?a("let-form",{ref:"detailForm",attrs:{itemWidth:"700px"}},[a("let-form-item",{attrs:{label:e.$t("deployService.form.template"),required:""}},[a("let-input",{attrs:{size:"small",placeholder:e.$t("template.add.templateFormatTips"),required:"","required-tip":e.$t("template.add.templateNameTips"),pattern:"^[a-zA-Z]([.a-zA-Z0-9]+)?$","pattern-tip":e.$t("template.add.templateFormatTips")},model:{value:e.detailModal.model.TemplateName,callback:function(t){e.$set(e.detailModal.model,"TemplateName",t)},expression:"detailModal.model.TemplateName"}})],1),a("let-form-item",{attrs:{label:e.$t("template.search.parentTemplate"),required:""}},[a("let-select",{attrs:{size:"small",placeholder:e.$t("pub.dlg.defaultValue"),required:"","required-tip":e.$t("deployService.table.tips.empty")},model:{value:e.detailModal.model.TemplateParent,callback:function(t){e.$set(e.detailModal.model,"TemplateParent",t)},expression:"detailModal.model.TemplateParent"}},[a("let-option",{attrs:{value:""}},[e._v(e._s(e.$t("pub.dlg.defaultValue")))]),e._l(e.items,(function(t){return a("let-option",{key:t.id,attrs:{value:t.TemplateName}},[e._v(e._s(t.TemplateName))])}))],2)],1),a("let-form-item",{attrs:{label:e.$t("deployService.form.serviceMark")}},[a("let-input",{attrs:{size:"small",placeholder:e.$t("deployService.form.serviceMark")},model:{value:e.detailModal.model.CreateMark,callback:function(t){e.$set(e.detailModal.model,"CreateMark",t)},expression:"detailModal.model.CreateMark"}})],1),a("let-form-item",{attrs:{label:e.$t("template.form.content"),required:""}},[a("let-input",{attrs:{type:"textarea",rows:10,size:"small",required:"","required-tip":e.$t("deployService.table.tips.empty")},model:{value:e.detailModal.model.TemplateContent,callback:function(t){e.$set(e.detailModal.model,"TemplateContent",t)},expression:"detailModal.model.TemplateContent"}})],1)],1):e._e()],1)],1)},na=[],ca={name:"OperationTemplates",data:function(){return{query:{template_name:"",parents_name:""},items:[],viewModal:{show:!1,model:null},detailModal:{show:!1,model:null,isNew:!1}}},mounted:function(){this.fetchData()},methods:{gotoPage:function(e){this.pagination.page=e,this.fetchData()},fetchData:function(){var e=this,t=this.$refs.table.$loading.show();return this.$ajax.getJSON("/k8s/api/template_select",{TemplateName:this.query.template_name,ParentName:this.query.parents_name}).then((function(a){t.hide(),e.items=a.Data,e.items.forEach((function(e){e.UpdateTime=E()(e.UpdateTime).format("YYYY-MM-DD HH:mm:ss")}))})).catch((function(a){t.hide(),e.$tip.error("".concat(e.$t("common.error"),": ").concat(a.message||a.err_msg))}))},search:function(){this.fetchData()},closeDetailModal:function(){this.$refs.detailForm.resetValid(),this.detailModal.show=!1,this.detailModal.model=null},addItem:function(){this.detailModal.model={},this.detailModal.show=!0,this.detailModal.isNew=!0},viewItem:function(e){this.viewModal.model=e,this.viewModal.show=!0},editItem:function(e){this.detailModal.model=e,this.detailModal.show=!0,this.detailModal.isNew=!1},saveItem:function(){var e=this;if(this.$refs.detailForm.validate()){var t=this.detailModal.model,a=t.TemplateId?"/k8s/api/template_update":"/k8s/api/template_create",r=this.$Loading.show();this.$ajax.postJSON(a,t).then((function(){r.hide(),e.$tip.success(e.$t("common.success")),e.closeDetailModal(),e.fetchData()})).catch((function(t){r.hide(),e.$tip.error("".concat(e.$t("common.error"),": ").concat(t.message||t.err_msg))}))}},removeItem:function(e){var t=this;this.$confirm(this.$t("template.delete.confirmTips"),this.$t("common.alert")).then((function(){var a=t.$Loading.show();t.$ajax.getJSON("/k8s/api/template_delete",{TemplateId:e.TemplateId}).then((function(){a.hide(),t.fetchData().then((function(){t.$tip.success(t.$t("common.success"))}))})).catch((function(e){a.hide(),t.$tip.error("".concat(t.$t("common.error"),": ").concat(e.message||e.err_msg))}))})).catch((function(){}))}}},da=ca,ua=(a("3976"),Object(w["a"])(da,la,na,!1,null,null,null)),pa=ua.exports,ma=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page_operation_approval"},[a("el-card",{staticStyle:{"margin-top":"10px",padding:"15px"}},[a("div",[a("span",[e._v(e._s(e.$t("deployService.title.baseImage")))]),a("el-button",{staticStyle:{float:"right","margin-bottom":"10px"},attrs:{type:"primary",size:"small"},on:{click:e.addItem}},[e._v(e._s(e.$t("imageService.btn.add"))+" ")])],1),a("let-table",{ref:"table",attrs:{data:e.baseLists,"empty-msg":e.$t("common.nodata")}},[a("let-table-column",{attrs:{title:e.$t("imageService.form.SupportedType"),prop:"SupportedTypeShow"}}),a("let-table-column",{attrs:{title:e.$t("imageService.form.Count"),prop:"Count",width:"25%"}}),a("let-table-column",{attrs:{title:e.$t("imageService.form.Mark"),prop:"Mark"}}),a("let-table-column",{attrs:{title:e.$t("imageService.form.CreateTime"),prop:"CreateTime"}}),a("let-table-column",{attrs:{title:e.$t("operate.operates"),width:"180px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-table-operation",{on:{click:function(a){return e.editItem(t.row)}}},[e._v(e._s(e.$t("operate.update"))+" ")]),a("let-table-operation",{on:{click:function(a){return e.viewItem(t.row)}}},[e._v(e._s(e.$t("operate.view")))]),a("let-table-operation",{on:{click:function(a){return e.removeItem(t.row)}}},[e._v(e._s(e.$t("operate.delete"))+" ")])]}}])})],1)],1),a("el-card",{staticStyle:{"margin-top":"10px",padding:"15px"}},[a("div",[a("span",[e._v(e._s(e.$t("deployService.title.nodeImage")))]),a("el-button",{staticStyle:{float:"right","margin-bottom":"10px"},attrs:{type:"primary",size:"small"},on:{click:e.addNodeImage}},[e._v(e._s(e.$t("imageService.btn.add"))+" ")])],1),a("let-table",{ref:"table",attrs:{data:e.tafNodeImages,"empty-msg":e.$t("common.nodata")}},[a("let-table-column",{attrs:{title:"ID"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticStyle:{color:"green",display:"inline-block"},attrs:{title:e.$t("releasePackage.default")}},[t.row.isDefault?a("i",{staticClass:"icon iconfont"},[e._v("")]):e._e()]),e._v(" "+e._s(t.row.Id)+" ")]}}])}),a("let-table-column",{attrs:{title:e.$t("pub.dlg.imageAddress"),prop:"Image"}}),a("let-table-column",{attrs:{title:e.$t("pub.dlg.mark"),prop:"Mark"}}),a("let-table-column",{attrs:{title:e.$t("operate.operates"),width:"180px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-table-operation",{on:{click:function(a){return e.editNodeImage(t.row)}}},[e._v(e._s(e.$t("operate.update"))+" ")]),a("let-table-operation",{on:{click:function(a){return e.setDefault(t.row)}}},[e._v(e._s(e.$t("operate.default"))+" ")]),a("let-table-operation",{on:{click:function(a){return e.deleteNodeImage(t.row)}}},[e._v(e._s(e.$t("operate.delete"))+" ")])]}}])})],1)],1),a("let-modal",{attrs:{title:e.baseModal.isNew?this.$t("dialog.title.add"):this.$t("dialog.title.edit"),width:"600px"},on:{"on-confirm":e.saveItem,"on-cancel":e.closeDetailModal},model:{value:e.baseModal.show,callback:function(t){e.$set(e.baseModal,"show",t)},expression:"baseModal.show"}},[e.baseModal.model?a("let-form",{ref:"detailForm",attrs:{inline:""}},[a("let-form-item",{attrs:{label:e.$t("imageService.form.SupportedType"),itemWidth:"600px",required:""}},e._l(e.SupportedType,(function(t){return a("let-checkbox",{key:t,attrs:{value:e.baseModal.model.SupportedType.indexOf(t)>-1},on:{change:function(a){return e.SupportedTypeChange(t)}}},[e._v(" "+e._s(t)+" ")])})),1),a("let-form-item",{attrs:{label:e.$t("imageService.form.Mark"),required:""}},[a("let-input",{attrs:{size:"small",placeholder:e.$t("imageService.form.Mark")},model:{value:e.baseModal.model.Mark,callback:function(t){e.$set(e.baseModal.model,"Mark",t)},expression:"baseModal.model.Mark"}})],1)],1):e._e()],1),a("let-modal",{attrs:{footShow:!1,title:this.$t("imageService.title.view"),width:"80%"},model:{value:e.releaseListsModal.show,callback:function(t){e.$set(e.releaseListsModal,"show",t)},expression:"releaseListsModal.show"}},[a("br"),e.releaseListsModal.model?a("let-table",{ref:"table",attrs:{data:e.releaseListsModal.model,"empty-msg":e.$t("common.nodata")}},[a("let-table-column",{attrs:{title:e.$t("imageService.form.Image"),prop:"Image",width:"40%"}}),a("let-table-column",{attrs:{title:e.$t("imageService.form.CreatePerson"),prop:"CreatePerson",width:"10%"}}),a("let-table-column",{attrs:{title:e.$t("imageService.form.CreateTime"),prop:"CreateTime",width:"15%"}}),a("let-table-column",{attrs:{title:e.$t("imageService.form.Mark"),prop:"Mark"}}),a("let-table-column",{attrs:{title:e.$t("operate.operates"),width:"15%"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-table-operation",{on:{click:function(a){return e.editReleaseItem(t.row)}}},[e._v(e._s(e.$t("operate.view"))+" ")]),a("let-table-operation",{on:{click:function(a){return e.removeReleaseItem(t.row)}}},[e._v(e._s(e.$t("operate.delete"))+" ")])]}}],null,!1,3590708250)})],1):e._e()],1),a("let-modal",{attrs:{title:e.releaseModal.isNew?this.$t("dialog.title.add"):this.$t("dialog.title.edit"),width:"600px"},on:{"on-confirm":e.saveReleaseItem,"on-cancel":e.closeReleaseModal},model:{value:e.releaseModal.show,callback:function(t){e.$set(e.releaseModal,"show",t)},expression:"releaseModal.show"}},[e.releaseModal.model?a("let-form",{ref:"releaseForm"},[a("let-form-item",{attrs:{label:e.$t("imageService.form.Image"),required:""}},[a("let-input",{attrs:{size:"small",placeholder:e.$t("imageService.form.ImageHolder"),required:"","required-tip":e.$t("imageService.form.ImageTips")},model:{value:e.releaseModal.model.Image,callback:function(t){e.$set(e.releaseModal.model,"Image",t)},expression:"releaseModal.model.Image"}})],1),a("let-form-item",{attrs:{label:e.$t("imageService.form.Secret")}},[a("let-input",{attrs:{size:"small",placeholder:e.$t("imageService.form.SecretTips"),required:"","required-tip":e.$t("imageService.form.SecretTips")},model:{value:e.releaseModal.model.Secret,callback:function(t){e.$set(e.releaseModal.model,"Secret",t)},expression:"releaseModal.model.Secret"}})],1),a("let-form-item",{attrs:{label:e.$t("imageService.form.Mark"),required:""}},[a("let-input",{attrs:{size:"small",placeholder:e.$t("imageService.form.Mark")},model:{value:e.releaseModal.model.Mark,callback:function(t){e.$set(e.releaseModal.model,"Mark",t)},expression:"releaseModal.model.Mark"}})],1)],1):e._e()],1),a("el-dialog",{attrs:{title:e.nodeImageModal.isNew?this.$t("dialog.title.add"):this.$t("dialog.title.edit"),visible:e.nodeImageModal.show,width:"600px","before-close":e.closeNodeModal,"close-on-click-modal":!1},on:{"update:visible":function(t){return e.$set(e.nodeImageModal,"show",t)}}},[a("el-form",{ref:"nodeForm",attrs:{model:e.nodeImageModal.model,size:"small","label-position":"top",rules:e.rules}},[a("el-form-item",{attrs:{label:"Id",prop:"Id"}},[a("el-input",{staticStyle:{width:"80%"},model:{value:e.nodeImageModal.model.Id,callback:function(t){e.$set(e.nodeImageModal.model,"Id",t)},expression:"nodeImageModal.model.Id"}})],1),a("el-form-item",{attrs:{label:e.$t("pub.dlg.imageAddress"),prop:"Image"}},[a("el-input",{staticStyle:{width:"80%"},model:{value:e.nodeImageModal.model.Image,callback:function(t){e.$set(e.nodeImageModal.model,"Image",t)},expression:"nodeImageModal.model.Image"}})],1),a("el-form-item",{attrs:{label:e.$t("pub.dlg.mark"),prop:"Mark"}},[a("el-input",{staticStyle:{width:"80%"},model:{value:e.nodeImageModal.model.Mark,callback:function(t){e.$set(e.nodeImageModal.model,"Mark",t)},expression:"nodeImageModal.model.Mark"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.closeNodeModal}},[e._v(e._s(e.$t("common.cancel")))]),a("el-button",{attrs:{type:"primary"},on:{click:e.saveNodeModal}},[e._v(e._s(e.$t("common.submit")))])],1)],1)],1)},fa=[],ha=(a("a15b"),{name:"OperationImage",data:function(){return{baseLists:[],tafNodeImages:[],SupportedType:["cpp","nodejs","java-war","java-jar","go"],baseModal:{show:!1,model:null,isNew:!1},releaseListsModal:{Name:"",show:!1,model:null,isNew:!1},releaseModal:{Name:"",show:!1,model:null,isNew:!1},nodeImageModal:{show:!1,model:{},isNew:!1},rules:{Id:[{required:!0,message:"".concat(this.$t("imageService.node.idTip")),trigger:"blur"}],Image:[{required:!0,message:"".concat(this.$t("imageService.node.imageAddressTip")),trigger:"blur"}],Mark:[{required:!0,message:"".concat(this.$t("imageService.node.markTip")),trigger:"blur"}]}}},mounted:function(){this.fetchData(),this.getTafNodeList()},methods:{fetchData:function(){var e=this,t=this.$refs.table.$loading.show();return this.$ajax.getJSON("/k8s/api/image_select",{}).then((function(a){t.hide(),e.baseLists=a.Data,e.baseLists.forEach((function(e){e.SupportedTypeShow=e.SupportedType.join(", "),e.CreateTime=E()(e.CreateTime).format("YYYY-MM-DD HH:mm:ss")}))})).catch((function(a){t.hide(),e.$tip.error("".concat(e.$t("common.error"),": ").concat(a.message||a.err_msg))}))},SupportedTypeChange:function(e){this.baseModal.model.SupportedType.indexOf(e)>-1?this.baseModal.model.SupportedType.splice(this.baseModal.model.SupportedType.indexOf(e),1):this.baseModal.model.SupportedType.push(e)},addItem:function(){this.baseModal.model={SupportedType:[]},this.baseModal.show=!0,this.baseModal.isNew=!0},fetchReleaseData:function(e){var t=this,a=this.$refs.table.$loading.show();return this.$ajax.getJSON("/k8s/api/image_release_select",{Name:e}).then((function(r){a.hide(),t.releaseListsModal.Name=e,t.releaseListsModal.model=r.Data,t.releaseListsModal.model.forEach((function(t){t.CreateTime=E()(t.CreateTime).format("YYYY-MM-DD HH:mm:ss"),t.Name=e}))})).catch((function(e){a.hide(),t.$tip.error("".concat(t.$t("common.error"),": ").concat(e.message||e.err_msg))}))},viewItem:function(e){var t=this;this.fetchReleaseData(e.Name).then((function(){t.releaseListsModal.show=!0}))},editItem:function(e){this.baseModal.model=e,this.baseModal.show=!0,this.baseModal.isNew=!1},removeItem:function(e){var t=this,a=this.$refs.table.$loading.show();this.$confirm(this.$t("imageService.delete.confirmTips"),this.$t("common.alert")).then((function(){return t.$ajax.postJSON("/k8s/api/image_delete",{Name:e.Name}).then((function(e){a.hide(),t.fetchData().then((function(){t.$tip.success(t.$t("common.success"))}))})).catch((function(e){a.hide(),t.$tip.error("".concat(t.$t("common.error"),": ").concat(e.message||e.err_msg))}))})).catch((function(){}))},closeDetailModal:function(){this.$refs.detailForm.resetValid(),this.baseModal.show=!1,this.baseModal.model=null},saveItem:function(){var e=this;if(this.$refs.detailForm.validate()){var t=this.baseModal.model,a=this.$Loading.show(),r=t.Name?"/k8s/api/image_update":"/k8s/api/image_create";this.$ajax.postJSON(r,t).then((function(){a.hide(),e.fetchData().then((function(){e.baseModal.show=!1,e.$tip.success(e.$t("common.success"))}))})).catch((function(t){a.hide(),e.$tip.error("".concat(e.$t("common.error"),": ").concat(t.message||t.err_msg))}))}},addReleaseItem:function(e){this.releaseModal.model={Name:e},this.releaseModal.show=!0,this.releaseModal.isNew=!0},closeReleaseModal:function(){this.$refs.releaseForm.resetValid(),this.releaseModal.show=!1,this.releaseModal.model=null},editReleaseItem:function(e){this.releaseModal.model=e,this.releaseModal.show=!0,this.releaseModal.isNew=!1},removeReleaseItem:function(e){var t=this;this.$confirm(this.$t("imageService.delete.confirmTips"),this.$t("common.alert")).then((function(){var a=t.$Loading.show();t.$ajax.postJSON("/k8s/api/image_release_delete",{Name:e.Name,Id:e.Id}).then((function(){a.hide(),t.fetchReleaseData(e.Name).then((function(){t.$tip.success(t.$t("common.success"))}))})).catch((function(e){a.hide(),t.$tip.error("".concat(t.$t("common.error"),": ").concat(e.message||e.err_msg))}))})).catch((function(){}))},saveReleaseItem:function(){var e=this;if(this.$refs.releaseForm.validate()){var t=this.releaseModal.model,a=this.$Loading.show();this.$ajax.postJSON("/k8s/api/image_release_create",t).then((function(){a.hide(),e.$tip.success(e.$t("common.success")),e.fetchReleaseData(t.Name),e.releaseModal.show=!1})).catch((function(t){a.hide(),e.$tip.error("".concat(e.$t("common.error"),": ").concat(t.message||t.err_msg))}))}},getTafNodeList:function(){var e=this;return Object(j["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getDefaultNodeImage();case 2:a=t.sent,e.$ajax.getJSON("/k8s/api/image_node_select").then((function(t){t.Data.forEach((function(e){e.Image==a&&(e.isDefault=!0)})),e.tafNodeImages=t.Data})).catch((function(t){e.$tip.error("".concat(e.$t("common.error"),": ").concat(t.message||t.err_msg))}));case 4:case"end":return t.stop()}}),t)})))()},getDefaultNodeImage:function(){var e=this;return Object(j["a"])(regeneratorRuntime.mark((function t(){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$ajax.getJSON("/k8s/api/get_tfc");case 2:return a=t.sent,r=a.filter((function(e){return"nodeImage.image"===e.column})),t.abrupt("return",1==r.length?r[0].value:"");case 5:case"end":return t.stop()}}),t)})))()},setDefault:function(e){var t=this;this.$ajax.postJSON("/k8s/api/save_tfc_item",{column:"nodeImage.image",value:e.Image}).then((function(e){t.getTafNodeList(),t.$message.success("".concat(t.$t("common.success")))})).catch((function(e){t.$tip.error("".concat(t.$t("common.error"),": ").concat(e.message||e.err_msg))}))},addNodeImage:function(){this.nodeImageModal.show=!0,this.nodeImageModal.isNew=!0},editNodeImage:function(e){this.nodeImageModal.model=Object.assign({},e),this.nodeImageModal.show=!0,this.nodeImageModal.isNew=!1},saveNodeModal:function(){var e=this;this.$refs.nodeForm.validate((function(t){if(!t)return!1;e.$ajax.postJSON("/k8s/api/image_node_update",e.nodeImageModal.model).then((function(t){e.closeNodeModal(),e.getTafNodeList(),e.$message.success("".concat(e.$t("common.success")))})).catch((function(t){e.$message.error("".concat(e.$t("common.error"),": ").concat(t.message||t.err_msg))}))}))},deleteNodeImage:function(e){var t=this;if(e.isDefault)this.$message.warning("".concat(this.$t("imageService.node.deleteTip")));else{var a=Object.assign({},e);this.$ajax.postJSON("/k8s/api/image_node_delete",a).then((function(e){t.getTafNodeList(),t.$message.success("".concat(t.$t("common.success")))})).catch((function(e){t.$message.error("".concat(t.$t("common.error"),": ").concat(e.message||e.err_msg))}))}},closeNodeModal:function(){this.nodeImageModal.show=!1,this.nodeImageModal.model={},this.$refs.nodeForm.resetFields()}}}),va=ha,ga=(a("c914"),a("c3f0"),Object(w["a"])(va,ma,fa,!1,null,"4ad5a006",null)),ba=ga.exports,$a=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page_base_affinity"},[a("let-form",{attrs:{inline:"",itemWidth:"200px"},nativeOn:{submit:function(t){return t.preventDefault(),e.search(t)}}},[a("let-form-item",{attrs:{label:e.$t("filter.title.node")}},[a("let-select",{attrs:{size:"small",placeholder:e.$t("pub.dlg.defaultValue")},model:{value:e.query.NodeName,callback:function(t){e.$set(e.query,"NodeName",t)},expression:"query.NodeName"}},e._l(e.NodeList,(function(t){return a("let-option",{key:t.NodeName,attrs:{value:t.NodeName}},[e._v(e._s(t.NodeNameShow))])})),1)],1),a("let-form-item",{attrs:{label:e.$t("filter.title.app")}},[a("let-select",{attrs:{size:"small",placeholder:e.$t("pub.dlg.defaultValue")},on:{change:e.changeApp},model:{value:e.query.ServerApp,callback:function(t){e.$set(e.query,"ServerApp",t)},expression:"query.ServerApp"}},e._l(e.AppList,(function(t){return a("let-option",{key:t.ServerApp,attrs:{value:t.ServerApp}},[e._v(e._s(t.AppNameShow))])})),1)],1),a("let-form-item",{attrs:{label:e.$t("filter.title.serverName")}},[a("let-select",{attrs:{size:"small",placeholder:e.$t("pub.dlg.defaultValue")},model:{value:e.query.ServerName,callback:function(t){e.$set(e.query,"ServerName",t)},expression:"query.ServerName"}},e._l(e.ServerNameList,(function(t){return a("let-option",{key:t,attrs:{value:t}},[e._v(e._s(t))])})),1)],1),a("let-form-item",[a("let-button",{attrs:{size:"small",type:"submit",theme:"primary"}},[e._v(e._s(e.$t("operate.search")))]),e._v(" "),a("let-button",{attrs:{size:"small",theme:"primary"},on:{click:e.addItem}},[e._v(e._s(e.$t("filter.btn.addAffinity")))])],1)],1),a("let-table",{ref:"table",attrs:{data:e.items,"empty-msg":e.$t("common.nodata")}},[a("let-table-column",{attrs:{title:e.$t("filter.title.app")},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"table_con"},[a("let-tag",{attrs:{theme:"success",checked:""}},[e._v(e._s(e._f("showTag")(t.row)))])],1)]}}])}),a("let-table-column",{attrs:{title:e.$t("filter.title.node")},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"table_con"},e._l(t.row.NodeName,(function(t){return a("let-tag",{key:t,attrs:{value:t,theme:"success",checked:""}},[e._v(e._s(t)+" ")])})),1)]}}])}),a("let-table-column",{attrs:{title:e.$t("operate.operates"),width:"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-table-operation",{on:{click:function(a){return e.editItem(t.row)}}},[e._v(e._s(e.$t("operate.update")))]),t.row.del?a("let-table-operation",{on:{click:function(a){return e.removeItem(t.row)}}},[e._v(e._s(e.$t("operate.delete"))+" ")]):e._e()]}}])})],1),a("let-modal",{attrs:{title:this.$t("filter.title.node"),width:"800px"},on:{"on-confirm":e.addServerItem,"on-cancel":e.closeDetailModal},model:{value:e.detailModal.show,callback:function(t){e.$set(e.detailModal,"show",t)},expression:"detailModal.show"}},[e.detailModal.model?a("let-form",{ref:"detailForm",attrs:{itemWidth:"700px"}},[a("let-form-item",{attrs:{label:e.$t("filter.title.app"),required:""}},[e.detailModal.isNew?a("let-select",{attrs:{size:"small",placeholder:e.$t("pub.dlg.defaultValue"),required:""},on:{change:e.changeApp},model:{value:e.detailModal.model.ServerApp,callback:function(t){e.$set(e.detailModal.model,"ServerApp",t)},expression:"detailModal.model.ServerApp"}},e._l(e.AppList,(function(t){return a("let-option",{key:t.ServerApp,attrs:{value:t.ServerApp}},[e._v(e._s(t.ServerApp))])})),1):e._e(),e.detailModal.isNew?e._e():a("let-input",{attrs:{size:"small",disabled:""},model:{value:e.detailModal.model.ServerApp,callback:function(t){e.$set(e.detailModal.model,"ServerApp",t)},expression:"detailModal.model.ServerApp"}})],1),a("let-form-item",{attrs:{label:e.$t("filter.title.serverName")}},[e.detailModal.isNew?a("let-select",{attrs:{size:"small",placeholder:e.$t("pub.dlg.defaultValue")},model:{value:e.detailModal.model.ServerName,callback:function(t){e.$set(e.detailModal.model,"ServerName",t)},expression:"detailModal.model.ServerName"}},e._l(e.detailModal.ServerNameList,(function(t){return a("let-option",{key:t,attrs:{value:t}},[e._v(e._s(t))])})),1):e._e(),e.detailModal.isNew?e._e():a("let-input",{attrs:{size:"small",disabled:""},model:{value:e.detailModal.model.ServerName,callback:function(t){e.$set(e.detailModal.model,"ServerName",t)},expression:"detailModal.model.ServerName"}})],1),a("let-form-item",{attrs:{label:e.$t("filter.title.node")}},[a("let-checkbox",{attrs:{value:e.isCheckedAll},model:{value:e.isCheckedAll,callback:function(t){e.isCheckedAll=t},expression:"isCheckedAll"}},[e._v(e._s(e.$t("cache.config.allSelected")))]),a("div",{staticClass:"checkbox_list"},e._l(e.NodeList,(function(t){return a("let-checkbox",{key:t.NodeName,staticClass:"checkbox_item",staticStyle:{"margin-right":"15px"},attrs:{value:e.detailModal.model.checkBoxAddList.indexOf(t.NodeName)>-1},on:{change:function(a){return e.checkedChange(t.NodeName)}}},[e._v(e._s(t.NodeName)+" ")])})),1)],1)],1):e._e()],1)],1)},ka=[],ya={name:"BaseAffinityServer",data:function(){return{isCheckedAll:!1,query:{NodeName:"",ServerApp:"",ServerName:""},totalPage:0,pageSize:20,page:1,items:[],AppList:[],NodeList:[],ServerNameList:[],viewModal:{show:!1,model:null},detailModal:{ServerNameList:[],show:!1,model:{checkBoxAddList:[],checkBoxDelList:[]},isNew:!1}}},filters:{showTag:function(e){return e.ServerName?e.ServerApp+"."+e.ServerName:e.ServerApp}},mounted:function(){var e=this;return Object(j["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getAppList();case 2:e.fetchData(),e.getNodeList();case 4:case"end":return t.stop()}}),t)})))()},watch:{isCheckedAll:function(){var e=this,t=this.isCheckedAll;t?this.NodeList.forEach((function(t){-1===e.detailModal.model.checkBoxAddList.indexOf(t.NodeName)&&e.detailModal.model.checkBoxAddList.push(t.NodeName),e.detailModal.model.checkBoxDelList=[]})):this.NodeList.forEach((function(t){-1===e.detailModal.model.checkBoxDelList.indexOf(t.NodeName)&&e.detailModal.model.checkBoxDelList.push(t.NodeName),e.detailModal.model.checkBoxAddList=[]}))}},methods:{checkedChange:function(e){-1===this.detailModal.model.checkBoxAddList.indexOf(e)?(this.detailModal.model.checkBoxAddList.push(e),this.detailModal.model.checkBoxDelList.splice(this.detailModal.model.checkBoxDelList.indexOf(e),1)):(this.detailModal.model.checkBoxDelList.push(e),this.detailModal.model.checkBoxAddList.splice(this.detailModal.model.checkBoxAddList.indexOf(e),1)),0===this.detailModal.model.checkBoxAddList.length&&(this.isCheckedAll=!1)},changePage:function(e){this.page=e},fetchData:function(){var e=this,t=this.$refs.table.$loading.show();return this.$ajax.getJSON("/k8s/api/affinity_list_server",this.query).then((function(a){t.hide(),e.items=a.Data,e.items.forEach((function(t){t.del=!e.AppList.find((function(e){return e.ServerApp==t.ServerApp}))}))})).catch((function(a){t.hide(),e.$tip.error("".concat(e.$t("common.error"),": ").concat(a.message||a.err_msg))}))},search:function(){this.changePage(1),this.fetchData()},closeDetailModal:function(){this.$refs.detailForm.resetValid(),this.detailModal.show=!1,this.detailModal.model=null},addItem:function(){this.detailModal.model={checkBoxAddList:[],checkBoxDelList:[],ServerName:"",ServerApp:""},this.detailModal.show=!0,this.detailModal.isNew=!0},viewItem:function(e){this.viewModal.model=e,this.viewModal.show=!0},editItem:function(e){this.detailModal.model=e,this.detailModal.model.checkBoxAddList=JSON.parse(JSON.stringify(e.NodeName||[])),this.detailModal.model.checkBoxDelList=[],this.detailModal.show=!0,this.detailModal.isNew=!1},addServerItem:function(){var e=this;return Object(j["a"])(regeneratorRuntime.mark((function t(){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.$refs.detailForm.validate()){t.next=17;break}if(a=e.detailModal.model,r=e.$Loading.show(),t.prev=3,!(a.checkBoxDelList&&a.checkBoxDelList.length>0)){t.next=7;break}return t.next=7,e.$ajax.postJSON("/k8s/api/affinity_del_node",{ServerApp:a.ServerApp,NodeName:a.checkBoxDelList,Force:"true"});case 7:return t.next=9,e.$ajax.postJSON("/k8s/api/affinity_add_node",{ServerApp:a.ServerApp,ServerName:a.ServerName,NodeName:a.checkBoxAddList}).then((function(){r.hide(),e.$tip.success(e.$t("common.success")),e.closeDetailModal(),e.fetchData()})).catch((function(t){r.hide(),e.$tip.error("".concat(e.$t("common.error"),": ").concat(t.message||t.err_msg))}));case 9:t.next=17;break;case 11:t.prev=11,t.t0=t["catch"](3),r.hide(),e.closeDetailModal(),e.fetchData(),e.$tip.error("".concat(e.$t("common.error"),": ").concat(t.t0.message||t.t0.err_msg));case 17:case"end":return t.stop()}}),t,null,[[3,11]])})))()},removeItem:function(e){var t=this;this.$confirm(this.$t("template.delete.confirmTips"),this.$t("common.alert")).then((function(){var a=t.$Loading.show();t.$ajax.postJSON("/k8s/api/affinity_del_node",{ServerApp:e.ServerApp,NodeName:e.NodeName,ServerName:e.ServerName,Force:"false"}).then((function(){a.hide(),t.fetchData().then((function(){t.$tip.success(t.$t("common.success"))}))})).catch((function(e){a.hide(),t.$tip.error("".concat(t.$t("common.error"),": ").concat(e.message||e.err_msg))}))})).catch((function(){}))},getAppList:function(){var e=this;return Object(j["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$ajax.getJSON("/k8s/api/application_select",{});case 2:a=t.sent,e.AppList=[],a.Data.forEach((function(t){t.AppNameShow=t.ServerApp,e.AppList.push(t)}));case 5:case"end":return t.stop()}}),t)})))()},getServerList:function(e){var t=this;return Object(j["a"])(regeneratorRuntime.mark((function a(){var r,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.$ajax.getJSON("/k8s/api/server_list",{ServerApp:e,isAll:!0});case 2:return r=a.sent,o=r.Data.map((function(e){return e.ServerName})),a.abrupt("return",o);case 5:case"end":return a.stop()}}),a)})))()},changeApp:function(e){var t=this;return Object(j["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!t.detailModal.show){a.next=7;break}return a.next=3,t.getServerList(e);case 3:t.detailModal.ServerNameList=a.sent,t.$nextTick((function(){t.detailModal.model.ServerName=""})),a.next=11;break;case 7:return t.query.ServerName="",a.next=10,t.getServerList(e);case 10:t.ServerNameList=a.sent;case 11:case"end":return a.stop()}}),a)})))()},getNodeList:function(){var e=this;this.$ajax.getJSON("/k8s/api/node_select",{}).then((function(t){e.NodeList=[],t.Data.forEach((function(t){t.NodeNameShow=t.NodeName,e.NodeList.push(t)}))}))}}},Sa=ya,_a=(a("5dd2"),Object(w["a"])(Sa,$a,ka,!1,null,null,null)),wa=_a.exports,Ma=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page_base_application"},[a("let-form",{attrs:{inline:"",itemWidth:"200px"},nativeOn:{submit:function(t){return t.preventDefault(),e.search(t)}}},[a("let-form-item",{attrs:{label:e.$t("deployService.form.app")}},[a("let-input",{attrs:{size:"small"},model:{value:e.query.ServerApp,callback:function(t){e.$set(e.query,"ServerApp",t)},expression:"query.ServerApp"}})],1),a("let-form-item",{attrs:{label:e.$t("deployService.form.business")}},[a("let-input",{attrs:{size:"small"},model:{value:e.query.BusinessName,callback:function(t){e.$set(e.query,"BusinessName",t)},expression:"query.BusinessName"}})],1),a("let-form-item",[a("let-button",{attrs:{size:"small",type:"submit",theme:"primary"}},[e._v(e._s(e.$t("operate.search")))]),e._v(" "),a("let-button",{attrs:{size:"small",theme:"primary"},on:{click:e.addItem}},[e._v(e._s(e.$t("template.btn.addApplication")))])],1)],1),a("let-table",{ref:"table",attrs:{data:e.items,"empty-msg":e.$t("common.nodata")}},[a("let-table-column",{attrs:{title:e.$t("deployService.form.app"),prop:"ServerApp",width:"25%"}}),a("let-table-column",{attrs:{title:e.$t("deployService.form.business"),prop:"BusinessName",width:"25%"}}),a("let-table-column",{attrs:{title:e.$t("deployService.form.appMark"),prop:"AppMark"}}),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.createTime"),prop:"CreateTime"}}),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.createPerson"),prop:"CreatePerson"}}),a("let-table-column",{attrs:{title:e.$t("operate.operates"),width:"180px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-table-operation",{on:{click:function(a){return e.editItem(t.row)}}},[e._v(e._s(e.$t("operate.update")))]),a("let-table-operation",{on:{click:function(a){return e.removeItem(t.row)}}},[e._v(e._s(e.$t("operate.delete")))])]}}])})],1),a("div",{staticStyle:{overflow:"hidden"}},[a("let-pagination",{staticStyle:{float:"right"},attrs:{align:"right",page:e.pagination.page,total:e.pagination.total},on:{change:e.gotoPage}})],1),a("let-modal",{attrs:{title:e.$t("template.view.title"),width:"800px"},model:{value:e.viewModal.show,callback:function(t){e.$set(e.viewModal,"show",t)},expression:"viewModal.show"}},[e.viewModal.model?a("pre",[e._v(e._s(e.viewModal.model.TemplateContent))]):e._e(),a("div",{attrs:{slot:"foot"},slot:"foot"})]),a("let-modal",{attrs:{title:e.detailModal.isNew?this.$t("dialog.title.add"):this.$t("dialog.title.edit"),width:"800px"},on:{"on-confirm":e.saveItem,"on-cancel":e.closeDetailModal},model:{value:e.detailModal.show,callback:function(t){e.$set(e.detailModal,"show",t)},expression:"detailModal.show"}},[e.detailModal.model?a("let-form",{ref:"detailForm",attrs:{itemWidth:"700px"}},[a("let-form-item",{attrs:{label:e.$t("deployService.form.app"),required:""}},[a("let-input",{attrs:{disabled:!e.detailModal.isNew,size:"small",placeholder:e.$t("deployService.form.placeholder"),required:"","required-tip":e.$t("deployService.form.appTips"),pattern:"^[a-zA-Z0-9]+$","pattern-tip":e.$t("deployService.form.placeholder")},model:{value:e.detailModal.model.ServerApp,callback:function(t){e.$set(e.detailModal.model,"ServerApp",t)},expression:"detailModal.model.ServerApp"}})],1),a("let-form-item",{attrs:{label:e.$t("deployService.form.business")}},[a("let-select",{attrs:{size:"small",placeholder:e.$t("pub.dlg.defaultValue")},model:{value:e.detailModal.model.BusinessName,callback:function(t){e.$set(e.detailModal.model,"BusinessName",t)},expression:"detailModal.model.BusinessName"}},e._l(e.BusinessList,(function(t){return a("let-option",{key:t.BusinessName,attrs:{value:t.BusinessName}},[e._v(e._s(t.BusinessShow))])})),1)],1),a("let-form-item",{attrs:{label:e.$t("deployService.form.appMark")}},[a("let-input",{attrs:{size:"small"},model:{value:e.detailModal.model.AppMark,callback:function(t){e.$set(e.detailModal.model,"AppMark",t)},expression:"detailModal.model.AppMark"}})],1)],1):e._e()],1)],1)},xa=[],Ca={name:"BaseApplication",data:function(){return{query:{ServerApp:"",BusinessName:""},items:[],BusinessList:[],pagination:{page:1,size:10,total:1},viewModal:{show:!1,model:null},detailModal:{show:!1,model:null,isNew:!1}}},mounted:function(){this.fetchData(),this.getBusinessList()},methods:{gotoPage:function(e){this.pagination.page=e,this.fetchData()},fetchData:function(){var e=this,t=this.$refs.table.$loading.show();return this.$ajax.getJSON("/k8s/api/application_select",Object.assign(this.query,{page:this.pagination.page,size:this.pagination.size})).then((function(a){t.hide(),e.items=a.Data,e.items.forEach((function(e){e.CreateTime=E()(e.CreateTime).format("YYYY-MM-DD HH:mm:ss")})),e.pagination.total=Math.ceil(a.Count.AllCount/e.pagination.size)})).catch((function(a){t.hide(),e.$tip.error("".concat(e.$t("common.error"),": ").concat(a.message||a.err_msg))}))},search:function(){this.pagination.page=1,this.fetchData()},closeDetailModal:function(){this.$refs.detailForm.resetValid(),this.detailModal.show=!1,this.detailModal.model=null},addItem:function(){this.detailModal.model={},this.detailModal.show=!0,this.detailModal.isNew=!0},viewItem:function(e){this.viewModal.model=e,this.viewModal.show=!0},editItem:function(e){this.detailModal.model=e,this.detailModal.show=!0,this.detailModal.isNew=!1},saveItem:function(){var e=this;if(this.$refs.detailForm.validate()){var t=this.detailModal.model,a=this.detailModal.isNew?"/k8s/api/application_create":"/k8s/api/application_update",r=this.$Loading.show();this.$ajax.postJSON(a,t).then((function(){r.hide(),e.$tip.success(e.$t("common.success")),e.closeDetailModal(),e.fetchData()})).catch((function(t){r.hide(),e.$tip.error("".concat(e.$t("common.error"),": ").concat(t.message||t.err_msg))}))}},removeItem:function(e){var t=this;this.$confirm(this.$t("template.delete.confirmTips"),this.$t("common.alert")).then((function(){var a=t.$Loading.show();t.$ajax.getJSON("/k8s/api/application_delete",{ServerApp:e.ServerApp}).then((function(){a.hide(),t.fetchData().then((function(){t.$tip.success(t.$t("common.success"))}))})).catch((function(e){a.hide(),t.$tip.error("".concat(t.$t("common.error"),": ").concat(e.message||e.err_msg))}))})).catch((function(){}))},getBusinessList:function(){var e=this;this.$ajax.getJSON("/k8s/api/business_select",{isAll:!0}).then((function(t){e.BusinessList=[{BusinessMark:"",BusinessName:"",BusinessOrder:0,BusinessShow:"",CreatePerson:"",CreateTime:new Date}].concat(t.Data)}))}}},Na=Ca,La=(a("5de2"),Object(w["a"])(Na,Ma,xa,!1,null,null,null)),Ta=La.exports,Ia=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page_base_business"},[a("let-form",{attrs:{inline:"",itemWidth:"200px"},nativeOn:{submit:function(t){return t.preventDefault(),e.search(t)}}},[a("let-form-item",{attrs:{label:e.$t("filter.title.business")}},[a("let-input",{attrs:{size:"small"},model:{value:e.query.BusinessName,callback:function(t){e.$set(e.query,"BusinessName",t)},expression:"query.BusinessName"}})],1),a("let-form-item",{attrs:{label:e.$t("filter.title.name")}},[a("let-input",{attrs:{size:"small"},model:{value:e.query.BusinessShow,callback:function(t){e.$set(e.query,"BusinessShow",t)},expression:"query.BusinessShow"}})],1),a("let-form-item",{attrs:{label:e.$t("filter.title.mark")}},[a("let-input",{attrs:{size:"small"},model:{value:e.query.BusinessMark,callback:function(t){e.$set(e.query,"BusinessMark",t)},expression:"query.BusinessMark"}})],1),a("let-form-item",[a("let-button",{attrs:{size:"small",type:"submit",theme:"primary"}},[e._v(e._s(e.$t("operate.search")))]),e._v(" "),a("let-button",{attrs:{size:"small",theme:"primary"},on:{click:e.addItem}},[e._v(e._s(e.$t("filter.btn.add")))])],1)],1),a("let-table",{ref:"table",attrs:{data:e.items,"empty-msg":e.$t("common.nodata")}},[a("let-table-column",{attrs:{title:e.$t("filter.title.business"),prop:"BusinessName",width:"20%"}}),a("let-table-column",{attrs:{title:e.$t("filter.title.name"),prop:"BusinessShow",width:"20%"}}),a("let-table-column",{attrs:{title:e.$t("filter.title.mark"),prop:"BusinessMark",width:"20%"}}),a("let-table-column",{attrs:{title:e.$t("filter.title.order"),prop:"BusinessOrder"}}),a("let-table-column",{attrs:{title:e.$t("operate.operates"),width:"180px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-table-operation",{on:{click:function(a){return e.appListItem(t.row)}}},[e._v(e._s(e.$t("table.btn.appList")))]),a("let-table-operation",{on:{click:function(a){return e.editItem(t.row)}}},[e._v(e._s(e.$t("operate.update")))]),a("let-table-operation",{on:{click:function(a){return e.removeItem(t.row)}}},[e._v(e._s(e.$t("operate.delete")))])]}}])})],1),a("div",{staticStyle:{overflow:"hidden"}},[a("let-pagination",{staticStyle:{float:"right"},attrs:{align:"right",page:e.pagination.page,total:e.pagination.total},on:{change:e.gotoPage}})],1),a("let-modal",{attrs:{title:e.$t("template.view.title"),width:"800px"},model:{value:e.viewModal.show,callback:function(t){e.$set(e.viewModal,"show",t)},expression:"viewModal.show"}},[e.viewModal.model?a("pre",[e._v(e._s(e.viewModal.model.TemplateContent))]):e._e(),a("div",{attrs:{slot:"foot"},slot:"foot"})]),a("let-modal",{attrs:{title:e.detailModal.isNew?this.$t("dialog.title.add"):this.$t("dialog.title.edit"),width:"800px"},on:{"on-confirm":e.saveItem,"on-cancel":e.closeDetailModal},model:{value:e.detailModal.show,callback:function(t){e.$set(e.detailModal,"show",t)},expression:"detailModal.show"}},[e.detailModal.model?a("let-form",{ref:"detailForm",attrs:{itemWidth:"700px"}},[a("let-form-item",{attrs:{label:e.$t("filter.title.business"),required:""}},[a("let-input",{attrs:{disabled:!e.detailModal.isNew,size:"small",placeholder:e.$t("deployService.form.placeholder"),required:""},model:{value:e.detailModal.model.BusinessName,callback:function(t){e.$set(e.detailModal.model,"BusinessName",t)},expression:"detailModal.model.BusinessName"}})],1),a("let-form-item",{attrs:{label:e.$t("filter.title.name"),required:""}},[a("let-input",{attrs:{size:"small",placeholder:e.$t("deployService.form.placeholder"),required:""},model:{value:e.detailModal.model.BusinessShow,callback:function(t){e.$set(e.detailModal.model,"BusinessShow",t)},expression:"detailModal.model.BusinessShow"}})],1),a("let-form-item",{attrs:{label:e.$t("filter.title.order"),required:""}},[a("let-input",{attrs:{size:"small",type:"number",min:0,max:100,required:""},model:{value:e.detailModal.model.BusinessOrder,callback:function(t){e.$set(e.detailModal.model,"BusinessOrder",t)},expression:"detailModal.model.BusinessOrder"}})],1),a("let-form-item",{attrs:{label:e.$t("filter.title.mark")}},[a("let-input",{attrs:{size:"small"},model:{value:e.detailModal.model.BusinessMark,callback:function(t){e.$set(e.detailModal.model,"BusinessMark",t)},expression:"detailModal.model.BusinessMark"}})],1)],1):e._e()],1),a("let-modal",{attrs:{title:e.AppModal.isNew?this.$t("dialog.title.add"):this.$t("dialog.title.edit"),width:"800px"},on:{"on-confirm":e.appListSaveItem,"on-cancel":e.closeAppModal},model:{value:e.AppModal.show,callback:function(t){e.$set(e.AppModal,"show",t)},expression:"AppModal.show"}},[e.AppModal.model?a("let-form",{ref:"AppForm",attrs:{itemWidth:"700px"}},[a("let-form-item",{attrs:{label:e.$t("filter.title.business"),required:""}},[a("let-input",{attrs:{disabled:!e.AppModal.isNew,size:"small",placeholder:e.$t("deployService.form.placeholder"),required:""},model:{value:e.AppModal.model.BusinessName,callback:function(t){e.$set(e.AppModal.model,"BusinessName",t)},expression:"AppModal.model.BusinessName"}})],1),a("let-form-item",{attrs:{label:e.$t("filter.title.name"),required:""}},[a("let-input",{attrs:{disabled:!e.AppModal.isNew,size:"small",placeholder:e.$t("deployService.form.placeholder"),required:""},model:{value:e.AppModal.model.BusinessShow,callback:function(t){e.$set(e.AppModal.model,"BusinessShow",t)},expression:"AppModal.model.BusinessShow"}})],1),a("let-form-item",{attrs:{label:e.$t("filter.title.app")}},[a("let-checkbox",{attrs:{value:e.isCheckedAll},model:{value:e.isCheckedAll,callback:function(t){e.isCheckedAll=t},expression:"isCheckedAll"}},[e._v("全选")]),a("div",{staticClass:"checkbox_list"},e._l(e.AppList,(function(t){return a("let-checkbox",{key:t.ServerApp,staticClass:"checkbox_item",attrs:{value:e.checkBoxAddList.indexOf(t.ServerApp)>-1},on:{change:function(a){return e.checkedChange(t.ServerApp)}}},[e._v(e._s(t.ServerApp))])})),1)],1)],1):e._e()],1)],1)},Aa=[],Da={name:"BaseBusiness",data:function(){return{isCheckedAll:!1,checkBoxAddList:[],checkBoxDelList:[],query:{BusinessName:"",BusinessShow:"",BusinessMark:""},items:[],AppList:[],pagination:{page:1,size:10,total:1},viewModal:{show:!1,model:null},detailModal:{show:!1,model:null,isNew:!1},AppServerArr:[],AppServerStr:"",AppServerDeleteArr:[],AppModal:{show:!1,model:null,isNew:!1}}},mounted:function(){this.fetchData()},watch:{isCheckedAll:function(){var e=this,t=this.isCheckedAll;t?this.AppList.forEach((function(t){-1===e.checkBoxAddList.indexOf(t.ServerApp)&&e.checkBoxAddList.push(t.ServerApp),e.checkBoxDelList=[]})):this.AppList.forEach((function(t){-1===e.checkBoxDelList.indexOf(t.ServerApp)&&e.checkBoxDelList.push(t.ServerApp),e.checkBoxAddList=[]}))}},methods:{checkedChange:function(e){-1===this.checkBoxAddList.indexOf(e)?(this.checkBoxAddList.push(e),this.checkBoxDelList.splice(this.checkBoxDelList.indexOf(e),1)):(this.checkBoxDelList.push(e),this.checkBoxAddList.splice(this.checkBoxAddList.indexOf(e),1)),0===this.checkBoxAddList.length&&(this.isCheckedAll=!1)},gotoPage:function(e){this.pagination.page=e,this.fetchData()},fetchData:function(){var e=this,t=this.$refs.table.$loading.show();return this.$ajax.getJSON("/k8s/api/business_select",Object.assign(this.query,{isAll:!1,page:this.pagination.page,size:this.pagination.size})).then((function(a){t.hide(),e.items=a.Data,e.pagination.total=Math.ceil(a.Count.AllCount/e.pagination.size)})).catch((function(a){t.hide(),e.$tip.error("".concat(e.$t("common.error"),": ").concat(a.message||a.err_msg))}))},search:function(){this.pagination.page=1,this.fetchData()},closeDetailModal:function(){this.$refs.detailForm.resetValid(),this.detailModal.show=!1,this.detailModal.model=null},closeAppModal:function(){this.$refs.AppForm.resetValid(),this.AppModal.show=!1,this.AppModal.model=null},addItem:function(){this.checkBoxAddList=[],this.detailModal.model={},this.detailModal.show=!0,this.detailModal.isNew=!0},viewItem:function(e){this.viewModal.model=e,this.viewModal.show=!0},editItem:function(e){this.checkBoxAddList=e.AppServer||[],this.detailModal.model=e,this.detailModal.show=!0,this.detailModal.isNew=!1},saveItem:function(){var e=this;if(this.$refs.detailForm.validate()){var t=this.detailModal.model,a=this.detailModal.isNew?"/k8s/api/business_create":"/k8s/api/business_update",r=this.$Loading.show();this.$ajax.postJSON(a,t).then((function(){r.hide(),e.$tip.success(e.$t("common.success")),e.closeDetailModal(),e.fetchData()})).catch((function(t){r.hide(),e.$tip.error("".concat(e.$t("common.error"),": ").concat(t.message||t.err_msg))}))}},removeItem:function(e){var t=this;this.$confirm(this.$t("template.delete.confirmTips"),this.$t("common.alert")).then((function(){var a=t.$Loading.show();t.$ajax.getJSON("/k8s/api/business_delete",{BusinessName:e.BusinessName}).then((function(){a.hide(),t.fetchData().then((function(){t.$tip.success(t.$t("common.success"))}))})).catch((function(e){a.hide(),t.$tip.error("".concat(t.$t("common.error"),": ").concat(e.message||e.err_msg))}))})).catch((function(){}))},getAppList:function(){var e=this;this.$ajax.getJSON("/k8s/api/application_select",{isAll:!0}).then((function(t){e.AppList=t.Data}))},appListItem:function(e){var t=this;this.getAppList();var a=this.$refs.table.$loading.show();return this.$ajax.postJSON("/k8s/api/business_list_app",{BusinessNames:[e.BusinessName]}).then((function(e){a.hide(),t.appListEditItem(e[0])})).catch((function(e){a.hide(),t.$tip.error("".concat(t.$t("common.error"),": ").concat(e.message||e.err_msg))}))},appListEditItem:function(e){this.checkBoxAddList=e.App||[],this.AppModal.model=e,this.AppModal.show=!0,this.AppModal.isNew=!1},appListSaveItem:function(){var e=this;if(this.$refs.AppForm.validate()){var t=this.AppModal.model,a=(this.AppModal.isNew,"/k8s/api/business_add_app"),r=this.$Loading.show();this.checkBoxAddList&&this.checkBoxAddList.length>0?this.$ajax.postJSON(a,{BusinessName:t.BusinessName,AppNames:this.checkBoxAddList}).then((function(){r.hide(),e.$tip.success(e.$t("common.success")),e.closeAppModal(),e.fetchData()})).catch((function(t){r.hide(),e.$tip.error("".concat(e.$t("common.error"),": ").concat(t.message||t.err_msg))})):(r.hide(),this.closeAppModal())}}}},Pa=Da,Oa=(a("b50eb"),Object(w["a"])(Pa,Ia,Aa,!1,null,null,null)),qa=Oa.exports,ja=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page_base_node"},[e.showDetail?e._e():[a("let-form",{attrs:{inline:"",itemWidth:"200px"},nativeOn:{submit:function(t){return t.preventDefault(),e.search(t)}}},[a("let-form-item",{attrs:{label:e.$t("filter.title.node")}},[a("el-input",{attrs:{size:"small"},model:{value:e.query.NodeName,callback:function(t){e.$set(e.query,"NodeName",t)},expression:"query.NodeName"}})],1),a("let-form-item",{attrs:{label:e.$t("deployService.form.app")}},[a("el-select",{attrs:{clearable:"",size:"small",filterable:""},on:{change:e.queryAppChange},model:{value:e.query.ServerApp,callback:function(t){e.$set(e.query,"ServerApp",t)},expression:"query.ServerApp"}},e._l(e.appList,(function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),a("let-form-item",{attrs:{label:e.$t("deployService.form.serviceName")}},[a("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",size:"small"},model:{value:e.query.ServerName,callback:function(t){e.$set(e.query,"ServerName",t)},expression:"query.ServerName"}},e._l(e.serList,(function(e){return a("el-option",{key:e,attrs:{label:e,filterable:"",value:e}})})),1)],1),a("let-form-item",[a("let-button",{attrs:{size:"small",type:"submit",theme:"primary"}},[e._v(e._s(e.$t("filter.btn.searchAffinity")))])],1),a("let-form-item",{attrs:{itemWidth:"600px"}},[a("el-tag",{staticStyle:{"margin-right":"10px"},attrs:{effect:"plain"}},[e._v(" "+e._s(e.$t("filter.title.CommonTag"))+" ")]),a("el-tag",{staticStyle:{"margin-right":"10px"},attrs:{effect:"plain",type:"warning"}},[e._v(" "+e._s(e.$t("filter.title.FrameWorkTag"))+" ")])],1),a("div",{staticStyle:{float:"right","margin-top":"30px"}},[a("let-button",{staticStyle:{"margin-right":"10px"},attrs:{size:"small",type:"submit",theme:"primary",disabled:!e.batchEnabled},on:{click:e.batchEditCommon}},[e._v(" "+e._s(e.$t("filter.btn.editTag"))+" ")]),a("let-button",{attrs:{size:"small",type:"submit",theme:"primary",disabled:!e.batchEnabled},on:{click:e.batchEditAffinity}},[e._v(" "+e._s(e.$t("filter.btn.editAffinity"))+" ")])],1)],1),a("br"),a("el-table",{ref:"table",attrs:{data:e.items,width:"100%",border:"",stripe:"","highlight-current-row":""},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),a("el-table-column",{attrs:{label:e.$t("filter.title.nodeName"),prop:"NodeName",width:"150"}}),a("el-table-column",{attrs:{label:e.$t("common.status"),width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return["Active"==t.row.status?a("el-tag",{attrs:{size:"small",effect:"plain",type:"success"}},[e._v(" "+e._s(t.row.status)+" ")]):e._e(),"Unavailable"==t.row.status?a("el-tag",{attrs:{size:"small",effect:"plain",type:"danger"}},[e._v(" "+e._s(t.row.status)+" ")]):e._e()]}}],null,!1,3672167682)}),a("el-table-column",{attrs:{label:"Version",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.NodInfo.kubeletVersion)+" ")]}}],null,!1,2972685414)}),a("el-table-column",{attrs:{label:e.$t("filter.title.nodeFramework"),width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-switch",{on:{change:function(a){return e.changeStatus(t.row)}},model:{value:t.row.NodePublic,callback:function(a){e.$set(t.row,"NodePublic",a)},expression:"scope.row.NodePublic"}},[a("span",{attrs:{slot:"open"},slot:"open"},[e._v("开")]),a("span",{attrs:{slot:"close"},slot:"close"},[e._v("关")])])]}}],null,!1,1705370074)}),a("el-table-column",{attrs:{label:e.$t("filter.title.nodeLabels")},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.commonLabels,(function(t,r){return a("el-tag",{key:r,staticStyle:{margin:"2px 2px"},attrs:{effect:"plain",type:e._f("tagType")(r)}},[e._v(" "+e._s(r+":"+t)+" ")])}))}}],null,!1,2926056322)}),a("el-table-column",{attrs:{label:e.$t("filter.title.AbilityTag"),width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.NodeAbility,(function(t){return a("el-tag",{key:t,staticStyle:{margin:"2px 2px"},attrs:{effect:"plain",type:e._f("abilityType")(t)}},[e._v(" "+e._s(t)+" ")])}))}}],null,!1,3467388542)}),a("el-table-column",{attrs:{label:e.$t("filter.title.nodeAddress"),width:"210"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.NodeAddress,(function(t){return a("div",{key:t.NodeName,staticStyle:{margin:"2px 2px"}},[a("el-tag",{attrs:{effect:"plain",type:"info"}},[e._v(e._s(t.type+":"+t.address)+" ")])],1)}))}}],null,!1,402632902)}),a("el-table-column",{attrs:{label:e.$t("operate.operates"),width:"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-table-operation",{on:{click:function(a){return e.viewItem(t.row)}}},[e._v(" "+e._s(e.$t("operate.view"))+" ")]),a("br"),a("let-table-operation",{on:{click:function(a){return e.editCommonTag(t.row)}}},[e._v(" "+e._s(e.$t("filter.btn.editTag"))+" ")]),a("br"),a("let-table-operation",{on:{click:function(a){return e.editAbilityTag(t.row)}}},[e._v(" "+e._s(e.$t("filter.btn.editAffinity"))+" ")])]}}],null,!1,1007266554)})],1),a("br"),a("let-pagination",{staticStyle:{float:"right"},attrs:{align:"right",page:e.pagination.page,total:e.pagination.total},on:{change:e.gotoPage}}),a("el-dialog",{attrs:{title:e.$t("filter.dialog.editCommonTag"),visible:e.commonTagDialog.show,width:"40%","before-close":e.closeCommonTagDialog,"close-on-click-modal":!1},on:{"update:visible":function(t){return e.$set(e.commonTagDialog,"show",t)}}},[a("el-form",{ref:"commonForm",attrs:{model:e.commonTagDialog.model,"inline-message":""}},[a("el-table",{attrs:{data:e.commonTagDialog.model.commonArr,border:""}},[a("template",{slot:"empty"},[a("let-table-operation",{on:{click:function(t){return e.addCommonTag(0,e.commonTagDialog.model.commonArr)}}},[e._v(" "+e._s(e.$t("deployService.form.labelMatch.addLabel"))+" ")])],1),a("el-table-column",{attrs:{label:e.$t("filter.title.tagName")},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-form-item",{attrs:{prop:"commonArr."+t.$index+".name",rules:[{validator:function(a,r,o){e.validateTagName(a,r,o,t.row.name)},trigger:"blur"}]}},[a("el-input",{model:{value:t.row.name,callback:function(a){e.$set(t.row,"name",a)},expression:"scope.row.name"}})],1)]}}],null,!1,1739047982)}),a("el-table-column",{attrs:{label:e.$t("filter.title.tagName")},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{model:{value:t.row.value,callback:function(a){e.$set(t.row,"value",a)},expression:"scope.row.value"}})]}}],null,!1,4065949250)}),a("el-table-column",{attrs:{label:e.$t("operate.operates"),width:"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-table-operation",{on:{click:function(a){return e.addCommonTag(t.$index,e.commonTagDialog.model.commonArr)}}},[e._v(" "+e._s(e.$t("operate.add"))+" ")]),a("let-table-operation",{on:{click:function(a){return e.delCommonTag(t.$index,e.commonTagDialog.model.commonArr)}}},[e._v(" "+e._s(e.$t("operate.delete"))+" ")])]}}],null,!1,2871227552)})],2)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.closeCommonTagDialog}},[e._v(e._s(e.$t("common.cancel")))]),a("el-button",{attrs:{type:"primary"},on:{click:e.saveCommonTag}},[e._v(e._s(e.$t("common.submit")))])],1)],1),a("el-dialog",{attrs:{title:e.$t("filter.dialog.editAbilityTag"),visible:e.abilityTagDialog.show,width:"40%","before-close":e.closeAbilityTagDialog,"close-on-click-modal":!1},on:{"update:visible":function(t){return e.$set(e.abilityTagDialog,"show",t)}}},[a("el-form",{ref:"abilityForm",attrs:{model:e.abilityTagDialog.model,"inline-message":""}},[a("el-table",{attrs:{data:e.abilityTagDialog.model.abilityArr,border:""}},[a("template",{slot:"empty"},[a("let-table-operation",{on:{click:function(t){return e.addAbilityTag(0,e.abilityTagDialog.model.abilityArr)}}},[e._v(" "+e._s(e.$t("filter.tip.addAffinityGroup"))+" ")])],1),a("el-table-column",{attrs:{label:e.$t("filter.title.app")},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-form-item",{attrs:{prop:"abilityArr."+t.$index+".application",rules:[{validator:function(a,r,o){e.validateAppName(a,r,o,t.row.application)},trigger:"change"}]}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:e.$t("pub.dlg.defaultValue"),filterable:""},on:{change:function(a){return e.changeApp(t.$index,t.row.application)}},model:{value:t.row.application,callback:function(a){e.$set(t.row,"application",a)},expression:"scope.row.application"}},e._l(e.appList,(function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1)]}}],null,!1,3541109157)}),a("el-table-column",{attrs:{label:e.$t("filter.title.serverName")},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:e.$t("pub.dlg.defaultValue"),clearable:"",filterable:""},model:{value:t.row.serverName,callback:function(a){e.$set(t.row,"serverName",a)},expression:"scope.row.serverName"}},e._l(t.row.serverNames,(function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),1)]}}],null,!1,695734775)}),a("el-table-column",{attrs:{label:e.$t("operate.operates"),width:"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-table-operation",{on:{click:function(a){return e.addAbilityTag(t.$index,e.abilityTagDialog.model.abilityArr)}}},[e._v(" "+e._s(e.$t("operate.add"))+" ")]),a("let-table-operation",{on:{click:function(a){return e.delAbilityTag(t.$index,e.abilityTagDialog.model.abilityArr)}}},[e._v(" "+e._s(e.$t("operate.delete"))+" ")])]}}],null,!1,2609683168)})],2)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.closeAbilityTagDialog}},[e._v(e._s(e.$t("common.cancel")))]),a("el-button",{attrs:{type:"primary"},on:{click:e.saveAbilityTag}},[e._v(e._s(e.$t("common.submit")))])],1)],1)],e.showDetail?a("node-detail",{attrs:{nodeDetail:e.nodeDetail},on:{closeDetail:e.closeDetail}}):e._e()],2)},za=[],Va=(a("2ca0"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",[a("span",{staticClass:"title"},[e._v(e._s(e.nodeDetail.NodeName))]),a("span",{staticStyle:{"margin-left":"10px"}},["Active"==e.nodeDetail.status?a("el-tag",{attrs:{effect:"plain",type:"success"}},[e._v(" "+e._s(e.nodeDetail.status)+" ")]):e._e(),"Unavailable"==e.nodeDetail.status?a("el-tag",{attrs:{effect:"plain",type:"danger"}},[e._v(" "+e._s(e.nodeDetail.status)+" ")]):e._e()],1),a("span",{staticStyle:{float:"right"}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-back",size:"small"},on:{click:e.closeDetail}})],1)]),a("div",{staticStyle:{"margin-top":"10px"}},[a("span",[e._v("Age:"+e._s(e.getAge(e.nodeDetail.CreationTimestamp)))])]),a("el-divider"),a("div",[e._l(e.nodeDetail.NodeAddress,(function(t){return a("span",{staticClass:"item"},[e._v(e._s(t.type+":"+t.address))])})),a("span",{staticClass:"item"},[e._v("Version:"+e._s(e.nodeDetail.NodInfo.kernelVersion))]),a("span",{staticClass:"item"},[e._v("OS:"+e._s(e.nodeDetail.NodInfo.osImage))]),a("span",{staticClass:"item"},[e._v("containerRuntimeVersion:"+e._s(e.nodeDetail.NodInfo.containerRuntimeVersion))])],2),a("div",{staticStyle:{"margin-top":"10px"}},[e._v(" Labels: "),e._l(e.nodeDetail.Labels,(function(t,r){return a("el-tag",{key:r,staticStyle:{margin:"2px 2px"},attrs:{effect:"plain",type:e._f("tagType")(r)}},[e._v(" "+e._s(r+":"+t)+" ")])}))],2),a("el-divider"),a("div",{staticStyle:{"margin-top":"10px"}},[e._v(" Conditions: "),e._l(e.nodeDetail.Conditions,(function(t){return a("el-tooltip",{key:t.type,attrs:{placement:"top"}},[a("div",{attrs:{slot:"content"},slot:"content"},e._l(t,(function(t,r){return a("p",{key:r,staticStyle:{margin:"4px 0","font-size":"12px"}},[e._v(" "+e._s(r+":"+t)+" ")])})),0),a("el-tag",{staticStyle:{margin:"2px 15px"},attrs:{effect:"dark",type:e._f("conditionsStatus")(t)}},[e._v(" "+e._s(t.type)+" ")])],1)})),a("el-row",{staticStyle:{"margin-top":"20px"},attrs:{gutter:20}},[a("el-col",{attrs:{span:8}},[a("el-card",{attrs:{shadow:"never"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",{staticStyle:{"font-weight":"bold"}},[e._v("CPU")]),a("span",{staticStyle:{float:"right"}},[e._v("0 of 4")])]),a("el-progress",{attrs:{"text-inside":!0,"stroke-width":20,percentage:1}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-card",{attrs:{shadow:"never"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",{staticStyle:{"font-weight":"bold"}},[e._v("MEMORY")]),a("span",{staticStyle:{float:"right"}},[e._v("0 of 7.78 GiB ")])]),a("el-progress",{attrs:{"text-inside":!0,"stroke-width":20,percentage:1}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-card",{attrs:{shadow:"never"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",{staticStyle:{"font-weight":"bold"}},[e._v("PODS")]),a("span",{staticStyle:{float:"right"}},[e._v("8 of 110")])]),a("el-progress",{attrs:{"text-inside":!0,"stroke-width":20,percentage:7.3}})],1)],1)],1)],2),a("el-divider"),a("el-tabs",{attrs:{type:"border-card"}},[a("el-tab-pane",{attrs:{label:"Info"}},[a("el-form",{attrs:{"label-width":"300px","label-position":"left"}},e._l(e.nodeDetail.NodInfo,(function(t,r){return a("div",{key:r},[a("el-form-item",{attrs:{label:r}},[e._v(" "+e._s(t)+" ")])],1)})),0)],1),a("el-tab-pane",{attrs:{label:"Images"}},[a("el-table",{ref:"table",attrs:{data:e.nodeDetail.Images,border:"",stripe:"","highlight-current-row":"",height:"400px"}},[a("el-table-column",{attrs:{label:"names"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.names,(function(t){return a("p",{key:t},[e._v(" "+e._s(t)+" ")])}))}}])}),a("el-table-column",{attrs:{label:"size",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(Math.ceil(t.row.sizeBytes/1024/1024)+"M")+" ")]}}])})],1)],1),a("el-tab-pane",{attrs:{label:"Taints"}},[a("el-table",{ref:"table",attrs:{data:e.nodeDetail.Taints,border:"",stripe:"","highlight-current-row":"",height:"400px"}},[a("el-table-column",{attrs:{label:"effect",prop:"effect",width:"300"}}),a("el-table-column",{attrs:{label:"key",prop:"key"}})],1)],1),a("el-tab-pane",{attrs:{label:"Conditions"}},[a("el-table",{ref:"table",attrs:{data:e.nodeDetail.Conditions,border:"",stripe:"","highlight-current-row":"",height:"400px"}},[a("el-table-column",{attrs:{label:"type",prop:"type",width:"150"}}),a("el-table-column",{attrs:{label:"status",prop:"status",width:"80"}}),a("el-table-column",{attrs:{label:"message",prop:"message"}}),a("el-table-column",{attrs:{label:"reason",prop:"reason"}}),a("el-table-column",{attrs:{label:"lastTransitionTime",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e._f("timeFormat")(t.row.lastTransitionTime)))]}}])}),a("el-table-column",{attrs:{label:"lastHeartbeatTime",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e._f("timeFormat")(t.row.lastHeartbeatTime)))]}}])})],1)],1)],1)],1)}),Ra=[],Ea={name:"node-detail",props:["nodeDetail"],filters:{tagType:function(e){return e.startsWith("tars.io/node")?"warning":e.startsWith("tars.io/ability")?"success":""},conditionsStatus:function(e){return"False"==e.status?"danger":"success"},timeFormat:function(e){return E()(e).format("YYYY-MM-DD HH:mm:ss")}},methods:{closeDetail:function(){this.$emit("closeDetail")},getAge:function(e){var t=Math.ceil((new Date-new Date(e))/36e5),a=0,r=0;return t>=24&&(a=Math.ceil(t/24),r=t%24),"".concat(a,"d").concat(r>0?r+"h":"")}}},Ba=Ea,Ha=(a("f333"),Object(w["a"])(Ba,Va,Ra,!1,null,"38a1db4e",null)),Fa=Ha.exports,Ja={name:"BaseBusiness",components:{nodeDetail:Fa},data:function(){return{multipleSelection:[],query:{NodeName:""},items:[],pagination:{page:1,size:10,total:1},commonTagDialog:{flag:"one",show:!1,model:{}},abilityTagDialog:{flag:"one",show:!1,model:{}},appList:[],serList:[],showDetail:!1,nodeDetail:{}}},filters:{tagType:function(e){return e.startsWith("taf.io/node")?"warning":""},abilityType:function(e){return-1!=e.indexOf(".")?"success":""}},computed:{batchEnabled:function(){return this.multipleSelection.length>0}},mounted:function(){this.fetchData(),this.getAppList()},methods:{handleSelectionChange:function(e){this.multipleSelection=e},gotoPage:function(e){this.pagination.page=e,this.getServerList()},fetchData:function(){var e=this;return this.$ajax.getJSON("/k8s/api/node_select",Object.assign(this.query,{page:this.pagination.page,size:this.pagination.size})).then((function(t){t.Data.forEach((function(e){var t="";e.Conditions.forEach((function(e){"Ready"==e.Type&&(t=e.status)})),e.status="False"==t?"Unavailable":"Active"})),e.items=t.Data,e.pagination.total=Math.ceil(t.Count.AllCount/e.pagination.size)})).catch((function(t){e.$tip.error("".concat(e.$t("common.error"),": ").concat(t.message||t.err_msg))}))},search:function(){this.pagination.page=1,this.fetchData()},editCommonTag:function(e){for(var t in this.commonTagDialog.show=!0,this.commonTagDialog.flag="one",this.commonTagDialog.model=Ot.a.cloneDeep(e),this.commonTagDialog.model.commonArr=[],e.Labels)t.startsWith("taf.io/node")||t.startsWith("taf.io/ability")||this.commonTagDialog.model.commonArr.push({name:t,value:e.Labels[t]})},batchEditCommon:function(){1==this.multipleSelection.length?this.editCommonTag(this.multipleSelection[0]):(this.commonTagDialog.show=!0,this.commonTagDialog.flag="batch",this.commonTagDialog.model.nodes=this.multipleSelection,this.commonTagDialog.model.commonArr=[{name:"",value:""}])},saveCommonTag:function(){var e=this;if(this.validate(this.$refs.commonForm)){var t=[];this.commonTagDialog.model.nodes&&(t=this.commonTagDialog.model.nodes.map((function(e){return e.NodeName})));var a="",r={};"one"==this.commonTagDialog.flag?(a="/k8s/api/edit_common_tag",r={nodeName:this.commonTagDialog.model.NodeName,tags:this.commonTagDialog.model.commonArr}):(a="/k8s/api/batch_edit_common_tag",r={nodeNames:t,tags:this.commonTagDialog.model.commonArr}),this.$ajax.postJSON(a,r).then((function(){e.$message.success("".concat(e.$t("common.success"))),e.closeCommonTagDialog(),e.fetchData()})).catch((function(t){e.$message.error("".concat(e.$t("common.error"),": ").concat(t.message||t.err_msg))}))}},closeCommonTagDialog:function(){this.commonTagDialog={flag:"one",show:!1,model:{}}},editAbilityTag:function(e){var t=this;return Object(j["a"])(regeneratorRuntime.mark((function a(){var r,o,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:t.abilityTagDialog.show=!0,t.abilityTagDialog.flag="one",t.abilityTagDialog.model=Ot.a.cloneDeep(e),t.abilityTagDialog.model.abilityArr=[],r=Object(Y["a"])(e.NodeAbility),a.prev=5,r.s();case 7:if((o=r.n()).done){a.next=19;break}return i=o.value,a.t0=t.abilityTagDialog.model.abilityArr,a.t1=i.split(".")[0],a.t2=i.split(".")[1]||"",a.next=14,t.getServerList(i.split(".")[0]);case 14:a.t3=a.sent,a.t4={application:a.t1,serverName:a.t2,serverNames:a.t3},a.t0.push.call(a.t0,a.t4);case 17:a.next=7;break;case 19:a.next=24;break;case 21:a.prev=21,a.t5=a["catch"](5),r.e(a.t5);case 24:return a.prev=24,r.f(),a.finish(24);case 27:case"end":return a.stop()}}),a,null,[[5,21,24,27]])})))()},batchEditAffinity:function(){var e=this;return Object(j["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(1!=e.multipleSelection.length){t.next=5;break}return t.next=3,e.editCommonTag(e.multipleSelection[0]);case 3:t.next=9;break;case 5:e.abilityTagDialog.show=!0,e.abilityTagDialog.flag="batch",e.abilityTagDialog.model.nodes=e.multipleSelection,e.abilityTagDialog.model.abilityArr=[{application:"",serverName:"",serverNames:""}];case 9:case"end":return t.stop()}}),t)})))()},saveAbilityTag:function(){var e=this;if(this.validate(this.$refs.abilityForm)){var t=[];this.abilityTagDialog.model.nodes&&(t=this.abilityTagDialog.model.nodes.map((function(e){return e.NodeName})));var a=this.abilityTagDialog.model.abilityArr.map((function(e){return{application:e.application,serverName:e.serverName}})),r="",o={};"one"==this.abilityTagDialog.flag?(r="/k8s/api/edit_ability_tag",o={nodeName:this.abilityTagDialog.model.NodeName,tags:a}):(r="/k8s/api/batch_edit_ability_tag",o={nodeNames:t,tags:a}),this.$ajax.postJSON(r,o).then((function(){e.$message.success("".concat(e.$t("common.success"))),e.closeAbilityTagDialog(),e.fetchData()})).catch((function(t){e.$message.error("".concat(e.$t("common.error"),": ").concat(t.message||t.err_msg))}))}},closeAbilityTagDialog:function(){this.abilityTagDialog={flag:"one",show:!1,model:{}}},validate:function(e){var t=!0;return e.validate((function(e){e||(t=!1)})),t},viewItem:function(e){this.showDetail=!0,this.nodeDetail=Ot.a.cloneDeep(e)},closeDetail:function(){this.showDetail=!1,this.fetchData()},changeStatus:function(e){if(e.NodePublic){if(e.Labels.hasOwnProperty("node-role.kubernetes.io/master"))return void this.fetchData();this.addTafTag(e.NodeName)}else this.delTafTag(e.NodeName)},addTafTag:function(e){var t=this;this.$ajax.postJSON("/k8s/api/taf_ability_open",{NodeName:e}).then((function(){t.$tip.success(t.$t("common.success")),t.fetchData()})).catch((function(e){t.$tip.error("".concat(t.$t("common.error"),": ").concat(e.message||e.err_msg))}))},delTafTag:function(e){var t=this;this.$ajax.postJSON("/k8s/api/taf_ability_close",{NodeName:e}).then((function(){t.$tip.success(t.$t("common.success")),t.fetchData()})).catch((function(e){t.$tip.error("".concat(t.$t("common.error"),": ").concat(e.message||e.err_msg))}))},getAppList:function(){var e=this;this.$ajax.getJSON("/k8s/api/application_select",{}).then((function(t){e.appList=t.Data.map((function(e){return e.ServerApp}))})).catch((function(t){e.$tip.error("".concat(e.$t("common.error"),": ").concat(t.message||t.err_msg))}))},getServerList:function(e){var t=this;return Object(j["a"])(regeneratorRuntime.mark((function a(){var r,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.$ajax.getJSON("/k8s/api/server_list",{ServerApp:e,isAll:!0});case 2:return r=a.sent,o=r.Data.map((function(e){return e.ServerName})),a.abrupt("return",o);case 5:case"end":return a.stop()}}),a)})))()},changeApp:function(e,t){var a=this;return Object(j["a"])(regeneratorRuntime.mark((function r(){var o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,a.getServerList(t);case 2:o=r.sent,a.$set(a.abilityTagDialog.model.abilityArr[e],"serverNames",o);case 4:case"end":return r.stop()}}),r)})))()},queryAppChange:function(){var e=this;return Object(j["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getServerList(e.query.ServerApp);case 2:a=t.sent,e.$set(e.query,"ServerName",""),e.serList=a;case 5:case"end":return t.stop()}}),t)})))()},addCommonTag:function(e,t){t.splice(e+1,0,{name:"",value:""}),this.$forceUpdate()},delCommonTag:function(e,t){t.splice(e,1),this.$forceUpdate()},addAbilityTag:function(e,t){t.splice(e+1,0,{application:"",serverName:"",serverNames:[]}),this.$forceUpdate()},delAbilityTag:function(e,t){t.splice(e,1),this.$forceUpdate()},validateTagName:function(e,t,a,r){""===r?a(new Error("".concat(this.$t("filter.tip.notNull")))):r.toLowerCase().startsWith("taf.io")?a(new Error("".concat(this.$t("filter.tip.notTaf")))):a()},validateAppName:function(e,t,a,r){""===r?a(new Error("".concat(this.$t("filter.tip.application")))):a()}}},Ya=Ja,Ua=(a("e81f"),a("cdeb"),Object(w["a"])(Ya,ja,za,!1,null,"78a7d013",null)),Ka=Ua.exports,Wa=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("let-form",{attrs:{inline:"",itemWidth:"180px"},nativeOn:{submit:function(t){return t.preventDefault(),e.search(t)}}},[a("let-form-item",{staticStyle:{width:"400px"},attrs:{label:e.$t("callChain.date")}},[a("el-date-picker",{attrs:{size:"small",type:"datetimerange","range-separator":"~","start-placeholder":e.$t("board.alarm.form.startDate"),"end-placeholder":e.$t("board.alarm.form.endDate"),"value-format":"timestamp"},model:{value:e.eventDate,callback:function(t){e.eventDate=t},expression:"eventDate"}})],1),a("let-form-item",{attrs:{label:e.$t("filter.title.app")}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:e.$t("pub.dlg.defaultValue"),size:"small",disabled:!e.serverEnable,clearable:""},on:{change:function(t){return e.getServerList(e.query.application)}},model:{value:e.query.application,callback:function(t){e.$set(e.query,"application",t)},expression:"query.application"}},e._l(e.appList,(function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),a("let-form-item",{attrs:{label:e.$t("filter.title.serverName")}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:e.$t("pub.dlg.defaultValue"),clearable:"",disabled:!e.serverEnable,size:"small"},on:{change:e.getPods},model:{value:e.query.serverName,callback:function(t){e.$set(e.query,"serverName",t)},expression:"query.serverName"}},e._l(e.serverNames,(function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),a("let-form-item",{attrs:{label:e.$t("serverList.table.th.podName")}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:e.$t("pub.dlg.defaultValue"),clearable:"",disabled:!e.serverEnable,size:"small"},on:{change:e.search},model:{value:e.query.pod,callback:function(t){e.$set(e.query,"pod",t)},expression:"query.pod"}},e._l(e.pods,(function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),a("let-form-item",{attrs:{label:e.$t("event.eventLevel")}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:e.$t("pub.dlg.defaultValue"),clearable:"",size:"small"},on:{change:e.search},model:{value:e.query.level,callback:function(t){e.$set(e.query,"level",t)},expression:"query.level"}},e._l(e.levels,(function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),a("let-form-item",{staticStyle:{width:"240px"}},[a("el-radio-group",{attrs:{size:"small"},on:{change:e.checkedChange},model:{value:e.query.check,callback:function(t){e.$set(e.query,"check",t)},expression:"query.check"}},[a("el-radio-button",{attrs:{label:"Server"}},[e._v(e._s(e.$t("event.type.server")))]),a("el-radio-button",{attrs:{label:"Cluster"}},[e._v(e._s(e.$t("event.type.cluster")))]),a("el-radio-button",{attrs:{label:"Downtime"}},[e._v(e._s(e.$t("event.type.downtime")))])],1)],1),a("let-form-item",[a("let-button",{attrs:{size:"small",theme:"primary"},on:{click:e.search}},[e._v(e._s(e.$t("operate.search")))])],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"table",attrs:{data:e.events,border:"",stripe:"","highlight-current-row":""}},[a("el-table-column",{attrs:{label:"kind",width:"200","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.involvedObject.kind||""))]}}])}),a("el-table-column",{attrs:{label:"namespace",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.involvedObject.namespace||""))]}}])}),a("el-table-column",{attrs:{label:"name",width:"200","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.involvedObject.name||""))]}}])}),a("el-table-column",{attrs:{label:"type",prop:"type",width:"150"}}),a("el-table-column",{attrs:{label:"reason",prop:"reason",width:"200"}}),a("el-table-column",{attrs:{label:"message",prop:"message","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{label:"firstTime",width:"180","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e._f("timeFormat")(t.row.firstTimestamp)))]}}])}),a("el-table-column",{attrs:{label:"lastTime",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e._f("timeFormat")(t.row.lastTimestamp)))]}}])})],1),a("br"),a("let-pagination",{staticStyle:{float:"right"},attrs:{align:"right",page:e.pagination.page,total:e.pagination.total},on:{change:e.handleCurrentChange}})],1)},Za=[],Ga=(a("841c"),{name:"event",data:function(){return{query:{application:"",serverName:"",check:"Server"},eventDate:[new Date((new Date).getTime()-72e5).getTime(),(new Date).getTime()],appList:[],serverNames:[],pods:[],levels:["Normal","Warning"],loading:!1,pagination:{page:1,size:20,total:1},events:[]}},filters:{timeFormat:function(e){return E()(e).format("YYYY-MM-DD HH:mm:ss")}},watch:{$route:function(e,t){this.$set(this.query,"application",this.$route.query.application||""),this.$set(this.query,"serverName",this.$route.query.serverName||""),this.search()}},mounted:function(){this.$set(this.query,"application",this.$route.query.application||""),this.$set(this.query,"serverName",this.$route.query.serverName||""),this.getAppList(),this.search()},computed:{serverEnable:function(){return"Server"==this.query.check}},methods:{checkedChange:function(){this.pagination.page=1,this.loadData(1)},handleCurrentChange:function(e){this.loadData(e)},search:function(){this.loadData(1)},loadData:function(e){var t=this;e||(e=1);var a="",r="";this.eventDate&&(a=this.eventDate[0],r=this.eventDate[1]);var o=Object.assign({},this.query,{currPage:e,pageSize:this.pagination.size},{startDate:a,endDate:r});this.loading=!0,this.$ajax.getJSON("/k8s/api/get_events",o).then((function(e){t.events=e.rows,t.pagination.total=e.total,t.loading=!1})).catch((function(e){t.loading=!1,t.$tip.error("".concat(t.$t("common.error"),": ").concat(e.message||e.err_msg))}))},getAppList:function(){var e=this;this.$ajax.getJSON("/k8s/api/application_select",{}).then((function(t){e.appList=t.Data.map((function(e){return e.ServerApp}))})).catch((function(t){e.$tip.error("".concat(e.$t("common.error"),": ").concat(t.message||t.err_msg))}))},getServerList:function(e){var t=this;return Object(j["a"])(regeneratorRuntime.mark((function a(){var r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.$set(t.query,"serverName",""),a.next=3,t.$ajax.getJSON("/k8s/api/server_list",{ServerApp:e,isAll:!0});case 3:r=a.sent,t.serverNames=r.Data.map((function(e){return e.ServerName})),t.search();case 6:case"end":return a.stop()}}),a)})))()},getPods:function(){var e=this;this.$set(this.query,"pod","");var t="",a="";this.eventDate&&(t=this.eventDate[0],a=this.eventDate[1]);var r=Object.assign({},this.query,{startDate:t,endDate:a});this.$ajax.getJSON("/k8s/api/get_pods",r).then((function(t){e.pods=t,e.search()})).catch((function(t){e.$set(e,"pods","")})),this.search()}}}),Qa=Ga,Xa=Object(w["a"])(Qa,Wa,Za,!1,null,"5419c7a2",null),er=Xa.exports,tr=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page_framework_config"},[[a("el-button",{staticStyle:{width:"100px",margin:"10px 0 5px 0",float:"right"},attrs:{size:"mini",type:"primary"},on:{click:e.showYaml}},[e._v(e._s(e.$t("operate.yaml"))+" ")]),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.config,stripe:"",border:""}},[a("el-table-column",{attrs:{prop:"column",label:"key",width:"300"}}),a("el-table-column",{attrs:{prop:"remark",label:"remark",width:"300"}}),a("el-table-column",{attrs:{label:"value"},scopedSlots:e._u([{key:"default",fn:function(t){return["nodeImage.image"==t.row.column?a("el-select",{staticStyle:{width:"100%"},attrs:{size:"small"},model:{value:t.row.value,callback:function(a){e.$set(t.row,"value",a)},expression:"scope.row.value"}},e._l(e.nodeList,(function(t){return a("el-option",{key:t.Image,attrs:{value:t.Image}},[a("span",[e._v(e._s(t.Image))])])})),1):a("el-input",{attrs:{type:"textarea",autosize:{minRows:1,maxRows:8},placeholder:"请输入内容"},model:{value:t.row.value,callback:function(a){e.$set(t.row,"value",a)},expression:"scope.row.value"}})]}}])}),a("el-table-column",{attrs:{label:e.$t("operate.operates"),width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-table-operation",{on:{click:function(a){return e.saveTfcItem(t.row)}}},[e._v(" "+e._s(e.$t("operate.save"))+" ")])]}}])})],1),a("el-dialog",{attrs:{title:"Framework config",width:"50%",top:"50px",visible:e.showDialog,"before-close":e.closeDialog,"close-on-click-modal":!1},on:{"update:visible":function(t){e.showDialog=t}}},[a("k8s-yaml-edit",{ref:"yamlEdit",on:{successFun:e.closeDialog}})],1)]],2)},ar=[],rr={name:"frameworkConfig",data:function(){return{showDialog:!1,config:[],nodeList:[]}},components:{K8sYamlEdit:Pe},mounted:function(){this.getTfc(),this.getTafNodeList()},methods:{getTfc:function(){var e=this;this.$ajax.getJSON("/k8s/api/get_tfc").then((function(t){e.config=t})).catch((function(t){e.$tip.error("".concat(e.$t("common.error"),": ").concat(t.message||t.err_msg))}))},getTafNodeList:function(){var e=this;this.$ajax.getJSON("/k8s/api/image_node_select").then((function(t){e.nodeList=t.Data}))},saveTfcItem:function(e){var t=this;this.$ajax.postJSON("/k8s/api/save_tfc_item",e).then((function(e){t.$message.success("".concat(t.$t("common.success")))})).catch((function(e){t.$tip.error("".concat(t.$t("common.error"),": ").concat(e.message||e.err_msg))}))},showYaml:function(){var e=this;this.showDialog=!0,this.$nextTick((function(){e.$refs.yamlEdit.show("111","tframeworkconfigs"),e.$refs.yamlEdit.refresh()}))},closeDialog:function(){this.showDialog=!1,this.getTfc()}}},or=rr,ir=(a("2562"),Object(w["a"])(or,tr,ar,!1,null,"3e5fdd24",null)),sr=ir.exports,lr=a("e3f3"),nr=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("router-view",{ref:"childView"})},cr=[],dr={name:"Index",data:function(){return{}},watch:{$route:function(e,t){"/market"==e.path&&this.checkLogin()}},methods:{onLogin:function(e){e&&this.$store.commit({type:"marketUid",uid:window.localStorage.uid}),e||location.hash.startsWith("#/market/user")?e&&"#/market"==location.hash&&this.$router.push("/market/list"):this.$router.push("/market/user/login")},checkLogin:function(){var e=this,t=window.localStorage.ticket;t?this.$market.call("cloud-user","isLogin",{ticket:t}).then((function(t){t.uid?(window.localStorage.uid=t.uid,e.onLogin(!0)):e.onLogin(!1)})).catch((function(t){e.$message({message:t,type:"error"})})):this.onLogin(!1)}},mounted:function(){this.checkLogin()}},ur=dr,pr=Object(w["a"])(ur,nr,cr,!1,null,null,null),mr=pr.exports,fr=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page_server"},[a("div",{staticClass:"left-view"},[a("div",[a("span",[a("el-input",{staticStyle:{width:"80%"},attrs:{size:"small",placeholder:e.$t("home.placeholder")},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.filterTextChange(t)}},model:{value:e.treeSearchKey,callback:function(t){e.treeSearchKey=t},expression:"treeSearchKey"}}),e._v(" "),a("i",{staticClass:"iconfont el-icon-third-shuaxin",class:{active:e.isIconPlay},staticStyle:{cursor:"pointer","font-family":"iconfont  !important","z-index":"99"},on:{click:e.treeSearch}})],1),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.serviceList,stripe:"","show-header":!1},on:{"row-click":e.selectService}},[a("el-table-column",{attrs:{label:e.$t("market.table.version")},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:4}},[a("el-avatar",{attrs:{size:30,src:t.row.logo}})],1),a("el-col",{attrs:{span:20}},[a("span",[a("span",[e._v(e._s(t.row.group+"/"+t.row.name))]),a("span",{staticClass:"overflow"},[e._v(e._s(t.row.description))])])])],1)]}}])})],1)],1)]),a("div",{staticClass:"right-view"},[a("router-view",{ref:"childView"})],1)])},hr=[],vr={name:"Market",data:function(){return{uid:"",treeErrMsg:"load failed",treeData:null,treeSearchKey:"",isIconPlay:!1,serviceList:[],group:"",name:"",version:"",total:0,offset:0,limit:20}},methods:{iconLoading:function(){var e=this;e.isIconPlay||(e.isIconPlay=!0,setTimeout((function(){e.isIconPlay=!1}),1e3))},treeSearch:function(){this.iconLoading(),this.fetchServiceData()},selectService:function(e,t,a){this.group=e.group,this.name=e.name,this.version=e.version,this.$router.push("/market/service/"+this.group+"/"+this.name+"/"+this.version)},fetchServiceData:function(){var e=this;this.$market.call("cloud-market","getServiceBaseList",{req:{offset:this.offset,limit:this.limit}}).then((function(t){e.serviceList=t.rsp.services,e.serviceList.forEach((function(e){e.create_time=E()(e.create_time).format("YYYY-MM-DD HH:mm:ss"),e.update_time=E()(e.update_time).format("YYYY-MM-DD HH:mm:ss"),e.logo=e.prefix+e.logo+"?t="+e.update_time})),e.total=t.rsp.total})).catch((function(t){e.$message({message:t,type:"error"})}))},onLogin:function(e){e?(this.uid=window.localStorage.uid,this.$store.commit({type:"marketUid",uid:this.uid}),this.fetchServiceData()):this.$router.push("/market/user/login")},checkLogin:function(){var e=this,t=window.localStorage.ticket;t?this.$market.call("cloud-user","isLogin",{ticket:t}).then((function(t){t.uid?(window.localStorage.uid=t.uid,e.onLogin(!0)):e.onLogin(!1)})).catch((function(t){e.$message({message:t,type:"error"})})):this.onLogin(!1)}},created:function(){},mounted:function(){this.checkLogin()}},gr=vr,br=(a("c2e9"),Object(w["a"])(gr,fr,hr,!1,null,null,null)),$r=br.exports,kr=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"list"},[e._l(e.row,(function(t){return a("el-row",{key:t,staticStyle:{"padding-bottom":"10px"},attrs:{gutter:24}},e._l(e.column,(function(r){return a("el-col",{key:r,attrs:{span:24/e.column}},[e.valid(t,r)?a("el-card",{staticClass:"box-card",attrs:{"body-style":{padding:"0px"}}},[a("div",{staticStyle:{"line-height":"25px",position:"relative"},attrs:{slot:"header"},slot:"header"},[a("el-avatar",{attrs:{size:25,src:e.getServerLogo(t,r)}}),a("span",{staticStyle:{"margin-left":"5px",position:"absolute"}},[e._v(e._s(e.getServerName(t,r)))]),a("el-popover",{staticStyle:{float:"right"},attrs:{placement:"bottom"},model:{value:e.isVisible[t+"_"+r],callback:function(a){e.$set(e.isVisible,t+"_"+r,a)},expression:"isVisible[i + '_' + j]"}},[e._v(" 版本列表: "),e.serviceVersion?a("el-select",{staticClass:"pop",staticStyle:{width:"100px"},model:{value:e.version,callback:function(t){e.version=t},expression:"version"}},e._l(e.versions,(function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),1):e._e(),a("el-button",{staticStyle:{"line-height":"25px",padding:"0px 10px 0 10px"},attrs:{size:"small"},on:{click:function(a){return e.changeVersion(t,r)}}},[e._v("切换")]),e.isUpgrade(t,r)?a("el-badge",{staticClass:"item",attrs:{slot:"reference","is-dot":""},slot:"reference"},[a("el-button",{staticStyle:{"line-height":"25px",padding:"0px 10px 0 10px"},attrs:{size:"small"},on:{click:function(a){return e.fetchVersionListData(t,r)}}},[e._v("切换版本")])],1):a("el-button",{staticStyle:{"line-height":"25px",padding:"0px 10px 0 10px"},attrs:{slot:"reference",size:"small"},on:{click:function(a){return e.fetchVersionListData(t,r)}},slot:"reference"},[e._v("切换版本")])],1)],1),a("div",{attrs:{slot:"header"},slot:"header"},[a("el-button",{attrs:{type:"text"},on:{click:function(a){e.goService(e.getCloudServerName(t,r))}}},[e._v(e._s(e.getCloudServerName(t,r)))]),a("br"),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.getDigest(t,r),placement:"top-start"}},[a("span",{staticStyle:{"font-size":"10px"}},[e._v(e._s(e.getDigest(t,r,10)))])])],1)]):e._e()],1)})),1)})),e.upgradeServiceVersion?a("upgrade",{ref:"upgrade",attrs:{serviceVersion:e.upgradeServiceVersion},on:{upgradeSucc:e.upgradeSucc}}):e._e()],2)},yr=[],Sr=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:"升级",visible:e.dialogVisible,width:"70%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-alert",{staticStyle:{margin:"5px 0 5px 0"},attrs:{title:"版本切换不会变更配置文件, 如有需要请自己变更配置",type:"error"}}),a("el-alert",{staticStyle:{margin:"5px 0 5px 0"},attrs:{title:"版本切换不会变更服务模板, 如有需要请自己变更服务模板",type:"error"}}),a("yaml-editor",{ref:"yamlEdit",staticStyle:{margin:"1px",height:"70%"},model:{value:e.deploy,callback:function(t){e.deploy=t},expression:"deploy"}}),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.doUpgrade}},[e._v("切换版本")])],1)],1)],1)},_r=[],wr=a("7ad2"),Mr=a("e2c1"),xr={name:"Upgrade",components:{YamlEditor:Te},props:["serviceVersion"],data:function(){return{dialogVisible:!1,deploy:""}},methods:{show:function(){this.dialogVisible=!0,this.fetchDeploy()},doGet:function(e,t,a){var r=this;this.$ajax.postJSON("/market/api/get",{app:e,server:t}).then((function(e){a(e)})).catch((function(e){r.$message({message:"".concat(r.$t("common.error"),": ").concat(e.message||e.err_msg),type:"error"})}))},doUpgrade:function(){var e=this;this.$ajax.postJSON("/market/api/upgrade",{deploy:this.deploy,serviceVersion:this.serviceVersion}).then((function(t){e.$message({message:"".concat(e.$t("common.success")),type:"success"}),e.dialogVisible=!1,e.$emit("upgradeSucc")})).catch((function(t){e.$message({message:"".concat(e.$t("common.error"),": ").concat(t.message||t.err_msg),type:"error"})}))},fetchDeploy:function(){var e=this;(new wr["a"]).getPlain(this.serviceVersion.deploy).then((function(t){t.ok&&t.text().then((function(t){var a=Mr["default"].load(t);delete a.cloud,delete a.config,delete a.appConfig,delete a.nodeConfig,a.repo.id="",a.app=e.serviceVersion.installData.group,a.server=e.serviceVersion.installData.name,e.doGet(a.app,a.server,(function(t){a.replicas=t.spec.k8s.replicas,a.hostNetwork=t.spec.k8s.hostNetwork,a.hostIPC=t.spec.k8s.hostIpc,a.hostPorts=t.spec.k8s.hostPorts||[],a.mounts=t.spec.k8s.mounts,a.nodeSelector=t.spec.k8s.nodeSelector,a.notStacked=t.spec.k8s.notStacked,a.abilityAffinity=t.spec.k8s.abilityAffinity,""==a.profile&&(a.profile=t.spec.tars.profile),a.asyncThread=t.spec.tars.asyncThread,a.template=t.spec.tars.template,t.spec.tars.servants.forEach((function(e){var t=a.servants.filter((function(t){return t.name==e.name}));t||a.servants.push(e)})),e.deploy=Mr["default"].dump(a)}))}))})).catch((function(t){e.$message({message:t,type:"error"})}))}},created:function(){},mounted:function(){}},Cr=xr,Nr=Object(w["a"])(Cr,Sr,_r,!1,null,null,null),Lr=Nr.exports,Tr={name:"List",components:{upgrade:Lr},data:function(){return{column:4,row:0,data:[],upgrade:{},isVisible:{},serviceVersion:null,upgradeServiceVersion:null,version:"",versions:[]}},methods:{valid:function(e,t){return(e-1)*this.column+t-1<this.data.length},get:function(e,t){var a=(e-1)*this.column+t-1;return this.data[a]},isUpgrade:function(e,t){var a=this.getUpgrade(this.get(e,t));return this.upgrade[a.group+"-"+a.name+"-"+a.version]},getServerLogo:function(e,t){return this.get(e,t)["tars.io/CloudLogo"]},getServerName:function(e,t){return this.get(e,t)["tars.io/ServerApp"]+"/"+this.get(e,t)["tars.io/ServerName"]},getCloudServerName:function(e,t){return this.get(e,t)["tars.io/CloudInstall"]},getDigest:function(e,t,a){return a?this.get(e,t)["tars.io/CloudDigest"].substr(0,a+7):this.get(e,t)["tars.io/CloudDigest"]},getUpgrade:function(e){var t=e["tars.io/CloudInstall"],a=t.indexOf("-"),r=t.substr(0,a),o=t.indexOf("-",a+1),i=t.substr(a+1,o-a-1),s=t.substr(o+1);return{group:r,name:i,version:s,digest:e["tars.io/CloudDigest"]}},goService:function(e){this.$router.push("/market/service/"+e.replace(/-/g,"/"))},fetchInstallFromCloud:function(){var e=this;this.$ajax.getJSON("/market/api/list_install_from_cloud").then((function(t){e.data=t,e.row=Math.ceil((e.data.length+1)/e.column),e.fetchCheckUpgrade()})).catch((function(t){e.$message({message:t.err_msg,type:"error"})}))},fetchServiceVersionData:function(e,t,a){var r=this,o=this.getUpgrade(this.get(e,t));this.$market.call("cloud-market","getServiceVersion",{req:{group:o.group,name:o.name,version:o.version}}).then((function(e){r.serviceVersion=null,r.$nextTick((function(){r.serviceVersion=e.rsp,r.version=r.serviceVersion.version,a&&a()}))})).catch((function(e){r.$message({message:e,type:"error"})}))},fetchVersionListData:function(e,t){var a=this;this.fetchServiceVersionData(e,t,(function(){var r=a.getUpgrade(a.get(e,t));a.$market.call("cloud-market","getServiceVersionList",{req:{group:r.group,name:r.name}}).then((function(r){a.versions=r.rsp.versions,a.isVisible[e+"_"+t]=!0})).catch((function(e){a.$message({message:e,type:"error"})}))}))},changeVersion:function(e,t){var a=this,r=this.getUpgrade(this.get(e,t));this.$market.call("cloud-market","getServiceVersion",{req:{group:r.group,name:r.name,version:this.version}}).then((function(r){a.upgradeServiceVersion=r.rsp,a.upgradeServiceVersion.logo=a.upgradeServiceVersion.prefix+a.upgradeServiceVersion.logo+"?t="+a.upgradeServiceVersion.update_time,a.upgradeServiceVersion.readme=a.upgradeServiceVersion.prefix+a.upgradeServiceVersion.readme+"?t="+a.upgradeServiceVersion.update_time,a.upgradeServiceVersion.deploy=a.upgradeServiceVersion.prefix+a.upgradeServiceVersion.deploy+"?t="+a.upgradeServiceVersion.update_time,a.upgradeServiceVersion.changelist=a.upgradeServiceVersion.prefix+a.upgradeServiceVersion.changelist+"?t="+a.upgradeServiceVersion.update_time,a.upgradeServiceVersion.create_time=E()(a.upgradeServiceVersion.create_time).format("YYYY-MM-DD"),a.upgradeServiceVersion.update_time=E()(a.upgradeServiceVersion.update_time).format("YYYY-MM-DD"),a.upgradeServiceVersion.installData={group:a.get(e,t)["tars.io/ServerApp"],name:a.get(e,t)["tars.io/ServerName"]},a.$nextTick((function(){a.$refs.upgrade.show()}))})).catch((function(e){a.$message({message:e,type:"error"})}))},upgradeSucc:function(){this.fetchInstallFromCloud()},fetchCheckUpgrade:function(){var e=this,t=[];this.data.forEach((function(a){var r=e.getUpgrade(a);t.push(r)})),this.$market.call("cloud-market","checkUpgrade",{req:{info:t}}).then((function(t){e.upgrade={},t.rsp.info.forEach((function(t){e.upgrade[t.group+"-"+t.name+"-"+t.version]=t.upgrade}))})).catch((function(t){e.$message({message:t,type:"error"})}))}},created:function(){},mounted:function(){this.fetchInstallFromCloud()}},Ir=Tr,Ar=(a("c2e92"),Object(w["a"])(Ir,kr,yr,!1,null,null,null)),Dr=Ar.exports,Pr=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-header",{staticClass:"header"},[e.serviceVersion?a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:3}},[a("el-avatar",{attrs:{size:100,src:e.serviceVersion.logo}})],1),a("el-col",{attrs:{span:21}},[a("span",[a("div",{staticStyle:{"margin-bottom":"5px"}},[a("span",{staticClass:"title"},[e._v(e._s(e.serviceVersion.name))]),a("el-select",{staticStyle:{width:"100px"},on:{"visible-change":e.visibleChange,change:e.change},model:{value:e.serviceVersion.version,callback:function(t){e.$set(e.serviceVersion,"version",t)},expression:"serviceVersion.version"}},e._l(e.versions,(function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),a("div",{staticStyle:{"margin-bottom":"5px"}},[a("span",{staticStyle:{"margin-bottom":"10px","margin-right":"10px"}},[a("el-tag",{staticStyle:{"margin-right":"5px"},attrs:{effect:"dark",size:"mini"}},[e._v("语言")]),a("el-tag",{attrs:{effect:"plain",type:"success",size:"mini"}},[e._v(e._s(e.serviceVersion.lang))])],1)]),a("div",{staticStyle:{"margin-bottom":"5px"}},[a("span",{staticStyle:{"margin-bottom":"10px","margin-right":"10px"}},[a("el-tag",{staticStyle:{"margin-right":"5px"},attrs:{effect:"dark",size:"mini"}},[e._v("贡献者")]),e._l(e.serviceVersion.collaborators.split(","),(function(t){return a("el-tag",{key:t,staticStyle:{"margin-right":"5px"},attrs:{effect:"plain",type:"success",size:"mini"}},[e._v(e._s(t))])}))],2)]),a("div",{staticStyle:{"margin-bottom":"5px"}},[a("span",{staticStyle:{"margin-bottom":"10px","margin-right":"10px"}},[a("el-tag",{staticStyle:{"margin-right":"5px"},attrs:{effect:"dark",type:"warning",size:"mini"}},[e._v("仓库")]),a("el-tag",{staticStyle:{cursor:"pointer"},attrs:{effect:"plain",type:"warning",size:"mini"},on:{click:function(t){return e.goRepository(e.serviceVersion.repository)}}},[e._v(e._s(e.serviceVersion.repository))])],1)]),a("div",{staticStyle:{"margin-bottom":"5px"}},[a("span",{staticStyle:{"margin-bottom":"10px","margin-right":"10px"}},[a("el-tag",{staticStyle:{"margin-right":"5px"},attrs:{effect:"dark",size:"mini",type:"danger"}},[e._v("创建")]),a("el-tag",{attrs:{effect:"plain",type:"danger",size:"mini"}},[e._v(e._s(e.serviceVersion.create_time))])],1),a("span",[a("el-tag",{staticStyle:{"margin-right":"5px"},attrs:{effect:"dark",size:"mini",type:"danger"}},[e._v("更新")]),a("el-tag",{attrs:{effect:"plain",type:"danger",size:"mini"}},[e._v(e._s(e.serviceVersion.update_time))])],1)]),a("span",{staticClass:"description"},[a("el-alert",{attrs:{title:e.serviceVersion.description,type:"info",closable:!1}})],1),a("el-tag",{staticStyle:{"margin-top":"10px",cursor:"pointer"},attrs:{type:"danger"},on:{click:e.showInstall}},[e._v("安装")])],1)])],1):e._e()],1),e.serviceVersion?a("el-main",[a("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"服务说明",name:"readme"}},[a("markdown",{attrs:{serviceVersion:e.serviceVersion,file:e.serviceVersion.readme}})],1),a("el-tab-pane",{attrs:{label:"部署文件",name:"deploy"}},[a("deploy",{attrs:{serviceVersion:e.serviceVersion}})],1),a("el-tab-pane",{attrs:{label:"协议文件",name:"protocols"}},[a("protocols",{attrs:{serviceVersion:e.serviceVersion}})],1),a("el-tab-pane",{attrs:{label:"变更历史",name:"changelist"}},[a("markdown",{attrs:{serviceVersion:e.serviceVersion,file:e.serviceVersion.changelist}})],1),a("el-tab-pane",{attrs:{label:"日志",name:"logs"}},[a("logs",{attrs:{serviceVersion:e.serviceVersion}})],1)],1)],1):e._e(),e.serviceVersion?a("install",{ref:"install",attrs:{serviceVersion:e.serviceVersion}}):e._e()],1)},Or=[],qr=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"markdown-body hljs",domProps:{innerHTML:e._s(e.html)}})},jr=[],zr=a("7c5c"),Vr=a("1487"),Rr=a.n(Vr);a("2876");zr["marked"].setOptions({renderer:new zr["marked"].Renderer,highlight:function(e,t){var a=Rr.a.getLanguage(t)?t:"plaintext";return Rr.a.highlight(e,{language:a}).value},langPrefix:"hljs language-",pedantic:!1,gfm:!0,breaks:!1,sanitize:!1,smartLists:!0,smartypants:!1,xhtml:!1});var Er=new wr["a"],Br={name:"Markdown",data:function(){return{html:""}},props:["serviceVersion","file"],methods:{markdownToHtml:function(e){this.html=zr["marked"].parse(e)},fetchReadme:function(){var e=this;Er.getPlain(this.file).then((function(t){t.ok&&t.text().then((function(t){e.markdownToHtml(t)}))})).catch((function(t){e.$message({message:t,type:"error"})}))}},created:function(){},mounted:function(){var e=this,t={link:function(e,t,a){var r="";return 0==e.indexOf("#")?r="<a href=\"javascript:document.getElementById('"+e.substring(1)+"').scrollIntoView();\"":0==e.indexOf("http://")||0==e.indexOf("https://")?r='<a target="_black" href="'+e+'"':(e="/#"+path.join(hrefPath,e),r='<a href="'+e+'"'),t&&(r+=' title="'+t+'"'),r+=">"+a+"</a>",r},image:function(t,a,r){0!=t.indexOf("/")&&(t=e.serviceVersion.prefix+t);var o='<div class="images" v-viewer><img src="'+t+'" alt="'+r+'"';return o+="> </div>",o}};zr["marked"].use({renderer:t}),e.fetchReadme()}},Hr=Br,Fr=(a("a462"),Object(w["a"])(Hr,qr,jr,!1,null,null,null)),Jr=Fr.exports,Yr=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("yaml-editor",{ref:"yamlEdit",staticStyle:{margin:"1px"},model:{value:e.data.deploy,callback:function(t){e.$set(e.data,"deploy",t)},expression:"data.deploy"}})],1)},Ur=[],Kr={name:"Deploy",components:{YamlEditor:Te},props:["serviceVersion"],data:function(){return{data:{deploy:""}}},methods:{fetchDeploy:function(){var e=this;(new wr["a"]).getPlain(this.serviceVersion.deploy).then((function(t){t.ok&&t.text().then((function(t){e.data.deploy=t}))})).catch((function(t){e.$message({message:t,type:"error"})}))}},created:function(){},mounted:function(){this.$refs.yamlEdit.readonly(),this.fetchDeploy()}},Wr=Kr,Zr=Object(w["a"])(Wr,Yr,Ur,!1,null,null,null),Gr=Zr.exports,Qr=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-tabs",{attrs:{type:"border-card"}},e._l(e.protocols,(function(t){return a("el-tab-pane",{key:t.name,attrs:{label:t.name}},[a("el-tag",{attrs:{type:"success"},on:{click:function(a){return e.download(t.name)}}},[e._v(e._s(e.$t("market.download")))]),a("br"),a("br"),a("div",{staticStyle:{border:"1px solid grey"}},[a("pre",{staticStyle:{margin:"5px 10px 10px 10px"},domProps:{innerHTML:e._s(t.content)}})])],1)})),1)],1)},Xr=[],eo={name:"Protocols",components:{},props:["serviceVersion"],data:function(){return{protocols:[]}},methods:{download:function(e){(new wr["a"]).download(this.serviceVersion.prefix+e)},fetchProtocol:function(){var e=this,t=function(t){(new wr["a"]).getPlain(e.serviceVersion.prefix+e.serviceVersion.protocols[t]).then((function(a){a.ok&&a.text().then((function(a){e.protocols.push({name:t,content:Rr.a.highlight(a,{language:"cpp"}).value})}))})).catch((function(t){e.$message({message:t,type:"error"})}))};for(var a in this.serviceVersion.protocols)t(a)}},created:function(){},mounted:function(){this.fetchProtocol()}},to=eo,ao=Object(w["a"])(to,Qr,Xr,!1,null,null,null),ro=ao.exports,oo=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:"安装",visible:e.dialogVisible,width:"70%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-alert",{staticStyle:{margin:"5px 0 5px 0"},attrs:{title:"请根据实际情况变更app/server",type:"error"}}),a("el-alert",{staticStyle:{margin:"5px 0 5px 0"},attrs:{title:"如果有配置文件, 请根据实际情况调整配置文件",type:"error"}}),a("el-alert",{staticStyle:{margin:"5px 0 5px 0"},attrs:{title:"请不要随意变更servants配置信息和镜像地址",type:"error"}}),a("el-alert",{staticStyle:{margin:"5px 0 5px 0"},attrs:{title:"为了顺利拉取镜像, 请在K8S集群中配置好仓库的secret: cloud-market-secret",type:"error"}}),a("yaml-editor",{ref:"yamlEdit",staticStyle:{margin:"1px",height:"70%"},model:{value:e.deploy,callback:function(t){e.deploy=t},expression:"deploy"}}),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.doInstall}},[e._v("安装")])],1)],1),e.upgradeServiceVersion?a("upgrade",{ref:"upgrade",attrs:{serviceVersion:e.upgradeServiceVersion},on:{upgradeSucc:e.upgradeSucc}}):e._e()],1)},io=[],so={name:"Install",components:{YamlEditor:Te,upgrade:Lr},props:["serviceVersion"],data:function(){return{dialogVisible:!1,upgradeServiceVersion:null,deploy:""}},methods:{showInstall:function(){this.dialogVisible=!0},upgradeSucc:function(){},doInstall:function(){var e=this;this.$confirm("确定安装该服务么?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.$ajax.postJSON("/market/api/install",{deploy:e.deploy,serviceVersion:e.serviceVersion}).then((function(t){e.$message({message:"".concat(e.$t("common.success")),type:"success"}),e.dialogVisible=!1})).catch((function(t){201==t.ret_code?e.$confirm("服务已经存在, 是否覆盖安装?","提示",{confirmButtonText:"覆盖安装",cancelButtonText:"取消",type:"warning"}).then((function(){e.dialogVisible=!1,e.upgradeServiceVersion=e.serviceVersion;var t=Mr["default"].load(e.deploy);e.upgradeServiceVersion.installData={group:t.app,name:t.server},e.$nextTick((function(){e.$refs.upgrade.show()}))})).catch():e.$message({message:"".concat(e.$t("common.error"),": ").concat(t.message||t.err_msg),type:"error"})}))})).catch((function(){}))},fetchDeploy:function(){var e=this;(new wr["a"]).getPlain(this.serviceVersion.deploy).then((function(t){t.ok&&t.text().then((function(t){var a=Mr["default"].load(t);delete a.cloud,a.repo.id="",e.deploy=Mr["default"].dump(a)}))})).catch((function(t){e.$message({message:t,type:"error"})}))}},created:function(){},mounted:function(){this.fetchDeploy()}},lo=so,no=Object(w["a"])(lo,oo,io,!1,null,null,null),co=no.exports,uo=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.logs,stripe:"","show-header":!1}},[a("el-table-column",{attrs:{label:e.$t("market.table.version")},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:24}},[a("span",[a("span",{style:e.getLogStyle(t.row.logLevel)},[e._v(e._s(t.row.text))])])])],1)]}}])})],1)},po=[],mo={name:"Logs",data:function(){return{logs:[]}},props:["serviceVersion"],methods:{getLogStyle:function(e){return 1==e?"color:green":2==e?"color:red":""},fetchLogs:function(){var e=this;this.$market.call("cloud-market","getServiceLogs",{req:{group:this.serviceVersion.group,name:this.serviceVersion.name,version:this.serviceVersion.version}}).then((function(t){e.logs=t.logs})).catch((function(t){e.$message({message:t,type:"error"})}))}},created:function(){},mounted:function(){this.fetchLogs()}},fo=mo,ho=(a("da9f"),Object(w["a"])(fo,uo,po,!1,null,null,null)),vo=ho.exports,go={name:"ServiceInfo",components:{markdown:Jr,deploy:Gr,protocols:ro,install:co,logs:vo},data:function(){return{group:"",name:"",version:"",versions:[],serviceVersion:null,activeName:"readme"}},watch:{$route:function(e,t){e.path.startsWith("/market/service")&&this.loadData(e.params.group,e.params.name,e.params.version)}},methods:{handleClick:function(){},goRepository:function(e){window.open(e)},loadData:function(e,t,a){this.group=e,this.name=t,this.version=a,this.fetchServiceVersionData(this.version)},change:function(e){this.version=e,this.fetchServiceVersionData(e)},visibleChange:function(e){e&&this.fetchVersionListData()},fetchServiceVersionData:function(e){var t=this;this.$market.call("cloud-market","getServiceVersion",{req:{group:this.group,name:this.name,version:e}}).then((function(e){t.serviceVersion=null,t.$nextTick((function(){t.serviceVersion=e.rsp,t.serviceVersion.logo=t.serviceVersion.prefix+t.serviceVersion.logo+"?t="+t.serviceVersion.update_time,t.serviceVersion.readme=t.serviceVersion.prefix+t.serviceVersion.readme+"?t="+t.serviceVersion.update_time,t.serviceVersion.deploy=t.serviceVersion.prefix+t.serviceVersion.deploy+"?t="+t.serviceVersion.update_time,t.serviceVersion.changelist=t.serviceVersion.prefix+t.serviceVersion.changelist+"?t="+t.serviceVersion.update_time,t.serviceVersion.create_time=E()(t.serviceVersion.create_time).format("YYYY-MM-DD"),t.serviceVersion.update_time=E()(t.serviceVersion.update_time).format("YYYY-MM-DD")}))})).catch((function(e){t.$message({message:e,type:"error"})}))},fetchVersionListData:function(){var e=this;this.$market.call("cloud-market","getServiceVersionList",{req:{group:this.group,name:this.name}}).then((function(t){e.versions=t.rsp.versions})).catch((function(t){e.$message({message:t,type:"error"})}))},showInstall:function(){this.$refs.install.showInstall()}},created:function(){},mounted:function(){this.loadData(this.$route.params.group,this.$route.params.name,this.$route.params.version)}},bo=go,$o=(a("c762"),Object(w["a"])(bo,Pr,Or,!1,null,null,null)),ko=$o.exports,yo=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-card",{staticClass:"box-card market_page"},[a("div",[a("h1",{staticClass:"top_txt"},[e._v(" "+e._s(e.$t("market.login.loginTitle"))+" ")])]),a("el-form",{ref:"ruleFormLogin",attrs:{"label-width":"0",model:e.login,rules:e.rules,autocomplete:"on"}},[a("el-form-item",{attrs:{prop:"uid"}},[a("el-input",{attrs:{placeholder:e.$t("market.login.userName"),"prefix-icon":"el-icon-message",autocomplete:"on"},model:{value:e.login.uid,callback:function(t){e.$set(e.login,"uid",t)},expression:"login.uid"}})],1),a("el-form-item",{attrs:{prop:"password"}},[a("el-input",{attrs:{placeholder:e.$t("market.login.password"),"show-password":"","prefix-icon":"el-icon-lock",autocomplete:"on"},model:{value:e.login.password,callback:function(t){e.$set(e.login,"password",t)},expression:"login.password"}})],1),a("el-form-item",{attrs:{required:""}},[a("div",{staticClass:"captcha_box"},[a("el-input",{attrs:{"prefix-icon":"el-icon-finished",type:"text",placeholder:e.$t("market.login.captcha"),required:"","required-tip":e.$t("market.login.captchaTips")},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.login(t)}},model:{value:e.login.captcha,callback:function(t){e.$set(e.login,"captcha",t)},expression:"login.captcha"}}),a("img",{staticClass:"captcha_code",attrs:{title:e.$t("market.login.refresh"),src:e.login.captchaUrl},on:{click:e.reloadCaptcha}})],1)]),a("el-button",{staticClass:"btn_long",attrs:{type:"primary",size:"small",round:""},on:{click:e.doLogin}},[e._v(e._s(e.$t("market.login.login")))]),a("br"),a("br"),a("div",{staticClass:"sub_menu"},[a("div",{staticClass:"bot_txt"},[a("span",[e._v(e._s(e.$t("market.login.registerInfo"))+" "),a("a",{attrs:{size:"small",round:""},on:{click:e.show_registry}},[e._v(e._s(e.$t("market.login.register")))]),e._v(" "+e._s(e.$t("market.login.and"))+" "),a("a",{attrs:{size:"small",round:""},on:{click:e.show_active}},[e._v(e._s(e.$t("market.login.activated")))])]),a("br"),a("span",[e._v(e._s(e.$t("market.login.forget"))+" "),a("a",{staticStyle:{float:"right"},attrs:{size:"small",round:""},on:{click:e.forget_pass}},[e._v(e._s(e.$t("market.login.findPassword")))]),e._v(" "+e._s(e.$t("market.login.and"))+" "),a("a",{staticStyle:{float:"right"},attrs:{size:"small",round:""},on:{click:e.reset_pass}},[e._v(e._s(e.$t("market.login.resetPassword")))]),e._v(" "+e._s(e.$t("market.login.password"))+" ")])])])],1)],1)],1)},So=[],_o=a("58b7"),wo=a.n(_o),Mo=(a("83a3"),{name:"Login",data:function(){var e=this,t=function(e){var t=e.match(/^.*[A-Z]+.*$/);if(null==t)return!1;t=e.match(/^.*[a-z]+.*$/);if(null==t)return!1;t=e.match(/^.*[0-9]+.*$/);return null!=t},a=function(a,r,o){r.length<8?o(new Error(e.$t("market.login.passwordInfo"))):t(r)?o():o(new Error(e.$t("market.login.passwordInfo")))},r=function(t,a,r){var o=/^([a-zA-Z0-9._-])+@([a-zA-Z0-9_-])+(.[a-zA-Z0-9_-])+/;if(!a)return r(new Error(e.$t("market.login.userNameRegTips")));setTimeout((function(){o.test(a)?r():r(new Error(e.$t("market.login.userNameRegTips")))}),100)};return{login:{ticket:"",uid:window.localStorage.uid||"",captcha:"",password:"",captchaUrl:"",session:""},rules:{uid:[{required:!0,message:this.$t("market.login.inputUserName"),trigger:"blur"},{message:this.$t("market.login.userNameRegTips"),trigger:"blur"},{validator:r,trigger:"blur"}],password:[{required:!0,message:this.$t("market.login.inputPassword"),trigger:"blur"},{min:8,max:16,message:this.$t("market.login.passwordInfo"),trigger:"blur"},{validator:a,trigger:"blur"}]}}},methods:{reloadCaptcha:function(){var e=this;this.$market.call("cloud-user","captcha").then((function(t){e.login.captchaUrl="data:image/svg+xml;base64,"+t.ci.captchaBase64,e.login.session=t.ci.session})).catch((function(t){e.$message({message:e.$t("market.userRet."+t.tars_ret||!1),type:"error"})}))},forget_pass:function(){this.$router.push("/market/user/forget")},show_registry:function(){this.$router.push("/market/user/register")},show_active:function(){this.$router.push("/market/user/activate")},reset_pass:function(){this.$router.push("/market/user/resetPass")},doLogin:function(){var e=this;this.$refs["ruleFormLogin"].validate((function(t){if(!t)return!1;e.$market.call("cloud-user","login",{li:{uid:e.login.uid,password:wo()(e.login.password),captcha:e.login.captcha,session:e.login.session}}).then((function(t){t.ticket?(e.login.ticket=t.ticket,e.login.isLogin=!0,window.localStorage.ticket=t.ticket,window.localStorage.uid=e.login.uid,e.$store.commit({type:"marketUid",uid:window.localStorage.uid}),e.$router.push("/market/list")):(e.login.ticket="",e.login.isLogin=!1,window.localStorage.ticket="")})).catch((function(t){e.$message({message:e.$t("market.userRet."+t.tars_ret||!1),type:"error"})}))}))}},mounted:function(){this.reloadCaptcha(),this.$refs["ruleFormLogin"].resetFields()}}),xo=Mo,Co=Object(w["a"])(xo,yo,So,!1,null,null,null),No=Co.exports,Lo=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-card",{staticClass:"box-card market_page"},[a("h1",{staticClass:"top_txt"},[e._v(" "+e._s(e.$t("market.login.register"))+" ")]),a("el-form",{ref:"ruleRegisterForm",attrs:{"label-width":"120px",model:e.login,"label-position":"left",rules:e.rules}},[a("el-form-item",{attrs:{label:e.$t("market.login.userName"),prop:"uid",required:""}},[a("el-input",{attrs:{placeholder:e.$t("market.login.inputUserName"),"prefix-icon":"el-icon-message"},model:{value:e.login.uid,callback:function(t){e.$set(e.login,"uid",t)},expression:"login.uid"}})],1),a("el-form-item",{attrs:{label:e.$t("market.login.password"),prop:"password"}},[a("el-input",{attrs:{"prefix-icon":"el-icon-key",placeholder:e.$t("market.login.passwordInfo"),"show-password":""},model:{value:e.login.password,callback:function(t){e.$set(e.login,"password",t)},expression:"login.password"}})],1),a("el-form-item",{attrs:{label:e.$t("market.login.repeatPassword"),prop:"checkPass",required:""}},[a("el-input",{attrs:{"prefix-icon":"el-icon-key",placeholder:e.$t("market.login.inputRepeatPassword"),"show-password":""},model:{value:e.login.checkPass,callback:function(t){e.$set(e.login,"checkPass",t)},expression:"login.checkPass"}})],1),a("el-button",{staticClass:"btn_long",attrs:{type:"primary",size:"small",round:""},on:{click:e.register}},[e._v(e._s(e.$t("market.login.register")))]),a("br"),a("br"),a("div",{staticClass:"sub_menu"},[a("a",{attrs:{size:"small",round:""},on:{click:e.show_login}},[e._v(e._s(e.$t("market.login.back")))])])],1)],1)],1)},To=[],Io=a("ade3"),Ao={name:"Register",data:function(){var e=this,t=function(e){var t=e.match(/^.*[A-Z]+.*$/);if(null==t)return!1;t=e.match(/^.*[a-z]+.*$/);if(null==t)return!1;t=e.match(/^.*[0-9]+.*$/);return null!=t},a=function(a,r,o){r.length<8?o(new Error(e.$t("market.login.passwordInfo"))):t(r)?o():o(new Error(e.$t("market.login.passwordInfo")))},r=function(t,a,r){""===a?r(new Error(e.$t("market.login.inputPasswordAgain"))):a!==e.login.password?r(new Error(e.$t("market.login.passwordDiff"))):r()},o=function(t,a,r){var o=/^([a-zA-Z0-9._-])+@([a-zA-Z0-9_-])+(.[a-zA-Z0-9_-])+/;if(!a)return r(new Error(e.$t("market.login.userNameRegTips")));setTimeout((function(){o.test(a)?r():r(new Error(e.$t("market.login.userNameRegTips")))}),100)};return{login:{ticket:"",uid:window.localStorage.uid||"",captcha:"",password:"",checkPass:"",captchaUrl:"",session:""},rules:Object(Io["a"])({uid:[{required:!0,message:this.$t("market.login.inputUserName"),trigger:"blur"},{message:this.$t("market.login.userNameRegTips"),trigger:"blur"},{validator:o,trigger:"blur"}],password:[{required:!0,message:this.$t("market.login.inputPassword"),trigger:"blur"},{min:8,max:16,message:this.$t("market.login.passwordInfo"),trigger:"blur"},{validator:a,trigger:"blur"}],checkPass:[{required:!0,message:this.$t("market.login.inputPassword"),trigger:"blur"},{min:8,max:16,message:this.$t("market.login.passwordInfo"),trigger:"blur"},{validator:a,trigger:"blur"}]},"checkPass",[{validator:r,trigger:"blur"}])}},methods:{show_login:function(){this.$router.push("/market/user/login")},show_activate:function(){this.$router.push("/market/user/activate")},register:function(){var e=this;this.$refs["ruleRegisterForm"].validate((function(t){if(!t)return!1;e.$market.call("cloud-user","register",{uid:e.login.uid,password:wo()(e.login.password),origin:window.location.origin}).then((function(t){window.localStorage.uid=e.login.uid,e.show_activate()})).catch((function(t){e.$message({message:e.$t("market.userRet."+t.tars_ret||!1),type:"error"})}))}))}},mounted:function(){}},Do=Ao,Po=Object(w["a"])(Do,Lo,To,!1,null,null,null),Oo=Po.exports,qo=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-card",{staticClass:"box-card market_page"},[a("el-alert",{attrs:{title:e.$t("market.login.registerSucc"),type:"success"}}),a("div",[a("h1",{staticClass:"top_txt"},[e._v(" "+e._s(e.$t("market.login.activing"))+" ")])]),a("el-form",{ref:"ruleForgetForm",attrs:{"label-width":"80px",model:e.login,"label-position":"left",rules:e.rules}},[a("el-form-item",{attrs:{label:e.$t("market.login.userName"),prop:"uid",required:""}},[a("el-input",{attrs:{placeholder:e.$t("market.login.inputUserName"),"prefix-icon":"el-icon-message"},model:{value:e.login.uid,callback:function(t){e.$set(e.login,"uid",t)},expression:"login.uid"}})],1),a("el-form-item",{attrs:{label:e.$t("market.login.activeCode"),prop:"activeCode",required:""}},[a("el-input",{attrs:{placeholder:e.$t("market.login.inputActiveCode"),"prefix-icon":"el-icon-bell"},model:{value:e.login.activeCode,callback:function(t){e.$set(e.login,"activeCode",t)},expression:"login.activeCode"}})],1),a("el-button",{staticClass:"btn_long btn_submit",attrs:{type:"primary",size:"small",round:""},on:{click:e.activate}},[e._v(e._s(e.$t("market.login.activate")))]),a("br"),a("br"),a("div",{staticClass:"sub_menu"},[a("a",{attrs:{size:"small",round:""},on:{click:e.show_login}},[e._v(e._s(e.$t("market.login.back")))])])],1)],1)],1)},jo=[],zo={name:"Activate",data:function(){var e=this,t=function(t,a,r){var o=/^([a-zA-Z0-9._-])+@([a-zA-Z0-9_-])+(.[a-zA-Z0-9_-])+/;if(!a)return r(new Error(e.$t("market.login.userNameRegTips")));setTimeout((function(){o.test(a)?r():r(new Error(e.$t("market.login.userNameRegTips")))}),100)};return{login:{uid:window.localStorage.uid||"",activeCode:""},rules:{uid:[{required:!0,message:this.$t("market.login.inputUserName"),trigger:"blur"},{message:this.$t("market.login.userNameRegTips"),trigger:"blur"},{validator:t,trigger:"blur"}],activeCode:[{required:!0,message:this.$t("market.login.inputActiveCode"),trigger:"blur"}]}}},mounted:function(){console.log(this.$route.params),this.login.activeCode=this.$route.params.uid},methods:{show_login:function(){this.$router.push("/market/user/login")},activate:function(){var e=this;this.$market.call("cloud-user","activate",{uid:this.login.uid,activeCode:this.login.activeCode}).then((function(){e.$message({message:e.$t("market.login.activateSuccAndRedirect"),type:"success"}),setTimeout((function(){e.$router.push("/market/user/login")}),1e3)})).catch((function(t){e.$message({message:e.$t("market.userRet."+t.tars_ret||!1),type:"warning"})}))}}},Vo=zo,Ro=Object(w["a"])(Vo,qo,jo,!1,null,null,null),Eo=Ro.exports,Bo=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-card",{staticClass:"box-card market_page"},[a("h1",{staticClass:"top_txt"},[e._v(" "+e._s(e.$t("market.login.findPasswordTitle"))+" ")]),a("el-form",{ref:"ruleForgetForm",attrs:{"label-width":"80px",model:e.login,"label-position":"left",rules:e.rules}},[a("el-form-item",{attrs:{label:e.$t("market.login.userName"),prop:"uid",required:""}},[a("el-input",{attrs:{placeholder:e.$t("market.login.inputUserName"),"prefix-icon":"el-icon-message"},model:{value:e.login.uid,callback:function(t){e.$set(e.login,"uid",t)},expression:"login.uid"}})],1),a("el-button",{staticClass:"btn_long btn_submit",attrs:{type:"primary",size:"small",round:""},on:{click:e.forget}},[e._v(e._s(e.$t("market.login.submit")))]),a("br"),a("br"),a("div",{staticClass:"sub_menu"},[a("a",{attrs:{size:"small",round:""},on:{click:e.show_login}},[e._v(e._s(e.$t("market.login.back")))])])],1)],1)],1)},Ho=[],Fo={name:"Forget",data:function(){var e=this,t=function(t,a,r){var o=/^([a-zA-Z0-9._-])+@([a-zA-Z0-9_-])+(.[a-zA-Z0-9_-])+/;if(!a)return r(new Error(e.$t("market.login.userNameRegTips")));setTimeout((function(){o.test(a)?r():r(new Error(e.$t("market.login.userNameRegTips")))}),100)};return{login:{ticket:"",uid:window.localStorage.uid||""},rules:{uid:[{required:!0,message:this.$t("market.login.inputUserName"),trigger:"blur"},{message:this.$t("market.login.userNameRegTips"),trigger:"blur"},{validator:t,trigger:"blur"}]}}},methods:{show_login:function(){this.$router.push("/market/user/login")},forget:function(){var e=this;this.$refs["ruleForgetForm"].validate((function(t){if(!t)return!1;e.$market.call("cloud-user","forget",{uid:e.login.uid,origin:window.location.origin}).then((function(t){e.$message({message:e.$t("market.login.findPasswordSucc"),type:"success"}),window.localStorage.uid=e.login.uid,e.$router.push("/market/user/resetPass")})).catch((function(t){e.$message({message:e.$t("market.userRet."+t.tars_ret||!1),type:"error"})}))}))}},mounted:function(){}},Jo=Fo,Yo=Object(w["a"])(Jo,Bo,Ho,!1,null,null,null),Uo=Yo.exports,Ko=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-card",{staticClass:"box-card market_page"},[a("h1",{staticClass:"top_txt"},[e._v(e._s(e.$t("market.login.modifyPass")))]),a("el-form",{ref:"ruleForm",attrs:{"label-width":"150px",model:e.data,"label-position":"left",rules:e.rules}},[a("el-form-item",{attrs:{label:e.$t("market.login.inputOldPass"),prop:"oldPassword",required:""}},[a("el-input",{attrs:{placeholder:e.$t("market.login.passwordInfo"),"show-password":""},model:{value:e.data.oldPassword,callback:function(t){e.$set(e.data,"oldPassword",t)},expression:"data.oldPassword"}})],1),a("el-form-item",{attrs:{label:e.$t("market.login.inputNewPass"),prop:"newPassword",required:""}},[a("el-input",{attrs:{placeholder:e.$t("market.login.passwordInfo"),"show-password":""},model:{value:e.data.newPassword,callback:function(t){e.$set(e.data,"newPassword",t)},expression:"data.newPassword"}})],1),a("el-form-item",{attrs:{label:e.$t("market.login.repeatInputNewPass"),prop:"checkPass",required:""}},[a("el-input",{attrs:{placeholder:e.$t("market.login.repeatInputNewPass"),"show-password":""},model:{value:e.data.checkPass,callback:function(t){e.$set(e.data,"checkPass",t)},expression:"data.checkPass"}})],1),a("el-button",{staticClass:"btn_long",attrs:{type:"primary",size:"small",round:""},on:{click:e.modifyPass}},[e._v(e._s(e.$t("market.login.modifyPass")))]),a("br"),a("br"),a("div",{staticClass:"sub_menu"},[a("a",{attrs:{size:"small",round:""},on:{click:e.back}},[e._v(e._s(e.$t("market.login.back")))])])],1)],1)],1)},Wo=[],Zo={name:"ModifyPass",data:function(){var e=this,t=function(e){var t=e.match(/^.*[A-Z]+.*$/);if(null==t)return!1;t=e.match(/^.*[a-z]+.*$/);if(null==t)return!1;t=e.match(/^.*[0-9]+.*$/);return null!=t},a=function(a,r,o){r.length<8?o(new Error(e.$t("market.login.passwordInfo"))):t(r)?o():o(new Error(e.$t("market.login.passwordInfo")))},r=function(t,a,r){""===a?r(new Error(e.$t("login.inputPasswordAgain"))):a!==e.data.newPassword?r(new Error(e.$t("login.passwordDiff"))):r()};return{data:{newPassword:"",oldPassword:"",checkPass:""},rules:Object(Io["a"])({newPassword:[{required:!0,message:this.$t("market.login.inputPassword"),trigger:"blur"},{min:8,max:16,message:this.$t("market.login.passwordInfo"),trigger:"blur"},{validator:a,trigger:"blur"}],oldPassword:[{required:!0,message:this.$t("market.login.inputPassword"),trigger:"blur"},{min:8,max:16,message:this.$t("market.login.passwordInfo"),trigger:"blur"},{validator:a,trigger:"blur"}],checkPass:[{required:!0,message:this.$t("market.login.inputPassword"),trigger:"blur"},{min:8,max:16,message:this.$t("market.login.passwordInfo"),trigger:"blur"}]},"checkPass",[{validator:r,trigger:"blur"}])}},methods:{back:function(){this.$router.go(-1)},modifyPass:function(){var e=this;this.$refs["ruleForm"].validate((function(t){if(!t)return!1;e.$market.call("cloud-user","resetPass",{ticket:window.localStorage.ticket,oldPassword:wo()(e.data.oldPassword),newPassword:wo()(e.data.newPassword)}).then((function(t){e.$message({message:e.$t("market.login.modifySucc"),type:"success"}),e.$router.push("/market/list")})).catch((function(t){e.$message({message:e.$t("market.userRet."+t.tars_ret||!1),type:"error"})}))}))}}},Go=Zo,Qo=Object(w["a"])(Go,Ko,Wo,!1,null,null,null),Xo=Qo.exports,ei=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-card",{staticClass:"box-card market_page"},[a("h1",{staticClass:"top_txt"},[e._v(e._s(e.$t("market.login.resetPass")))]),a("el-form",{ref:"ruleForm",attrs:{"label-width":"120px",model:e.data,"label-position":"left",rules:e.rules}},[a("el-form-item",{attrs:{label:e.$t("market.login.userName"),prop:"uid",required:""}},[a("el-input",{attrs:{placeholder:e.$t("market.login.inputUserName"),"prefix-icon":"el-icon-message"},model:{value:e.data.uid,callback:function(t){e.$set(e.data,"uid",t)},expression:"data.uid"}})],1),a("el-form-item",{attrs:{label:e.$t("market.login.inputPassword"),prop:"password",required:""}},[a("el-input",{attrs:{placeholder:e.$t("market.login.passwordInfo"),"show-password":""},model:{value:e.data.password,callback:function(t){e.$set(e.data,"password",t)},expression:"data.password"}})],1),a("el-form-item",{attrs:{label:e.$t("market.login.repeatPassword"),prop:"checkPass",required:""}},[a("el-input",{attrs:{placeholder:e.$t("market.login.inputRepeatPassword"),"show-password":""},model:{value:e.data.checkPass,callback:function(t){e.$set(e.data,"checkPass",t)},expression:"data.checkPass"}})],1),a("el-form-item",{attrs:{label:e.$t("market.login.activeCode"),prop:"activeCode",required:""}},[a("el-input",{attrs:{placeholder:e.$t("market.login.inputActiveCode"),"show-password":""},model:{value:e.data.activeCode,callback:function(t){e.$set(e.data,"activeCode",t)},expression:"data.activeCode"}})],1),a("el-form-item",{attrs:{required:""}},[a("div",{staticClass:"captcha_box"},[a("el-input",{attrs:{"prefix-icon":"el-icon-finished",type:"text",placeholder:e.$t("market.login.captcha"),required:"","required-tip":e.$t("market.login.captchaTips")},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.login(t)}},model:{value:e.data.captcha,callback:function(t){e.$set(e.data,"captcha",t)},expression:"data.captcha"}}),a("img",{staticClass:"captcha_code",attrs:{title:e.$t("market.login.refresh"),src:e.data.captchaUrl},on:{click:e.reloadCaptcha}})],1)]),a("el-button",{attrs:{type:"primary",size:"small",round:""},on:{click:e.resetPass}},[e._v(e._s(e.$t("market.login.resetPass")))]),a("br"),a("br"),a("div",{staticClass:"sub_menu"},[a("a",{attrs:{size:"small",round:""},on:{click:e.show_login}},[e._v(e._s(e.$t("market.login.back")))])])],1)],1)],1)},ti=[],ai={name:"ResetPass1",data:function(){var e,t=this,a=function(e){var t=e.match(/^.*[A-Z]+.*$/);if(null==t)return!1;t=e.match(/^.*[a-z]+.*$/);if(null==t)return!1;t=e.match(/^.*[0-9]+.*$/);return null!=t},r=function(e,r,o){r.length<8?o(new Error(t.$t("market.login.passwordInfo"))):a(r)?o():o(new Error(t.$t("market.login.passwordInfo")))},o=function(e,a,r){var o=/^([a-zA-Z0-9._-])+@([a-zA-Z0-9_-])+(.[a-zA-Z0-9_-])+/;if(!a)return r(new Error(t.$t("market.login.userNameRegTips")));setTimeout((function(){o.test(a)?r():r(new Error(t.$t("market.login.userNameRegTips")))}),100)},i=function(e,a,r){""===a?r(new Error(t.$t("market.login.inputPasswordAgain"))):a!==t.data.password?r(new Error(t.$t("market.login.passwordDiff"))):r()};return{data:{uid:window.localStorage.uid||"",activeCode:"",password:"",checkPass:"",captchaUrl:"",session:"",captcha:""},rules:(e={uid:[{required:!0,message:this.$t("market.login.inputUserName"),trigger:"blur"},{message:this.$t("market.login.userNameRegTips"),trigger:"blur"},{validator:o,trigger:"blur"}],password:[{required:!0,message:this.$t("market.login.inputPassword"),trigger:"blur"},{min:8,max:16,message:this.$t("market.login.passwordInfo"),trigger:"blur"},{validator:r,trigger:"blur"}],checkPass:[{required:!0,message:this.$t("market.login.inputPassword"),trigger:"blur"},{min:8,max:16,message:this.$t("market.login.passwordInfo"),trigger:"blur"}]},Object(Io["a"])(e,"checkPass",[{validator:i,trigger:"blur"}]),Object(Io["a"])(e,"activeCode",[{required:!0,message:this.$t("market.login.inputPassword"),trigger:"blur"}]),e)}},methods:{show_login:function(){this.$router.push("/market/user/login")},reloadCaptcha:function(){var e=this;this.$market.call("cloud-user","captcha").then((function(t){e.data.captchaUrl="data:image/svg+xml;base64,"+t.ci.captchaBase64,e.data.session=t.ci.session})).catch((function(t){e.$message({message:t.err_msg,type:"error"})}))},resetPass:function(){var e=this;this.$refs["ruleForm"].validate((function(t){if(!t)return!1;e.$market.call("cloud-user","resetPassByActiveCode",{rp:{uid:e.data.uid,activeCode:e.data.activeCode,password:wo()(e.data.password),captcha:e.data.captcha,session:e.data.session}}).then((function(t){e.$message({message:e.$t("market.login.findPasswordSucc"),type:"success"}),window.localStorage.uid=e.data.uid,e.$router.push("/market/user/login")})).catch((function(t){e.$message({message:e.$t("market.userRet."+t.tars_ret||!1),type:"error"})}))}))}},mounted:function(){this.reloadCaptcha()}},ri=ai,oi=Object(w["a"])(ri,ei,ti,!1,null,null,null),ii=oi.exports,si=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-card",{staticClass:"box-card market_page"},[a("h1",{staticClass:"top_txt"},[e._v(e._s(e.$t("market.repo.resetPass")))]),a("el-form",{ref:"ruleForm",attrs:{"label-width":"120px",model:e.data,"label-position":"left",rules:e.rules}},[a("el-form-item",{attrs:{label:e.$t("market.repo.inputPassword"),prop:"password",required:""}},[a("el-input",{attrs:{placeholder:e.$t("market.repo.passwordInfo"),"show-password":""},model:{value:e.data.password,callback:function(t){e.$set(e.data,"password",t)},expression:"data.password"}})],1),a("el-form-item",{attrs:{label:e.$t("market.repo.repeatPassword"),prop:"checkPass",required:""}},[a("el-input",{attrs:{placeholder:e.$t("market.repo.inputRepeatPassword"),"show-password":""},model:{value:e.data.checkPass,callback:function(t){e.$set(e.data,"checkPass",t)},expression:"data.checkPass"}})],1),a("el-button",{attrs:{type:"primary",size:"small",round:""},on:{click:e.createRepoUser}},[e._v(e._s(e.$t("market.repo.resetPass")))]),a("br"),a("br"),a("div",{staticClass:"sub_menu"},[a("a",{attrs:{size:"small",round:""},on:{click:e.back}},[e._v(e._s(e.$t("market.repo.back")))])])],1)],1)],1)},li=[],ni={name:"createRepoUser",data:function(){var e,t=this,a=function(e){var t=e.match(/^.*[A-Z]+.*$/);if(null==t)return!1;t=e.match(/^.*[a-z]+.*$/);if(null==t)return!1;t=e.match(/^.*[0-9]+.*$/);return null!=t},r=function(e,r,o){r.length<8?o(new Error(t.$t("market.repo.passwordInfo"))):a(r)?o():o(new Error(t.$t("market.repo.passwordInfo")))},o=function(e,a,r){""===a?r(new Error(t.$t("market.login.inputPasswordAgain"))):a!==t.data.password?r(new Error(t.$t("market.login.passwordDiff"))):r()};return{data:{uid:window.localStorage.uid||"",password:"",checkPass:""},rules:(e={password:[{required:!0,message:this.$t("market.repo.inputPassword"),trigger:"blur"},{min:8,max:16,message:this.$t("market.repo.passwordInfo"),trigger:"blur"},{validator:r,trigger:"blur"}],checkPass:[{required:!0,message:this.$t("market.repo.inputPassword"),trigger:"blur"},{min:8,max:16,message:this.$t("market.repo.passwordInfo"),trigger:"blur"}]},Object(Io["a"])(e,"checkPass",[{validator:o,trigger:"blur"}]),Object(Io["a"])(e,"activeCode",[{required:!0,message:this.$t("market.repo.inputPassword"),trigger:"blur"}]),e)}},methods:{back:function(){this.$router.go(-1)},createRepoUser:function(){var e=this;this.$refs["ruleForm"].validate((function(t){if(!t)return!1;e.$market.call("cloud-harbor","createRepoUser",{password:e.data.password}).then((function(t){e.$message({message:e.$t("market.repo.resetPassSucc"),type:"success"}),setTimeout((function(){e.$router.go(-1)}),1e3)})).catch((function(t){e.$message({message:e.$t("market.repoRet."+t.tars_ret||!1),type:"error"})}))}))}},mounted:function(){}},ci=ni,di=Object(w["a"])(ci,si,li,!1,null,null,null),ui=di.exports,pi=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-button",{staticStyle:{"margin-top":"20px"},attrs:{type:"primary",size:"small"},on:{click:function(t){return e.showAddProject()}}},[e._v("添加项目")]),a("br"),a("el-table",{staticStyle:{width:"100%","margin-top":"20px"},attrs:{data:e.data,stripe:"",border:""}},[a("el-table-column",{attrs:{prop:"project",label:"项目名称","min-width":"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-link",{attrs:{type:"primary"},on:{click:function(a){return e.showListRepo(t.row.name)}}},[e._v(e._s(t.row.name))])]}}])}),a("el-table-column",{attrs:{prop:"repo_count",label:"镜像仓库数","min-width":"100"}}),a("el-table-column",{attrs:{label:"开发者","min-width":"800px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._l(t.row.uids,(function(r){return a("el-tag",{key:r,staticStyle:{"margin-right":"5px"},attrs:{closable:e.closable[r]},on:{close:function(a){return e.deleteMember(t.row,r)}}},[e._v(" "+e._s(r)+" ")])})),a("el-tag",{staticStyle:{cursor:"pointer"},on:{click:function(a){return e.showAddMember(t.row.name)}}},[e._v("+")])]}}])}),a("el-table-column",{attrs:{prop:"update_time",label:"更新时间","min-width":"200"}}),a("el-table-column",{attrs:{label:"操作","min-width":"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticStyle:{"text-align":"center"},attrs:{type:"danger",size:"small"},on:{click:function(a){return e.deleteProject(t.row)}}},[e._v("删除")])]}}])})],1),a("br"),a("div",[a("el-pagination",{staticStyle:{display:"inline"},attrs:{background:"",layout:"prev, pager, next",total:e.total,"page-size":e.page_size,"current-page":e.page},on:{"update:pageSize":function(t){e.page_size=t},"update:page-size":function(t){e.page_size=t},"update:currentPage":function(t){e.page=t},"update:current-page":function(t){e.page=t},"current-change":e.changePage,"prev-click":e.changePage,"next-click":e.changePage}})],1),a("addProject",{ref:"addProject",on:{addProjectSucc:e.addProjectSucc}}),a("addMember",{ref:"addMember",on:{addMemberSucc:e.addMemberSucc}}),a("listRepo",{ref:"listRepo",on:{showListArtifacts:e.showListArtifacts}}),a("listArtifacts",{ref:"listArtifacts"})],1)},mi=[],fi=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:"添加项目",visible:e.project.addDialogVisible,width:"500px"},on:{"update:visible":function(t){return e.$set(e.project,"addDialogVisible",t)}}},[a("el-form",{ref:"ruleForm",attrs:{rules:e.rules,model:e.project}},[a("el-form-item",{attrs:{required:"",label:"项目名称",prop:"project","label-width":"200"}},[a("el-input",{attrs:{placeholder:"请输入项目名称",maxlength:"40","suffix-icon":e.suffixIcon},on:{input:e.inputProjectName},model:{value:e.project.project,callback:function(t){e.$set(e.project,"project",t)},expression:"project.project"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.project.addDialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.submit}},[e._v("添加项目")])],1)],1)},hi=[],vi={name:"addProject",data:function(){var e=this,t=function(e){var t=e.match(/^[a-z]+$/);return null!=t},a=function(a,r,o){t(r)?o():o(new Error(e.$t("market.repo.projectNameRegTips")))};return{project:{addDialogVisible:!1,project:""},suffixIcon:"",interval:null,rules:{project:[{required:!0,message:"项目名称不能为空",trigger:"blur"},{message:this.$t("market.repo.projectNameRegTips"),trigger:"blur"},{validator:a,trigger:"blur"}]}}},methods:{show:function(){this.project.addDialogVisible=!0},closeDialog:function(){this.project.addDialogVisible=!1,this.$emit("addProjectSucc")},inputProjectName:function(e){var t=this;e&&(this.interval&&(clearTimeout(this.interval),this.interval=null),this.interval=setTimeout((function(){t.$market.call("cloud-harbor","hasProject",{project:e}).then((function(a){t.interval=null,e==t.project.project&&(a.exists?t.suffixIcon="el-icon-close":t.suffixIcon="el-icon-check")})).catch((function(e){}))}),500))},submit:function(){var e=this;this.$refs["ruleForm"].validate((function(t){t&&e.$market.call("cloud-harbor","createProject",{project:e.project.project}).then((function(t){e.$message({message:e.$t("market.repo.createProjectSucc"),type:"success"}),e.closeDialog()})).catch((function(t){e.$message({message:e.$t("market.marketRet."+t.tars_ret||!1),type:"error"})}))}))}},created:function(){},mounted:function(){}},gi=vi,bi=Object(w["a"])(gi,fi,hi,!1,null,null,null),$i=bi.exports,ki=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:"授权用户",visible:e.project.addDialogVisible,width:"500px"},on:{"update:visible":function(t){return e.$set(e.project,"addDialogVisible",t)}}},[a("el-form",{ref:"ruleForm",attrs:{rules:e.rules,model:e.project}},[a("el-form-item",{attrs:{required:"",label:"用户名",prop:"uid","label-width":"200"}},[a("el-autocomplete",{staticStyle:{width:"100%"},attrs:{"fetch-suggestions":e.searchUserName,placeholder:"请输入用户名","trigger-on-focus":!1,"suffix-icon":e.suffixIcon},on:{select:e.handleSelect},model:{value:e.project.uid,callback:function(t){e.$set(e.project,"uid",t)},expression:"project.uid"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.project.addDialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary",disabled:"el-icon-check"!=e.suffixIcon},on:{click:e.submit}},[e._v("授权用户")])],1)],1)},yi=[],Si={name:"addMember",data:function(){var e=this,t=function(t,a,r){var o=/^([a-zA-Z0-9._-])+@([a-zA-Z0-9_-])+(.[a-zA-Z0-9_-])+/;if(!a)return r(new Error(e.$t("market.login.userNameRegTips")));setTimeout((function(){o.test(a)?r():r(new Error(e.$t("market.login.userNameRegTips")))}),100)};return{project:{addDialogVisible:!1,project:"",uid:""},uids:[],suffixIcon:"",interval:null,rules:{uid:[{required:!0,message:this.$t("market.login.inputUserName"),trigger:"blur"},{message:this.$t("market.login.userNameRegTips"),trigger:"blur"},{validator:t,trigger:"blur"}]}}},methods:{show:function(e){this.project.project=e,this.project.uid="",this.project.addDialogVisible=!0},closeDialog:function(){this.project.addDialogVisible=!1,this.$emit("addMemberSucc")},searchUserName:function(e,t){var a=this;if(e){var r=this.uids.filter((function(t){return 0==t.toLowerCase().indexOf(e.toLowerCase())})),o=function(r){var o=[];r.forEach((function(e){o.push({value:e})})),r.length>0&&e==r[0]?a.suffixIcon="el-icon-check":a.suffixIcon="el-icon-close",t(o)};0==r.length&&e?this.$market.call("cloud-harbor","searchRepoUser",{userId:e}).then((function(e){a.uids=e.uids,o(a.uids)})).catch((function(e){})):o(r||[])}},handleSelect:function(e){this.suffixIcon="el-icon-check"},submit:function(){var e=this;this.$refs["ruleForm"].validate((function(t){t&&e.$market.call("cloud-harbor","addProjectDeveloper",{project:e.project.project,uid:e.project.uid}).then((function(t){e.$message({message:e.$t("market.repo.createMemberSucc"),type:"success"}),e.closeDialog()})).catch((function(t){e.$message({message:e.$t("market.repoRet."+t.tars_ret||!1),type:"error"})}))}))}},created:function(){},mounted:function(){var e=this;setInterval((function(){e.searchUserName()}),200)}},_i=Si,wi=Object(w["a"])(_i,ki,yi,!1,null,null,null),Mi=wi.exports,xi=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:"仓库列表",visible:e.addDialogVisible,width:"80%"},on:{"update:visible":function(t){e.addDialogVisible=t}}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.repos,border:"",stripe:""}},[a("el-table-column",{attrs:{label:"镜像仓库名称","min-width":"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-link",{attrs:{type:"primary"},on:{click:function(a){return e.showListArtifacts(t.row.name)}}},[e._v(e._s(t.row.name))])]}}])}),a("el-table-column",{attrs:{prop:"artifact_count",label:"Artifacts"}}),a("el-table-column",{attrs:{prop:"pull_count",label:"下载数","min-width":"50"}}),a("el-table-column",{attrs:{prop:"update_time",label:"变更时间","min-width":"200"}}),a("el-table-column",{attrs:{label:"操作","min-width":"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticStyle:{"text-align":"center"},attrs:{type:"danger",size:"small"},on:{click:function(a){return e.deleteRepo(t.row)}}},[e._v("删除")])]}}])})],1),a("br"),a("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:e.total,"page-size":e.page_size,"current-page":e.page},on:{"update:pageSize":function(t){e.page_size=t},"update:page-size":function(t){e.page_size=t},"update:currentPage":function(t){e.page=t},"update:current-page":function(t){e.page=t},"current-change":e.changePage,"prev-click":e.changePage,"next-click":e.changePage}})],1)},Ci=[],Ni={name:"ListRepo",components:{},data:function(){return{project:"",repos:[],total:0,page_size:15,page:1,addDialogVisible:!1}},methods:{show:function(e){this.project=e,this.fetchRepoList(),this.addDialogVisible=!0},showListArtifacts:function(e){this.$emit("showListArtifacts",this.project,e)},changePage:function(e){this.page=e,this.fetchRepoList()},fetchRepoList:function(){var e=this;this.$loading.show(),this.$market.call("cloud-harbor","getRepositoryList",{project:this.project,page_size:this.page_size,page:this.page}).then((function(t){t.info.gList.forEach((function(e){e.update_time=E()(e.update_time).format("YYYY-MM-DD HH:mm:ss"),e.create_time=E()(e.create_time).format("YYYY-MM-DD HH:mm:ss")})),e.total=t.info.total,e.repos=t.info.gList,e.$loading.hide()})).catch((function(t){e.$loading.hide(),e.$message({message:e.$t("market.repoRet."+t.tars_ret||!1),type:"error"})}))},deleteRepo:function(e){var t=this;this.$confirm("确定删除该镜像仓库么?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){console.log(e),t.$market.call("cloud-harbor","delRepository",{project:t.project,repo:e.name.substr(t.project.length+1)}).then((function(e){t.$message({message:t.$t("market.repo.deleteRepoSucc"),type:"success"}),t.fetchRepoList()})).catch((function(e){t.$message({message:t.$t("market.repoRet."+e.tars_ret||!1),type:"error"})}))})).catch((function(){}))}},created:function(){},mounted:function(){}},Li=Ni,Ti=Object(w["a"])(Li,xi,Ci,!1,null,null,null),Ii=Ti.exports,Ai=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:"Artifacts",visible:e.addDialogVisible,width:"80%"},on:{"update:visible":function(t){e.addDialogVisible=t}}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.artifacts,border:"",stripe:""}},[a("el-table-column",{attrs:{prop:"digest_short",label:"digest","min-width":"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-link",{attrs:{type:"primary"}},[e._v(e._s(t.row.digest_short))])]}}])}),a("el-table-column",{attrs:{label:"tag","min-width":"200"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.tags,(function(t){return a("el-tag",{key:t,staticStyle:{"margin-right":"5px"}},[e._v(" "+e._s(t)+" ")])}))}}])}),a("el-table-column",{attrs:{prop:"push_time",label:"推送时间","min-width":"100"}}),a("el-table-column",{attrs:{prop:"pull_time",label:"拉取时间","min-width":"100"}}),a("el-table-column",{attrs:{label:"操作","min-width":"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticStyle:{"text-align":"center"},attrs:{type:"danger",size:"small"},on:{click:function(a){return e.deleteArtifact(t.row)}}},[e._v("删除")])]}}])})],1),a("br"),a("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:e.total,"page-size":e.page_size,"current-page":e.page},on:{"update:pageSize":function(t){e.page_size=t},"update:page-size":function(t){e.page_size=t},"update:currentPage":function(t){e.page=t},"update:current-page":function(t){e.page=t},"current-change":e.changePage,"prev-click":e.changePage,"next-click":e.changePage}})],1)},Di=[],Pi={name:"ListArtifacts",components:{},data:function(){return{project:"",name:"",artifacts:[],total:0,page_size:5,page:1,addDialogVisible:!1}},methods:{show:function(e,t){this.project=e,this.repo=t,this.fetchArtifactsList(),this.addDialogVisible=!0},changePage:function(e){this.page=e,this.fetchArtifactsList()},fetchArtifactsList:function(){var e=this;this.$loading.show(),this.$market.call("cloud-harbor","getArtifactsList",{project:this.project,repo:this.repo.substr(this.project.length+1),page_size:this.page_size,page:this.page}).then((function(t){t.info.gList.forEach((function(e){e.digest_short=e.digest.substr(0,17),e.pull_time=E()(e.pull_time).format("YYYY-MM-DD HH:mm:ss"),e.push_time=E()(e.push_time).format("YYYY-MM-DD HH:mm:ss")})),e.total=t.info.total,e.artifacts=t.info.gList,e.$loading.hide()})).catch((function(t){e.$message({message:e.$t("market.repoRet."+t.tars_ret||!1),type:"error"}),e.$loading.hide()}))},deleteArtifact:function(e){var t=this;this.$confirm("确定取消该Artifact么?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.$loading.show(),t.$market.call("cloud-harbor","delArtifacts",{project:t.project,repo:t.repo.substr(t.project.length+1),reference:e.digest}).then((function(e){t.$message({message:t.$t("market.repo.deleteArtifactSucc"),type:"success"}),t.$loading.hide(),t.fetchArtifactsList()})).catch((function(e){t.$message({message:t.$t("market.repoRet."+e.tars_ret||!1),type:"error"}),t.$loading.hide()}))})).catch((function(){}))}},created:function(){},mounted:function(){}},Oi=Pi,qi=Object(w["a"])(Oi,Ai,Di,!1,null,null,null),ji=qi.exports,zi={name:"ListProject",components:{addProject:$i,addMember:Mi,listRepo:Ii,listArtifacts:ji},data:function(){return{data:[],total:0,page_size:15,page:1,closable:{}}},methods:{showAddProject:function(){this.$refs.addProject.show()},showAddMember:function(e){this.$refs.addMember.show(e)},showListRepo:function(e){this.$refs.listRepo.show(e)},showListArtifacts:function(e,t){this.$refs.listArtifacts.show(e,t)},addMemberSucc:function(){this.fetchProjects()},addProjectSucc:function(){this.fetchProjects()},deleteMember:function(e,t){var a=this;this.$confirm("确定取消该用户的权限么?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){a.$market.call("cloud-harbor","delProjectDeveloper",{project:e.name,uid:t}).then((function(r){a.$message({message:a.$t("market.repo.deleteMemberSucc"),type:"success"}),e.uids.splice(e.uids.indexOf(t),1)})).catch((function(e){a.$message({message:a.$t("market.repoRet."+e.tars_ret||!1),type:"error"})}))})).catch((function(){}))},deleteProject:function(e){var t=this;this.$confirm("确定删除该项目么?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.$market.call("cloud-harbor","delProject",{project:e.name}).then((function(e){t.$message({message:t.$t("market.repo.deleteProjectSucc"),type:"success"}),t.fetchProjects()})).catch((function(e){t.$message({message:t.$t("market.repoRet."+e.tars_ret||!1),type:"error"})}))})).catch((function(){}))},changePage:function(e){this.page=e,this.fetchProjects()},fetchProjects:function(){var e=this;this.$loading.show(),this.$market.call("cloud-harbor","getProjectList",{page_size:this.page_size,page:this.page}).then((function(t){e.data=t.info.gList,e.data.forEach((function(t){t.update_time=E()(t.update_time).format("YYYY-MM-DD HH:mm:ss"),t.uids.forEach((function(t){e.closable[t]=t!=window.localStorage.uid}))})),e.total=t.info.total,e.$loading.hide()})).catch((function(t){e.$loading.hide(),e.$message({message:e.$t("market.repoRet."+t.tars_ret||!1),type:"error"})}))}},created:function(){},mounted:function(){this.fetchProjects()}},Vi=zi,Ri=(a("0810"),Object(w["a"])(Vi,pi,mi,!1,null,null,null)),Ei=Ri.exports,Bi=A["a"].prototype.push;A["a"].prototype.push=function(e){return Bi.call(this,e).catch((function(e){return e}))},r["default"].use(A["a"]);var Hi=new A["a"]({routes:[{path:"/server",name:"Server",component:_t,children:[{path:":treeid/manage",component:Be},{path:":treeid/history",component:mt},{path:":treeid/publish",component:Ze},{path:":treeid/config",component:rt},{path:":treeid/server-monitor",component:ot["a"]},{path:":treeid/property-monitor",component:it["a"]},{path:":treeid/interface-debuger",component:st["a"]},{path:":treeid/user-manage",component:lt["a"]}]},{path:"/operation",name:"Operation",component:Tt,redirect:"/operation/deploy",children:[{path:"deploy",component:Et},{path:"approval",component:Kt},{path:"history",component:ea},{path:"undeploy",component:sa},{path:"templates",component:pa},{path:"image",component:ba},{path:"affinity",component:wa},{path:"application",component:Ta},{path:"business",component:qa},{path:"node",component:Ka},{path:"event",component:er},{path:"tfc",component:sr}]},{path:"/gateway",name:"Gateway",component:lr["a"]},{path:"/market/user",name:"MarketIndex",component:mr,children:[{path:"login",component:No},{path:"register",component:Oo},{path:"activate",component:Eo},{path:"forget",component:Uo},{path:"modifyPass",component:Xo},{path:"resetPass",component:ii}]},{path:"/market/repo",name:"MarketRepo",component:mr,children:[{path:"pass",component:ui},{path:"project",component:Ei}]},{path:"/market/service",component:$r,children:[{path:":group/:name/:version",component:ko}]},{path:"/market/list",component:$r,children:[{path:"/",component:Dr}]},{path:"*",redirect:"/server"}],scrollBehavior:function(e,t,a){return{x:0,y:0}}}),Fi=a("5c96"),Ji=a.n(Fi),Yi=(a("a082"),a("0808"),a("6944")),Ui=a.n(Yi);r["default"].config.productionTip=!1,y["b"].call(void 0).then((function(){r["default"].use(Ui.a),r["default"].use(Ji.a,{i18n:function(e,t){return y["a"].t(e,t)}}),new r["default"]({i18n:y["a"],el:"#app",router:Hi,store:o["a"],components:{k8sApp:I},template:"<k8sApp/>"})}))},"4e15":function(e,t,a){"use strict";var r=a("0d43"),o=a.n(r);o.a},"5bc8":function(e,t,a){},"5d82":function(e,t,a){"use strict";var r=a("ff5a"),o=a.n(r);o.a},"5dd2":function(e,t,a){"use strict";var r=a("af03"),o=a.n(r);o.a},"5de2":function(e,t,a){"use strict";var r=a("c37c"),o=a.n(r);o.a},"5e23":function(e,t,a){},"626e":function(e,t,a){},"67f3":function(e,t,a){},"6c7a":function(e,t,a){"use strict";var r=a("0dbe"),o=a.n(r);o.a},"6e59":function(e,t,a){},"7b9a":function(e,t,a){"use strict";var r=a("24ee"),o=a.n(r);o.a},"83a3":function(e,t,a){},8636:function(e,t,a){},8924:function(e,t,a){},"8f5f":function(e,t,a){},"98b3":function(e,t,a){"use strict";var r=a("e779"),o=a.n(r);o.a},"9df2":function(e,t,a){"use strict";var r=a("8924"),o=a.n(r);o.a},a462:function(e,t,a){"use strict";var r=a("2d59"),o=a.n(r);o.a},ad4b:function(e,t,a){},ae6e:function(e,t,a){},af03:function(e,t,a){},afb9:function(e,t,a){"use strict";var r=a("3d87"),o=a.n(r);o.a},b2b3:function(e,t,a){},b50eb:function(e,t,a){"use strict";var r=a("c26a"),o=a.n(r);o.a},be1a:function(e,t,a){},c219:function(e,t,a){"use strict";var r=a("168e"),o=a.n(r);o.a},c26a:function(e,t,a){},c2e9:function(e,t,a){"use strict";var r=a("5bc8"),o=a.n(r);o.a},c2e92:function(e,t,a){"use strict";var r=a("8636"),o=a.n(r);o.a},c37c:function(e,t,a){},c3f0:function(e,t,a){"use strict";var r=a("e5f7"),o=a.n(r);o.a},c49e:function(e,t,a){},c762:function(e,t,a){"use strict";var r=a("ad4b"),o=a.n(r);o.a},c914:function(e,t,a){"use strict";var r=a("2c1d"),o=a.n(r);o.a},ca4b:function(e,t,a){},ca6f:function(e,t,a){"use strict";var r=a("6e59"),o=a.n(r);o.a},cb44:function(e,t,a){"use strict";var r=a("5e23"),o=a.n(r);o.a},cdeb:function(e,t,a){"use strict";var r=a("67f3"),o=a.n(r);o.a},da9f:function(e,t,a){"use strict";var r=a("ae6e"),o=a.n(r);o.a},e5f7:function(e,t,a){},e779:function(e,t,a){},e81f:function(e,t,a){"use strict";var r=a("ca4b"),o=a.n(r);o.a},e93e:function(e,t,a){},f333:function(e,t,a){"use strict";var r=a("437c"),o=a.n(r);o.a},ff5a:function(e,t,a){}});